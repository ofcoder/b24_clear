this.BX=this.BX||{};this.BX.Sign=this.BX.Sign||{};this.BX.Sign.V2=this.BX.Sign.V2||{};(function(e,s,t,a,l,i,r){"use strict";let o=e=>e,n,c;var b=babelHelpers.classPrivateFieldLooseKey("documentDateField");var d=babelHelpers.classPrivateFieldLooseKey("selectedDate");var p=babelHelpers.classPrivateFieldLooseKey("formatDate");var u=babelHelpers.classPrivateFieldLooseKey("getDateField");var v=babelHelpers.classPrivateFieldLooseKey("selectDate");class h{constructor(){Object.defineProperty(this,v,{value:F});Object.defineProperty(this,u,{value:L});Object.defineProperty(this,p,{value:P});Object.defineProperty(this,b,{writable:true,value:void 0});Object.defineProperty(this,d,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,b)[b]=babelHelpers.classPrivateFieldLooseBase(this,u)[u]();const e=new Date;babelHelpers.classPrivateFieldLooseBase(this,v)[v](e);this.setDateInCalendar(e)}setDateInCalendar(e){const s=babelHelpers.classPrivateFieldLooseBase(this,p)[p](e,"DAY_MONTH_FORMAT");const t=babelHelpers.classPrivateFieldLooseBase(this,b)[b].firstElementChild;t.textContent=s;t.title=s}getLayout(){return l.Tag.render(n||(n=o`
			<div class="sign-b2e-document-setup__date-selector">
				<span class="sign-b2e-document-setup__date-selector_label">
					${0}
				</span>
				${0}
			</div>
		`),l.Loc.getMessage("SIGN_DOCUMENT_SETUP_DATE_LABEL"),babelHelpers.classPrivateFieldLooseBase(this,b)[b])}getSelectedDate(){return babelHelpers.classPrivateFieldLooseBase(this,d)[d]}}function P(e,s){const t=i.DateTimeFormat.getFormat(s);return i.DateTimeFormat.format(t,e)}function L(){return l.Tag.render(c||(c=o`
			<div
				class="sign-b2e-document-setup__date-selector_field"
				onclick="${0}"
			>
				<span class="sign-b2e-document-setup__date-selector_field-text"></span>
			</div>
		`),(()=>{BX.calendar({node:babelHelpers.classPrivateFieldLooseBase(this,b)[b],field:babelHelpers.classPrivateFieldLooseBase(this,b)[b],bTime:false,callback_after:e=>{babelHelpers.classPrivateFieldLooseBase(this,v)[v](e);this.setDateInCalendar(e)}})}))}function F(e){const s=babelHelpers.classPrivateFieldLooseBase(this,p)[p](e,"SHORT_DATE_FORMAT");babelHelpers.classPrivateFieldLooseBase(this,d)[d]=s}let H=e=>e,g,_,m,y,B,f,T,D;var S=babelHelpers.classPrivateFieldLooseKey("api");var E=babelHelpers.classPrivateFieldLooseKey("region");var O=babelHelpers.classPrivateFieldLooseKey("regionDocumentTypes");var I=babelHelpers.classPrivateFieldLooseKey("documentTypeSelector");var N=babelHelpers.classPrivateFieldLooseKey("documentTypeDropdown");var j=babelHelpers.classPrivateFieldLooseKey("documentNumberInput");var C=babelHelpers.classPrivateFieldLooseKey("documentTitleInput");var K=babelHelpers.classPrivateFieldLooseKey("dateSelector");var M=babelHelpers.classPrivateFieldLooseKey("init");var w=babelHelpers.classPrivateFieldLooseKey("isDocumentTypeVisible");var $=babelHelpers.classPrivateFieldLooseKey("isRuRegion");var U=babelHelpers.classPrivateFieldLooseKey("initDocumentType");var x=babelHelpers.classPrivateFieldLooseKey("getDocumentTypeLayout");var A=babelHelpers.classPrivateFieldLooseKey("getDocumentNumberLayout");var X=babelHelpers.classPrivateFieldLooseKey("getDocumentTitleLayout");var k=babelHelpers.classPrivateFieldLooseKey("getDocumentTitleFullClass");var G=babelHelpers.classPrivateFieldLooseKey("onTypeSelect");var V=babelHelpers.classPrivateFieldLooseKey("sendDocumentType");var R=babelHelpers.classPrivateFieldLooseKey("sendDocumentNumber");var Y=babelHelpers.classPrivateFieldLooseKey("sendDocumentDate");var q=babelHelpers.classPrivateFieldLooseKey("setDocumentNumber");var z=babelHelpers.classPrivateFieldLooseKey("validateInput");class J extends a.DocumentSetup{constructor(e){super(e);Object.defineProperty(this,z,{value:be});Object.defineProperty(this,q,{value:ce});Object.defineProperty(this,Y,{value:ne});Object.defineProperty(this,R,{value:oe});Object.defineProperty(this,V,{value:re});Object.defineProperty(this,G,{value:ie});Object.defineProperty(this,k,{value:le});Object.defineProperty(this,X,{value:ae});Object.defineProperty(this,A,{value:te});Object.defineProperty(this,x,{value:se});Object.defineProperty(this,U,{value:ee});Object.defineProperty(this,$,{value:Z});Object.defineProperty(this,w,{value:W});Object.defineProperty(this,M,{value:Q});Object.defineProperty(this,S,{writable:true,value:void 0});Object.defineProperty(this,E,{writable:true,value:void 0});Object.defineProperty(this,O,{writable:true,value:void 0});Object.defineProperty(this,I,{writable:true,value:void 0});Object.defineProperty(this,N,{writable:true,value:void 0});Object.defineProperty(this,j,{writable:true,value:null});Object.defineProperty(this,C,{writable:true,value:void 0});Object.defineProperty(this,K,{writable:true,value:null});const{region:t,regionDocumentTypes:a}=e;babelHelpers.classPrivateFieldLooseBase(this,S)[S]=new s.Api;babelHelpers.classPrivateFieldLooseBase(this,E)[E]=t;babelHelpers.classPrivateFieldLooseBase(this,O)[O]=a;babelHelpers.classPrivateFieldLooseBase(this,C)[C]=l.Tag.render(g||(g=H`
			<input
				type="text"
				class="ui-ctl-element"
				maxlength="255"
				oninput="${0}"
			/>
		`),(({target:e})=>this.setDocumentTitle(e.value)));if(babelHelpers.classPrivateFieldLooseBase(this,$)[$]()){babelHelpers.classPrivateFieldLooseBase(this,j)[j]=l.Tag.render(_||(_=H`<input type="text" class="ui-ctl-element" maxlength="255" />`));babelHelpers.classPrivateFieldLooseBase(this,K)[K]=new h}this.blankSelector.subscribe("toggleSelection",(({data:e})=>{this.setDocumentTitle(e.title)}));this.blankSelector.subscribe("addFile",(({data:e})=>{this.setDocumentTitle(e.title)}));babelHelpers.classPrivateFieldLooseBase(this,M)[M]()}setDocumentTitle(e=""){babelHelpers.classPrivateFieldLooseBase(this,C)[C].value=e;babelHelpers.classPrivateFieldLooseBase(this,C)[C].title=e}initLayout(){this.layout=l.Tag.render(m||(m=H`
			<div class="sign-document-setup">
				<h1 class="sign-b2e-settings__header">${0}</h1>
				<div class="sign-b2e-settings__item">
					<p class="sign-b2e-settings__item_title">
						${0}
					</p>
					${0}
				</div>
			</div>
		`),l.Loc.getMessage("SIGN_DOCUMENT_SETUP_HEADER"),l.Loc.getMessage("SIGN_DOCUMENT_SETUP_ADD_TITLE"),this.blankSelector.getLayout())}async setup(e){try{var s;await super.setup(e);if(!this.setupData){return}if(e){const{title:e,externalId:s,externalDateCreate:t}=this.setupData;this.setDocumentTitle(e);if(babelHelpers.classPrivateFieldLooseBase(this,$)[$]()){babelHelpers.classPrivateFieldLooseBase(this,q)[q](s);babelHelpers.classPrivateFieldLooseBase(this,K)[K].setDateInCalendar(new Date(t))}return}const{uid:t}=this.setupData;const{value:a}=babelHelpers.classPrivateFieldLooseBase(this,C)[C];const l=(s=babelHelpers.classPrivateFieldLooseBase(this,j)[j])==null?void 0:s.value;this.ready=false;await Promise.all([babelHelpers.classPrivateFieldLooseBase(this,V)[V](t),babelHelpers.classPrivateFieldLooseBase(this,R)[R](t),babelHelpers.classPrivateFieldLooseBase(this,Y)[Y](t)]);const i=await babelHelpers.classPrivateFieldLooseBase(this,S)[S].modifyTitle(t,a);const{blankTitle:r}=i;if(r){const{blankId:e}=this.setupData;this.blankSelector.modifyBlankTitle(e,r)}this.setupData={...this.setupData,title:a,externalId:l}}catch{const{blankId:e}=this.setupData;this.handleError(e)}this.ready=true}validate(){const e=babelHelpers.classPrivateFieldLooseBase(this,z)[z](babelHelpers.classPrivateFieldLooseBase(this,C)[C]);const s=babelHelpers.classPrivateFieldLooseBase(this,z)[z](babelHelpers.classPrivateFieldLooseBase(this,j)[j]);return e&&s}}function Q(){babelHelpers.classPrivateFieldLooseBase(this,U)[U]();const e=babelHelpers.classPrivateFieldLooseBase(this,x)[x]();const s=l.Tag.render(y||(y=H`
			<div class="sign-b2e-settings__item">
				<p class="sign-b2e-settings__item_title">
					${0}
				</p>
				${0}
			</div>
		`),l.Loc.getMessage("SIGN_DOCUMENT_SETUP_TITLE_HEAD_LABEL"),babelHelpers.classPrivateFieldLooseBase(this,X)[X]());l.Dom.append(e,this.layout);l.Dom.append(s,this.layout);r.Hint.create(this.layout)}function W(){var e;return(e=babelHelpers.classPrivateFieldLooseBase(this,O)[O])==null?void 0:e.length}function Z(){return babelHelpers.classPrivateFieldLooseBase(this,E)[E]==="ru"}function ee(){if(!babelHelpers.classPrivateFieldLooseBase(this,w)[w]()){return}babelHelpers.classPrivateFieldLooseBase(this,N)[N]=l.Tag.render(B||(B=H`
			<div
				class="sign-b2e-document-setup__type"
				onclick="${0}"
			>
				<div class="sign-b2e-document-setup__type_text">
					<span class="sign-b2e-document-setup__type_title"></span>
					<span class="sign-b2e-document-setup__type_caption"></span>
				</div>
				<span class="sign-b2e-document-setup__type_btn"></span>
			</div>
		`),(()=>{babelHelpers.classPrivateFieldLooseBase(this,I)[I].show()}));babelHelpers.classPrivateFieldLooseBase(this,I)[I]=new t.Dialog({targetNode:babelHelpers.classPrivateFieldLooseBase(this,N)[N],width:500,height:350,tabs:[{id:"b2e-document-codes",title:" "}],showAvatars:false,dropdownMode:true,multiple:false,enableSearch:true,entities:[{id:"b2e-document-code",searchFields:[{name:"caption",system:true}]}],hideOnSelect:true,events:{"Item:OnSelect":({data:e})=>babelHelpers.classPrivateFieldLooseBase(this,G)[G](e.item)}});const e=babelHelpers.classPrivateFieldLooseBase(this,I)[I].getContainer();l.Dom.addClass(e,"sign-b2e-document-setup__type-selector");babelHelpers.classPrivateFieldLooseBase(this,O)[O].forEach((e=>{if(l.Type.isPlainObject(e)&&l.Type.isStringFilled(e.code)&&l.Type.isStringFilled(e.description)){const{code:s,description:t}=e;babelHelpers.classPrivateFieldLooseBase(this,I)[I].addItem({id:s,title:s,caption:`(${t})`,entityId:"b2e-document-code",tabs:"b2e-document-codes",deselectable:false})}}));const[s]=babelHelpers.classPrivateFieldLooseBase(this,I)[I].getItems();s==null?void 0:s.select()}function se(){if(!babelHelpers.classPrivateFieldLooseBase(this,w)[w]()){return null}return l.Tag.render(f||(f=H`
			<div class="sign-b2e-settings__item">
				<p class="sign-b2e-settings__item_title">
					<span>${0}</span>
					<span
						data-hint="${0}"
					></span>
				</p>
				${0}
			</div>
		`),l.Loc.getMessage("SIGN_DOCUMENT_SETUP_TYPE"),l.Loc.getMessage("SIGN_DOCUMENT_SETUP_TYPE_HINT"),babelHelpers.classPrivateFieldLooseBase(this,N)[N])}function te(){if(!babelHelpers.classPrivateFieldLooseBase(this,$)[$]()){return null}return l.Tag.render(T||(T=H`
			<div class="sign-b2e-document-setup__title-item --num">
				<p class="sign-b2e-document-setup__title-text">
					<span>${0}</span>
					<span
						data-hint="${0}"
					></span>
				</p>
				<div class="ui-ctl ui-ctl-textbox">
					${0}
				</div>
			</div>
		`),l.Loc.getMessage("SIGN_DOCUMENT_SETUP_NUM_LABEL"),l.Loc.getMessage("SIGN_DOCUMENT_SETUP_NUM_LABEL_HINT"),babelHelpers.classPrivateFieldLooseBase(this,j)[j])}function ae(){var e;return l.Tag.render(D||(D=H`
			<div>
				<div class="sign-b2e-document-setup__title-item ${0}">
					<p class="sign-b2e-document-setup__title-text">
						${0}
					</p>
					<div class="ui-ctl ui-ctl-textbox">
						${0}
					</div>
				</div>
				${0}
				<p class="sign-b2e-document-setup__title-text">
					${0}
				</p>
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,k)[k](),l.Loc.getMessage("SIGN_DOCUMENT_SETUP_TITLE_LABEL"),babelHelpers.classPrivateFieldLooseBase(this,C)[C],babelHelpers.classPrivateFieldLooseBase(this,A)[A](),l.Loc.getMessage("SIGN_DOCUMENT_SETUP_TITLE_HINT"),(e=babelHelpers.classPrivateFieldLooseBase(this,K)[K])==null?void 0:e.getLayout())}function le(){return babelHelpers.classPrivateFieldLooseBase(this,$)[$]()?"":"--full"}function ie(e){const{title:s,caption:t}=e;const{firstElementChild:a}=babelHelpers.classPrivateFieldLooseBase(this,N)[N];a.title=`${s} ${t}`;const{firstElementChild:l,lastElementChild:i}=a;l.textContent=s;i.textContent=t}function re(e){if(!babelHelpers.classPrivateFieldLooseBase(this,w)[w]()){return Promise.resolve()}const s=[...babelHelpers.classPrivateFieldLooseBase(this,I)[I].selectedItems][0].id;return babelHelpers.classPrivateFieldLooseBase(this,S)[S].changeRegionDocumentType(e,s)}function oe(e){if(!babelHelpers.classPrivateFieldLooseBase(this,$)[$]()){return Promise.resolve()}return babelHelpers.classPrivateFieldLooseBase(this,S)[S].changeExternalId(e,babelHelpers.classPrivateFieldLooseBase(this,j)[j].value)}function ne(e){if(!babelHelpers.classPrivateFieldLooseBase(this,$)[$]()){return Promise.resolve()}return babelHelpers.classPrivateFieldLooseBase(this,S)[S].changeExternalDate(e,babelHelpers.classPrivateFieldLooseBase(this,K)[K].getSelectedDate())}function ce(e){babelHelpers.classPrivateFieldLooseBase(this,j)[j].value=e}function be(e){if(!e){return true}const{parentNode:s,value:t}=e;if(t.trim()!==""){l.Dom.removeClass(s,"ui-ctl-warning");return true}l.Dom.addClass(s,"ui-ctl-warning");e.focus();return false}e.DocumentSetup=J})(this.BX.Sign.V2.B2e=this.BX.Sign.V2.B2e||{},BX.Sign.V2,BX.UI.EntitySelector,BX.Sign.V2,BX,BX.Main,BX.Sign.V2);
//# sourceMappingURL=document-setup.bundle.map.js