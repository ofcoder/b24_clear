{"version":3,"file":"document-setup.bundle.js","sources":["../src/date-selector.js","../src/index.js"],"sourcesContent":["import { Tag, Loc } from 'main.core';\nimport { DateTimeFormat } from 'main.date';\n\nexport class DateSelector\n{\n\t#documentDateField: HTMLElement;\n\t#selectedDate: string;\n\n\tconstructor()\n\t{\n\t\tthis.#documentDateField = this.#getDateField();\n\t\tconst date = new Date();\n\t\tthis.#selectDate(date);\n\t\tthis.setDateInCalendar(date);\n\t}\n\n\t#formatDate(date: Date, formatType: string): string\n\t{\n\t\tconst template = DateTimeFormat.getFormat(formatType);\n\n\t\treturn DateTimeFormat.format(template, date);\n\t}\n\n\t#getDateField(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"sign-b2e-document-setup__date-selector_field\"\n\t\t\t\tonclick=\"${() => {\n\t\t\t\t\tBX.calendar({\n\t\t\t\t\t\tnode: this.#documentDateField,\n\t\t\t\t\t\tfield: this.#documentDateField,\n\t\t\t\t\t\tbTime: false,\n\t\t\t\t\t\tcallback_after: (date) => {\n\t\t\t\t\t\t\tthis.#selectDate(date);\n\t\t\t\t\t\t\tthis.setDateInCalendar(date);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}}\"\n\t\t\t>\n\t\t\t\t<span class=\"sign-b2e-document-setup__date-selector_field-text\"></span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#selectDate(date: Date): void\n\t{\n\t\tconst formattedDate = this.#formatDate(date, 'SHORT_DATE_FORMAT');\n\t\tthis.#selectedDate = formattedDate;\n\t}\n\n\tsetDateInCalendar(date: Date): void\n\t{\n\t\tconst formattedDate = this.#formatDate(date, 'DAY_MONTH_FORMAT');\n\t\tconst dateTextNode = this.#documentDateField.firstElementChild;\n\t\tdateTextNode.textContent = formattedDate;\n\t\tdateTextNode.title = formattedDate;\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-document-setup__date-selector\">\n\t\t\t\t<span class=\"sign-b2e-document-setup__date-selector_label\">\n\t\t\t\t\t${Loc.getMessage('SIGN_DOCUMENT_SETUP_DATE_LABEL')}\n\t\t\t\t</span>\n\t\t\t\t${this.#documentDateField}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetSelectedDate(): string\n\t{\n\t\treturn this.#selectedDate;\n\t}\n}\n","import { Tag, Dom, Loc, Type } from 'main.core';\nimport { Api } from 'sign.v2.api';\nimport { Dialog } from 'ui.entity-selector';\nimport { DocumentSetup as BaseDocumentSetup } from 'sign.v2.document-setup';\nimport { type BlankSelectorConfig } from 'sign.v2.blank-selector';\nimport { DateSelector } from './date-selector';\nimport { Hint } from 'sign.v2.helper';\n\nimport './style.css';\n\ntype RegionDocumentType = {\n\tcode: string,\n\tdescription: string,\n};\n\nexport class DocumentSetup extends BaseDocumentSetup\n{\n\t#api: Api;\n\t#region: string;\n\t#regionDocumentTypes: Array<RegionDocumentType>;\n\t#documentTypeSelector: Dialog;\n\t#documentTypeDropdown: HTMLElement;\n\t#documentNumberInput: HTMLInputElement | null = null;\n\t#documentTitleInput: HTMLInputElement;\n\t#dateSelector: DateSelector | null = null;\n\n\tconstructor(blankSelectorConfig: BlankSelectorConfig)\n\t{\n\t\tsuper(blankSelectorConfig);\n\t\tconst { region, regionDocumentTypes } = blankSelectorConfig;\n\t\tthis.#api = new Api();\n\t\tthis.#region = region;\n\t\tthis.#regionDocumentTypes = regionDocumentTypes;\n\t\tthis.#documentTitleInput = Tag.render`\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\tmaxlength=\"255\"\n\t\t\t\toninput=\"${({ target }) => this.setDocumentTitle(target.value)}\"\n\t\t\t/>\n\t\t`;\n\t\tif (this.#isRuRegion())\n\t\t{\n\t\t\tthis.#documentNumberInput = Tag.render`<input type=\"text\" class=\"ui-ctl-element\" maxlength=\"255\" />`;\n\t\t\tthis.#dateSelector = new DateSelector();\n\t\t}\n\n\t\tthis.blankSelector.subscribe('toggleSelection', ({ data }) => {\n\t\t\tthis.setDocumentTitle(data.title);\n\t\t});\n\t\tthis.blankSelector.subscribe('addFile', ({ data }) => {\n\t\t\tthis.setDocumentTitle(data.title);\n\t\t});\n\t\tthis.#init();\n\t}\n\n\t#init(): void\n\t{\n\t\tthis.#initDocumentType();\n\t\tconst documentTypeLayout = this.#getDocumentTypeLayout();\n\t\tconst titleLayout = Tag.render`\n\t\t\t<div class=\"sign-b2e-settings__item\">\n\t\t\t\t<p class=\"sign-b2e-settings__item_title\">\n\t\t\t\t\t${Loc.getMessage('SIGN_DOCUMENT_SETUP_TITLE_HEAD_LABEL')}\n\t\t\t\t</p>\n\t\t\t\t${this.#getDocumentTitleLayout()}\n\t\t\t</div>\n\t\t`;\n\t\tDom.append(documentTypeLayout, this.layout);\n\t\tDom.append(titleLayout, this.layout);\n\t\tHint.create(this.layout);\n\t}\n\n\t#isDocumentTypeVisible(): boolean\n\t{\n\t\treturn this.#regionDocumentTypes?.length;\n\t}\n\n\t#isRuRegion(): boolean\n\t{\n\t\treturn this.#region === 'ru';\n\t}\n\n\t#initDocumentType(): void\n\t{\n\t\tif (!this.#isDocumentTypeVisible())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#documentTypeDropdown = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"sign-b2e-document-setup__type\"\n\t\t\t\tonclick=\"${() => {\n\t\t\t\t\tthis.#documentTypeSelector.show();\n\t\t\t\t}}\"\n\t\t\t>\n\t\t\t\t<div class=\"sign-b2e-document-setup__type_text\">\n\t\t\t\t\t<span class=\"sign-b2e-document-setup__type_title\"></span>\n\t\t\t\t\t<span class=\"sign-b2e-document-setup__type_caption\"></span>\n\t\t\t\t</div>\n\t\t\t\t<span class=\"sign-b2e-document-setup__type_btn\"></span>\n\t\t\t</div>\n\t\t`;\n\t\tthis.#documentTypeSelector = new Dialog({\n\t\t\ttargetNode: this.#documentTypeDropdown,\n\t\t\twidth: 500,\n\t\t\theight: 350,\n\t\t\ttabs: [{ id: 'b2e-document-codes', title: ' ' }],\n\t\t\tshowAvatars: false,\n\t\t\tdropdownMode: true,\n\t\t\tmultiple: false,\n\t\t\tenableSearch: true,\n\t\t\tentities: [\n\t\t\t\t{ id: 'b2e-document-code', searchFields: [{ name: 'caption', system: true }] },\n\t\t\t],\n\t\t\thideOnSelect: true,\n\t\t\tevents: {\n\t\t\t\t'Item:OnSelect': ({ data }) => this.#onTypeSelect(data.item),\n\t\t\t},\n\t\t});\n\t\tconst container = this.#documentTypeSelector.getContainer();\n\t\tDom.addClass(container, 'sign-b2e-document-setup__type-selector');\n\t\tthis.#regionDocumentTypes.forEach((item) => {\n\t\t\tif (Type.isPlainObject(item)\n\t\t\t\t&& Type.isStringFilled(item.code)\n\t\t\t\t&& Type.isStringFilled(item.description))\n\t\t\t{\n\t\t\t\tconst { code, description } = item;\n\t\t\t\tthis.#documentTypeSelector.addItem({\n\t\t\t\t\tid: code,\n\t\t\t\t\ttitle: code,\n\t\t\t\t\tcaption: `(${description})`,\n\t\t\t\t\tentityId: 'b2e-document-code',\n\t\t\t\t\ttabs: 'b2e-document-codes',\n\t\t\t\t\tdeselectable: false,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tconst [firstItem] = this.#documentTypeSelector.getItems();\n\t\tfirstItem?.select();\n\t}\n\n\t#getDocumentTypeLayout(): HTMLElement | null\n\t{\n\t\tif (!this.#isDocumentTypeVisible())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-settings__item\">\n\t\t\t\t<p class=\"sign-b2e-settings__item_title\">\n\t\t\t\t\t<span>${Loc.getMessage('SIGN_DOCUMENT_SETUP_TYPE')}</span>\n\t\t\t\t\t<span\n\t\t\t\t\t\tdata-hint=\"${Loc.getMessage('SIGN_DOCUMENT_SETUP_TYPE_HINT')}\"\n\t\t\t\t\t></span>\n\t\t\t\t</p>\n\t\t\t\t${this.#documentTypeDropdown}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getDocumentNumberLayout(): HTMLElement | null\n\t{\n\t\tif (!this.#isRuRegion())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-document-setup__title-item --num\">\n\t\t\t\t<p class=\"sign-b2e-document-setup__title-text\">\n\t\t\t\t\t<span>${Loc.getMessage('SIGN_DOCUMENT_SETUP_NUM_LABEL')}</span>\n\t\t\t\t\t<span\n\t\t\t\t\t\tdata-hint=\"${Loc.getMessage('SIGN_DOCUMENT_SETUP_NUM_LABEL_HINT')}\"\n\t\t\t\t\t></span>\n\t\t\t\t</p>\n\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox\">\n\t\t\t\t\t${this.#documentNumberInput}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getDocumentTitleLayout(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div>\n\t\t\t\t<div class=\"sign-b2e-document-setup__title-item ${this.#getDocumentTitleFullClass()}\">\n\t\t\t\t\t<p class=\"sign-b2e-document-setup__title-text\">\n\t\t\t\t\t\t${Loc.getMessage('SIGN_DOCUMENT_SETUP_TITLE_LABEL')}\n\t\t\t\t\t</p>\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox\">\n\t\t\t\t\t\t${this.#documentTitleInput}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t${this.#getDocumentNumberLayout()}\n\t\t\t\t<p class=\"sign-b2e-document-setup__title-text\">\n\t\t\t\t\t${Loc.getMessage('SIGN_DOCUMENT_SETUP_TITLE_HINT')}\n\t\t\t\t</p>\n\t\t\t\t${this.#dateSelector?.getLayout()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getDocumentTitleFullClass(): string\n\t{\n\t\treturn this.#isRuRegion() ? '' : '--full';\n\t}\n\n\t#onTypeSelect(item): void\n\t{\n\t\tconst { title, caption } = item;\n\t\tconst { firstElementChild: textNode } = this.#documentTypeDropdown;\n\t\ttextNode.title = `${title} ${caption}`;\n\t\tconst {\n\t\t\tfirstElementChild: titleNode,\n\t\t\tlastElementChild: captionNode,\n\t\t} = textNode;\n\t\ttitleNode.textContent = title;\n\t\tcaptionNode.textContent = caption;\n\t}\n\n\t#sendDocumentType(uid: string): Promise<void>\n\t{\n\t\tif (!this.#isDocumentTypeVisible())\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst type = [...this.#documentTypeSelector.selectedItems][0].id;\n\n\t\treturn this.#api.changeRegionDocumentType(uid, type);\n\t}\n\n\t#sendDocumentNumber(uid: string): Promise<void>\n\t{\n\t\tif (!this.#isRuRegion())\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn this.#api.changeExternalId(uid, this.#documentNumberInput.value);\n\t}\n\n\t#sendDocumentDate(uid: string): Promise<void>\n\t{\n\t\tif (!this.#isRuRegion())\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn this.#api.changeExternalDate(uid, this.#dateSelector.getSelectedDate());\n\t}\n\n\t#setDocumentNumber(number: string): void\n\t{\n\t\tthis.#documentNumberInput.value = number;\n\t}\n\n\tsetDocumentTitle(title: string = ''): void\n\t{\n\t\tthis.#documentTitleInput.value = title;\n\t\tthis.#documentTitleInput.title = title;\n\t}\n\n\tinitLayout(): void\n\t{\n\t\tthis.layout = Tag.render`\n\t\t\t<div class=\"sign-document-setup\">\n\t\t\t\t<h1 class=\"sign-b2e-settings__header\">${Loc.getMessage('SIGN_DOCUMENT_SETUP_HEADER')}</h1>\n\t\t\t\t<div class=\"sign-b2e-settings__item\">\n\t\t\t\t\t<p class=\"sign-b2e-settings__item_title\">\n\t\t\t\t\t\t${Loc.getMessage('SIGN_DOCUMENT_SETUP_ADD_TITLE')}\n\t\t\t\t\t</p>\n\t\t\t\t\t${this.blankSelector.getLayout()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tasync setup(uid: ?string): Promise<void>\n\t{\n\t\ttry\n\t\t{\n\t\t\tawait super.setup(uid);\n\t\t\tif (!this.setupData)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (uid)\n\t\t\t{\n\t\t\t\tconst { title, externalId, externalDateCreate } = this.setupData;\n\t\t\t\tthis.setDocumentTitle(title);\n\n\t\t\t\tif (this.#isRuRegion())\n\t\t\t\t{\n\t\t\t\t\tthis.#setDocumentNumber(externalId);\n\t\t\t\t\tthis.#dateSelector.setDateInCalendar(new Date(externalDateCreate));\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { uid: documentUid } = this.setupData;\n\t\t\tconst { value: title } = this.#documentTitleInput;\n\t\t\tconst externalId = this.#documentNumberInput?.value;\n\t\t\tthis.ready = false;\n\t\t\tawait Promise.all([\n\t\t\t\tthis.#sendDocumentType(documentUid),\n\t\t\t\tthis.#sendDocumentNumber(documentUid),\n\t\t\t\tthis.#sendDocumentDate(documentUid),\n\t\t\t]);\n\n\t\t\tconst modifyDocumentTitleResponse = await this.#api.modifyTitle(documentUid, title);\n\t\t\tconst { blankTitle } = modifyDocumentTitleResponse;\n\t\t\tif (blankTitle)\n\t\t\t{\n\t\t\t\tconst { blankId } = this.setupData;\n\t\t\t\tthis.blankSelector.modifyBlankTitle(blankId, blankTitle);\n\t\t\t}\n\n\t\t\tthis.setupData = { ...this.setupData, title, externalId };\n\t\t}\n\t\tcatch\n\t\t{\n\t\t\tconst { blankId } = this.setupData;\n\t\t\tthis.handleError(blankId);\n\t\t}\n\n\t\tthis.ready = true;\n\t}\n\n\t#validateInput(input: HTMLElement): boolean\n\t{\n\t\tif (!input)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst { parentNode, value } = input;\n\t\tif (value.trim() !== '')\n\t\t{\n\t\t\tDom.removeClass(parentNode, 'ui-ctl-warning');\n\n\t\t\treturn true;\n\t\t}\n\n\t\tDom.addClass(parentNode, 'ui-ctl-warning');\n\t\tinput.focus();\n\n\t\treturn false;\n\t}\n\n\tvalidate(): boolean\n\t{\n\t\tconst isValidTitle = this.#validateInput(this.#documentTitleInput);\n\t\tconst isValidNumber = this.#validateInput(this.#documentNumberInput);\n\n\t\treturn isValidTitle && isValidNumber;\n\t}\n}\n"],"names":["DateSelector","constructor","date","Date","setDateInCalendar","formattedDate","dateTextNode","firstElementChild","textContent","title","getLayout","Tag","render","Loc","getMessage","getSelectedDate","formatType","template","DateTimeFormat","getFormat","format","BX","calendar","node","field","bTime","callback_after","DocumentSetup","BaseDocumentSetup","blankSelectorConfig","region","regionDocumentTypes","Api","target","setDocumentTitle","value","blankSelector","subscribe","data","initLayout","layout","setup","uid","setupData","externalId","externalDateCreate","documentUid","ready","Promise","all","modifyDocumentTitleResponse","modifyTitle","blankTitle","blankId","modifyBlankTitle","handleError","validate","isValidTitle","isValidNumber","documentTypeLayout","titleLayout","Dom","append","Hint","create","length","show","Dialog","targetNode","width","height","tabs","id","showAvatars","dropdownMode","multiple","enableSearch","entities","searchFields","name","system","hideOnSelect","events","item","container","getContainer","addClass","forEach","Type","isPlainObject","isStringFilled","code","description","addItem","caption","entityId","deselectable","firstItem","getItems","select","textNode","titleNode","lastElementChild","captionNode","resolve","type","selectedItems","changeRegionDocumentType","changeExternalId","changeExternalDate","number","input","parentNode","trim","removeClass","focus"],"mappings":"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"}