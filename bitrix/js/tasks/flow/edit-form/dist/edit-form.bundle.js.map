{"version":3,"file":"edit-form.bundle.js","sources":["../src/pages/form-page.js","../src/value-checker.js","../src/bind-filter-number-input.js","../src/hint.js","../src/pages/about-page.js","../src/pull-requests.js","../src/pages/settings-page.js","../src/pages/control-page.js","../src/edit-form.js"],"sourcesContent":["import type { Flow } from '../edit-form';\n\nexport class FormPage\n{\n\tgetId(): string {}\n\tgetTitle(): string {}\n\tsetFlow(flow: Flow): void {}\n\trender(): HTMLElement {}\n\tgetFields(flowData: Flow): any {}\n\tgetRequiredData(): string[] { return []; }\n\tupdate(): void { this.cleanErrors(); }\n\tcleanErrors(): void {}\n\tshowErrors(incorrectData: string[]): void {}\n\tonContinueClick(flowData: Flow = {}): Promise<boolean> {\n\t\treturn Promise.resolve(true);\n\t}\n}\n","import { Dom, Event, Loc, Tag } from 'main.core';\nimport { Dialog } from 'ui.entity-selector';\nimport { Checker } from 'ui.form-elements.view';\n\ntype Params = {\n\tid: string,\n\ttitle: string,\n\tplaceholder: ?string,\n\tvalue: ?string,\n\tentitySelector: ?Dialog,\n\tunit: ?string,\n\tsize: ?string,\n};\n\nexport class ValueChecker\n{\n\t#params: Params;\n\n\t#layout: {\n\t\twrap: HTMLElement,\n\t\tchecker: Checker,\n\t\tcheckerValue: ?HTMLInputElement,\n\t\tdisabledValue: ?HTMLElement,\n\t\tentitySelector: ?HTMLElement,\n\t};\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#params = params;\n\t\tthis.#layout = {};\n\n\t\tif (this.#params.entitySelector)\n\t\t{\n\t\t\tthis.#params.value = this.#params.entitySelector.getPreselectedItems()[0]?.[1];\n\t\t}\n\t}\n\n\tisChecked(): boolean\n\t{\n\t\treturn this.#layout.checker.isChecked();\n\t}\n\n\tgetValue(): string\n\t{\n\t\tconst entitySelectorValue = this.#getSelectedItem()?.id;\n\n\t\treturn this.#layout.checkerValue?.value || entitySelectorValue || this.#params.placeholder;\n\t}\n\n\tsetErrors(errors: string[])\n\t{\n\t\tthis.#layout.checker?.setErrors(errors);\n\t}\n\n\tcleanError()\n\t{\n\t\tthis.#layout.checker?.cleanError();\n\t}\n\n\tgetInputNode(): HTMLInputElement\n\t{\n\t\treturn this.#renderInput();\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.#layout.wrap = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"tasks-flow__create-value-checker ${this.#params.value ? '' : '--off'}\"\n\t\t\t\tdata-id=\"tasks-flow-value-checker-${this.#params.id}\"\n\t\t\t>\n\t\t\t\t${this.#renderChecker()}\n\t\t\t\t${this.#renderValue()}\n\t\t\t\t${this.#renderEntitySelectorValue()}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#update();\n\n\t\tconst observer = new IntersectionObserver(() => {\n\t\t\tif (this.#layout.wrap.offsetWidth > 0)\n\t\t\t{\n\t\t\t\tthis.#update();\n\n\t\t\t\tobserver.disconnect();\n\t\t\t}\n\t\t});\n\t\tobserver.observe(this.#layout.wrap);\n\n\t\treturn this.#layout.wrap;\n\t}\n\n\t#renderChecker(): HTMLElement\n\t{\n\t\tthis.#layout.checker = new Checker({\n\t\t\tchecked: !!this.#params.value,\n\t\t\ttitle: this.#params.title,\n\t\t\thideSeparator: true,\n\t\t\tsize: this.#params.size ?? 'small',\n\t\t});\n\n\t\tthis.#layout.checker.subscribe('change', (baseEvent: BaseEvent) => {\n\t\t\tconst isChecked = baseEvent.getData();\n\n\t\t\tthis.#update();\n\n\t\t\tif (isChecked && this.#layout.checkerValue)\n\t\t\t{\n\t\t\t\tconst length = this.#layout.checkerValue.value.length;\n\n\t\t\t\tthis.#layout.checkerValue.focus();\n\t\t\t\tthis.#layout.checkerValue.setSelectionRange(length, length);\n\t\t\t}\n\t\t});\n\n\t\treturn this.#layout.checker.render();\n\t}\n\n\t#renderValue(): HTMLElement|string\n\t{\n\t\tif (!this.#params.placeholder)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tthis.#layout.disabledValue = Tag.render`\n\t\t\t<span class=\"tasks-flow__create-value-checker_text\">${this.getValue()}</span>\n\t\t`;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__create-value-checker_input\">\n\t\t\t\t${this.#renderInput()}\n\t\t\t\t<span>${this.#params.unit ?? ''}</span>\n\t\t\t\t${this.#layout.disabledValue}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderInput(): HTMLElement\n\t{\n\t\tif (this.#layout.checkerValue)\n\t\t{\n\t\t\treturn this.#layout.checkerValue;\n\t\t}\n\n\t\tthis.#layout.checkerValue = Tag.render`\n\t\t\t<input class=\"ui-ctl-element\" placeholder=\"${this.#params.placeholder}\" value=\"${this.#params.value ?? this.#params.placeholder}\">\n\t\t`;\n\n\t\tEvent.bind(this.#layout.checkerValue, 'input', () => this.#update());\n\n\t\treturn this.#layout.checkerValue;\n\t}\n\n\t#renderEntitySelectorValue(): HTMLElement|string\n\t{\n\t\tif (!this.#params.entitySelector)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tthis.#layout.entitySelector = Tag.render`\n\t\t\t<div class=\"tasks-flow-template-selector\">\n\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_SELECT')}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#params.entitySelector.subscribe('Item:onSelect', this.#onEntitySelectorItemSelectedHandler.bind(this));\n\t\tthis.#params.entitySelector.subscribe('Item:onDeselect', () => this.#update());\n\t\tthis.#params.entitySelector.subscribe('onLoad', () => this.#update());\n\t\tthis.#params.entitySelector.setTargetNode(this.#layout.entitySelector);\n\n\t\tEvent.bind(this.#layout.entitySelector, 'click', () => {\n\t\t\tif (this.isChecked())\n\t\t\t{\n\t\t\t\tthis.#params.entitySelector.show();\n\t\t\t}\n\t\t});\n\n\t\treturn this.#layout.entitySelector;\n\t}\n\n\t#onEntitySelectorItemSelectedHandler()\n\t{\n\t\tthis.#update();\n\t\tthis.#params.entitySelector.hide();\n\t}\n\n\t#update(): void\n\t{\n\t\tthis.#layout.wrap.closest('form')?.dispatchEvent(new window.Event('change'));\n\n\t\tDom.addClass(this.#layout.wrap, '--off');\n\t\tif (this.isChecked())\n\t\t{\n\t\t\tDom.removeClass(this.#layout.wrap, '--off');\n\t\t}\n\n\t\tif (this.#params.entitySelector)\n\t\t{\n\t\t\tthis.#layout.entitySelector.innerText = this.#getSelectedItem()?.title.text ?? Loc.getMessage('TASKS_FLOW_EDIT_FORM_SELECT');\n\t\t}\n\n\t\tif (!this.#params.placeholder)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#layout.disabledValue.innerText = this.getValue();\n\t\tDom.style(this.#layout.disabledValue, 'display', '');\n\t\tthis.#layout.checkerValue.style.width = `${this.#layout.disabledValue.offsetWidth + 7}px`;\n\t\tconst checkerField = this.#layout.wrap.querySelector('.ui-section__field');\n\t\tthis.#layout.checkerValue.style.height = `${checkerField.offsetHeight}px`;\n\t}\n\n\t#getSelectedItem(): any\n\t{\n\t\treturn this.#params.entitySelector?.getSelectedItems()[0];\n\t}\n}","type Params = {\n\tinput: HTMLInputElement,\n\tmin: ?number,\n\tmax: ?number,\n};\n\nclass BindFilterNumberInput\n{\n\t#params: Params;\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#params = params;\n\n\t\tthis.#bind(params.input);\n\t}\n\n\t#bind(input: HTMLInputElement): void\n\t{\n\t\tlet dispatchedProgrammatically = false;\n\t\tinput.addEventListener('input', () => {\n\t\t\tif (dispatchedProgrammatically)\n\t\t\t{\n\t\t\t\tdispatchedProgrammatically = false;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst textBeforeCursor = this.#getTextBeforeCursor(input);\n\n\t\t\tinput.value = this.#normalizeNumber(input.value) || '';\n\n\t\t\tthis.#setCursorToFormattedPosition(input, textBeforeCursor);\n\n\t\t\tdispatchedProgrammatically = true;\n\t\t\tinput.dispatchEvent(new Event('input'));\n\t\t});\n\t}\n\n\t#getTextBeforeCursor(input: HTMLInputElement): string\n\t{\n\t\tconst selectionStart = input.selectionStart;\n\t\tconst text = input.value.slice(0, selectionStart);\n\n\t\treturn this.#normalizeNumber(text);\n\t}\n\n\t#normalizeNumber(value: string): string\n\t{\n\t\tlet normalizedValue = value.replace(/\\D/g, '');\n\t\tnormalizedValue = parseInt(normalizedValue, 10);\n\t\tnormalizedValue = Math.max(this.#params.min ?? 1, normalizedValue);\n\t\tnormalizedValue = Math.min(this.#params.max ?? 9999, normalizedValue);\n\n\t\treturn `${normalizedValue || ''}`;\n\t}\n\n\t#setCursorToFormattedPosition(input: HTMLInputElement, textBeforeCursor: string): void\n\t{\n\t\tconst firstPart = textBeforeCursor.slice(0, -1);\n\t\tconst lastCharacter = textBeforeCursor.slice(-1);\n\t\tconst matches = input.value.match(`${firstPart}.*?${lastCharacter}`);\n\t\tif (!matches)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst match = matches[0];\n\t\tconst formattedPosition = input.value.indexOf(match) + match.length;\n\t\tinput.setSelectionRange(formattedPosition, formattedPosition);\n\t}\n}\n\nconst bindFilterNumberInput = (params: Params) => new BindFilterNumberInput(params);\n\nexport { bindFilterNumberInput };","import { Event } from 'main.core';\nimport { Popup } from 'main.popup';\n\ntype Params = {\n\ttext: string,\n};\n\nexport class Hint\n{\n\t#text: string;\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#text = params.text;\n\t}\n\n\tbindTo(bindElement: HTMLElement): HTMLElement\n\t{\n\t\tlet timer = null;\n\t\tlet hintNodePopup = null;\n\t\tlet handleScroll = null;\n\n\t\tEvent.bind(bindElement, 'mouseenter', () => {\n\t\t\ttimer = setTimeout(() => {\n\t\t\t\thintNodePopup = new Popup({\n\t\t\t\t\tbindElement: this.getBindRect(bindElement),\n\t\t\t\t\tangle: {\n\t\t\t\t\t\toffset: bindElement.offsetWidth / 2 + 23,\n\t\t\t\t\t},\n\t\t\t\t\tdarkMode: true,\n\t\t\t\t\tcontent: this.#text,\n\t\t\t\t\tanimation: 'fading-slide',\n\t\t\t\t\tcacheable: false,\n\t\t\t\t});\n\t\t\t\thandleScroll = () => {\n\t\t\t\t\thintNodePopup.setBindElement(this.getBindRect(bindElement));\n\t\t\t\t\thintNodePopup?.adjustPosition();\n\t\t\t\t};\n\t\t\t\tEvent.bind(document, 'scroll', handleScroll, true);\n\n\t\t\t\thintNodePopup.show();\n\t\t\t}, 100);\n\t\t});\n\n\t\tEvent.bind(bindElement, 'mouseleave', () => {\n\t\t\tclearTimeout(timer);\n\t\t\tif (hintNodePopup)\n\t\t\t{\n\t\t\t\tEvent.unbind(document, 'scroll', handleScroll, true);\n\t\t\t\thintNodePopup.close();\n\t\t\t\thintNodePopup = null;\n\t\t\t}\n\t\t});\n\n\t\treturn bindElement;\n\t}\n\n\tgetBindRect(bindElement: HTMLElement): DOMRect\n\t{\n\t\tconst rect = bindElement.getBoundingClientRect();\n\n\t\treturn new DOMRect(rect.x + window.scrollX, rect.y + window.scrollY, rect.width, rect.height);\n\t}\n}\n","import { ajax, Event, Loc, Tag, Type } from 'main.core';\nimport { TextInput, TextArea, UserSelector } from 'ui.form-elements.view';\nimport { IntervalSelector } from 'tasks.interval-selector';\nimport { FormPage } from './form-page';\nimport { ValueChecker } from '../value-checker';\nimport { bindFilterNumberInput } from '../bind-filter-number-input';\nimport { Hint } from '../hint';\nimport 'ui.hint';\n\nimport type { Flow } from '../edit-form';\n\ntype Params = {\n\tonChangeHandler: Function,\n};\n\nexport class AboutPage extends FormPage\n{\n\t#params: Params;\n\n\t#layout: {\n\t\taboutPageForm: HTMLFormElement,\n\n\t\tflowName: TextInput,\n\t\tflowDescription: TextInput,\n\t\ttaskCreatorsSelector: UserSelector,\n\t\tplannedCompletionTime: TextInput,\n\t\tplannedCompletionTimeIntervalSelector: IntervalSelector,\n\t\tskipWeekends: ValueChecker,\n\t};\n\n\t#flow: Flow;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\t\tthis.#params = params;\n\t\tthis.#layout = {};\n\t\tthis.#flow = {};\n\t}\n\n\tsetFlow(flow: Flow): void\n\t{\n\t\tthis.#flow = flow;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn 'about-flow';\n\t}\n\n\tgetTitle(): string\n\t{\n\t\treturn Loc.getMessage('TASKS_FLOW_EDIT_FORM_ABOUT_FLOW');\n\t}\n\n\tgetRequiredData(): string[]\n\t{\n\t\treturn ['name', 'plannedCompletionTime', 'taskCreators'];\n\t}\n\n\tshowErrors(incorrectData: string[]): void\n\t{\n\t\tif (incorrectData.includes('name'))\n\t\t{\n\t\t\tthis.#layout.flowName.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_NAME_ERROR')]);\n\t\t}\n\n\t\tif (incorrectData.includes('plannedCompletionTime'))\n\t\t{\n\t\t\tthis.#layout.plannedCompletionTime.setErrors(\n\t\t\t\t[Loc.getMessage('TASKS_FLOW_EDIT_FORM_PLANNED_COMPLETION_TIME_ERROR')],\n\t\t\t);\n\t\t}\n\n\t\tif (incorrectData.includes('taskCreators'))\n\t\t{\n\t\t\tthis.#layout.taskCreatorsSelector.setErrors(\n\t\t\t\t[Loc.getMessage('TASKS_FLOW_EDIT_FORM_TASKS_CREATORS_ERROR')],\n\t\t\t);\n\t\t}\n\t}\n\n\tcleanErrors(): void\n\t{\n\t\tthis.#layout.flowName.cleanError();\n\t\tthis.#layout.plannedCompletionTime.cleanError();\n\t\tthis.#layout.taskCreatorsSelector.cleanError();\n\t}\n\n\tgetFields(flowData: Flow = {}): Flow\n\t{\n\t\tconst plannedCompletionTimeValue = parseInt(this.#layout.plannedCompletionTime?.getValue(), 10);\n\t\tconst intervalDuration = this.#layout.plannedCompletionTimeIntervalSelector?.getDuration();\n\n\t\treturn {\n\t\t\tname: flowData.name ?? this.#layout.flowName?.getValue().trim(),\n\t\t\tdescription: flowData.description ?? this.#layout.flowDescription?.getValue(),\n\t\t\ttaskCreators: (flowData.taskCreators ?? this.#getTasksCreatorsFromSelector()),\n\t\t\tplannedCompletionTime: (\n\t\t\t\tflowData.plannedCompletionTime\n\t\t\t\t\t?? (plannedCompletionTimeValue * intervalDuration || 0)\n\t\t\t),\n\t\t\tmatchWorkTime: flowData.matchWorkTime ?? (this.#layout.skipWeekends?.isChecked() ?? true),\n\t\t};\n\t}\n\n\t#getTasksCreatorsFromSelector()\n\t{\n\t\tlet taskCreators = this.#layout.taskCreatorsSelector\n\t\t\t?.getSelector()\n\t\t\t.getTags()\n\t\t\t.map((tag) => [tag.entityId, tag.id])\n\t\t;\n\n\t\tif (Type.isUndefined(taskCreators) || taskCreators.length === 0)\n\t\t{\n\t\t\ttaskCreators = this.#layout.taskCreatorsSelector\n\t\t\t\t?.getSelector()\n\t\t\t\t?.getDialog()\n\t\t\t\t.getPreselectedItems()\n\t\t\t;\n\t\t}\n\n\t\treturn taskCreators;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.#layout.flowName = new TextInput({\n\t\t\tid: 'tasks-flow-edit-form-field-name',\n\t\t\tlabel: Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_NAME'),\n\t\t\tplaceholder: Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_NAME_EXAMPLE'),\n\t\t\tvalue: this.#flow.name,\n\t\t});\n\n\t\tthis.#layout.flowDescription = new TextArea({\n\t\t\tid: 'tasks-flow-edit-form-field-description',\n\t\t\tlabel: Loc.getMessage('TASKS_FLOW_EDIT_FORM_DESCRIPTION'),\n\t\t\tplaceholder: Loc.getMessage('TASKS_FLOW_EDIT_FORM_DESCRIPTION_EXAMPLE'),\n\t\t\tvalue: this.#flow.description,\n\t\t\tresizeOnlyY: true,\n\t\t});\n\n\t\tthis.#layout.taskCreatorsSelector = new UserSelector({\n\t\t\tid: 'tasks-flow-edit-form-field-creators',\n\t\t\tlabel: Loc.getMessage('TASKS_FLOW_EDIT_FORM_WHO_CAN_ADD_TASKS'),\n\t\t\tenableDepartments: true,\n\t\t\tvalues: this.#flow.taskCreators,\n\t\t});\n\n\t\tthis.#layout.aboutPageForm = Tag.render`\n\t\t\t<form class=\"tasks-flow__create-about\">\n\t\t\t\t${this.#layout.flowName.render()}\n\t\t\t\t${this.#layout.flowDescription.render()}\n\t\t\t\t<div class=\"tasks-flow__create-separator --empty\"></div>\n\t\t\t\t${this.#layout.taskCreatorsSelector.render()}\n\t\t\t\t<div class=\"tasks-flow__create-separator --empty\"></div>\n\t\t\t\t${this.#renderPlannedCompletionTime()}\n\t\t\t</form>\n\t\t`;\n\n\t\tBX.UI.Hint.init(this.#layout.aboutPageForm);\n\n\t\tEvent.bind(this.#layout.aboutPageForm, 'change', this.#params.onChangeHandler);\n\n\t\treturn this.#layout.aboutPageForm;\n\t}\n\n\tfocusToEmptyName()\n\t{\n\t\tconst isEmpty = this.#layout.flowName.getValue().trim().length === 0;\n\n\t\tif (isEmpty)\n\t\t{\n\t\t\tthis.#layout.flowName.getInputNode().focus();\n\t\t}\n\t}\n\n\t#renderPlannedCompletionTime(): HTMLElement\n\t{\n\t\tconst value = this.#flow.plannedCompletionTime;\n\t\tthis.#layout.plannedCompletionTimeIntervalSelector = new IntervalSelector({ value });\n\t\tconst duration = this.#layout.plannedCompletionTimeIntervalSelector.getDuration();\n\n\t\tconst plannedCompletionTimeLabel = `\n\t\t\t<div class=\"tasks-flow__create-title-with-hint\">\n\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_PLANNED_COMPLETION_TIME')}\n\t\t\t\t<span data-id=\"plannedCompletionTimeHint\" class=\"ui-hint\"><span class=\"ui-hint-icon\"></span></span>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#layout.plannedCompletionTime = new TextInput({\n\t\t\tlabel: plannedCompletionTimeLabel,\n\t\t\tplaceholder: '0',\n\t\t\tinputDefaultWidth: true,\n\t\t\tvalue: String(value / duration || ''),\n\t\t});\n\n\t\tconst maxInt = (2 ** 32) / 2 - 1;\n\t\tconst monthDuration = 60 * 60 * 24 * 31;\n\n\t\tbindFilterNumberInput({\n\t\t\tinput: this.#layout.plannedCompletionTime.getInputNode(),\n\t\t\tmax: Math.floor(maxInt / monthDuration),\n\t\t});\n\n\t\tthis.#layout.skipWeekends = new ValueChecker({\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_SKIP_WEEKENDS'),\n\t\t\tvalue: this.#flow.id === 0 || this.#flow.matchWorkTime,\n\t\t\tsize: 'extra-small',\n\t\t});\n\n\t\tconst root = Tag.render`\n\t\t\t<div data-id=\"tasks-flow-edit-form-field-planned-time\">\n\t\t\t\t<div class=\"tasks-flow__create-planned_completion-time\">\n\t\t\t\t\t${this.#layout.plannedCompletionTime.render()}\n\t\t\t\t\t<div class=\"tasks-flow__create-planned_completion-time-interval\">\n\t\t\t\t\t\t${this.#layout.plannedCompletionTimeIntervalSelector.render()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t${this.#layout.skipWeekends.render()}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst plannedCompletionTimeHint = root.querySelector('[data-id=plannedCompletionTimeHint]');\n\n\t\tconst hint = new Hint({ text: Loc.getMessage('TASKS_FLOW_EDIT_FORM_PLANNED_COMPLETION_TIME_HINT') });\n\t\thint.bindTo(plannedCompletionTimeHint);\n\n\t\treturn root;\n\t}\n\n\tasync onContinueClick(flowData: Flow = {}): Promise<boolean>\n\t{\n\t\tconst { data: response } = await ajax.runAction('tasks.flow.Flow.isExists', {\n\t\t\tdata: {\n\t\t\t\tflowData: flowData,\n\t\t\t},\n\t\t});\n\n\t\tif (response.exists)\n\t\t{\n\t\t\tthis.#layout.flowName.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_DUPLICATE_ERROR')]);\n\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n}\n","import { EventEmitter } from 'main.core.events';\n\nexport class PullRequests extends EventEmitter\n{\n\t#userId: number;\n\n\tconstructor(userId: number)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Flow.EditForm.PullRequests');\n\n\t\tthis.#userId = parseInt(userId, 10);\n\t}\n\n\tgetModuleId(): string\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap(): Object\n\t{\n\t\treturn {\n\t\t\ttemplate_add: this.#onTemplateAdded.bind(this),\n\t\t};\n\t}\n\n\t#onTemplateAdded(data): void\n\t{\n\t\tthis.emit('templateAdded', {\n\t\t\ttemplate: {\n\t\t\t\tid: data.TEMPLATE_ID,\n\t\t\t\ttitle: data.TEMPLATE_TITLE,\n\t\t\t},\n\t\t});\n\t}\n}\n","import { Dom, Event, Extension, Loc, Tag } from 'main.core';\nimport { PULL as Pull } from 'pull.client';\nimport { Dialog } from 'ui.entity-selector';\nimport { UserSelector } from 'ui.form-elements.view';\nimport { PullRequests } from '../pull-requests';\nimport { FormPage } from './form-page';\nimport { ValueChecker } from '../value-checker';\nimport { Hint } from '../hint';\n\nimport type { Flow } from '../edit-form';\n\ntype Params = {\n\tonChangeHandler: Function,\n};\n\nexport class SettingsPage extends FormPage\n{\n\t#params: Params;\n\n\t#layout: {\n\t\tsettingsPageForm: HTMLFormElement,\n\n\t\tqueueDistribution: HTMLElement,\n\t\tqueueRadio: HTMLInputElement,\n\t\tresponsiblesSelector: UserSelector,\n\t\tmanuallyDistribution: HTMLElement,\n\t\tmanuallyRadio: HTMLInputElement,\n\t\thimselfDistribution: HTMLElement,\n\t\thimselfRadio: HTMLInputElement,\n\t\tmoderatorSelector: UserSelector,\n\t\tresponsibleCanChangeDeadline: ValueChecker,\n\t\tnotifyAtHalfTime: ValueChecker,\n\t\ttaskControl: ValueChecker,\n\t\tprojectSelector: UserSelector,\n\t\ttaskTemplate: ValueChecker,\n\t\ttaskTemplateDialog: Dialog,\n\t};\n\n\t#flow: Flow;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\t\tthis.#params = params;\n\t\tthis.#layout = {};\n\t\tthis.#flow = {};\n\n\t\tthis.#init();\n\t}\n\n\tget #currentUser(): number\n\t{\n\t\tconst settings = Extension.getSettings('tasks.flow.edit-form');\n\n\t\treturn settings.currentUser;\n\t}\n\n\t#init()\n\t{\n\t\tthis.#subscribeToPull();\n\t}\n\n\t#subscribeToPull(): void\n\t{\n\t\tconst pullRequests = new PullRequests(this.#currentUser);\n\t\tpullRequests.subscribe('templateAdded', this.#onTemplateAddedHandler.bind(this));\n\n\t\tPull.subscribe(pullRequests);\n\t}\n\n\t#onTemplateAddedHandler({ data })\n\t{\n\t\tconst template = data.template;\n\t\tconst templateItem = {\n\t\t\tid: template.id,\n\t\t\tentityId: 'task-template',\n\t\t\ttitle: template.title,\n\t\t\ttabs: 'recents',\n\t\t};\n\n\t\tthis.#layout.taskTemplateDialog.addItem(templateItem);\n\n\t\tthis.#layout.taskTemplateDialog.getItems().find((item) => item.id === templateItem.id).select();\n\t}\n\n\tsetFlow(flow: Flow): void\n\t{\n\t\tthis.#flow = flow;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn 'settings';\n\t}\n\n\tgetTitle(): string\n\t{\n\t\treturn Loc.getMessage('TASKS_FLOW_EDIT_FORM_SETTINGS');\n\t}\n\n\tgetRequiredData(): string[]\n\t{\n\t\tconst requiredData = [\n\t\t\t'groupId',\n\t\t\tthis.getFields().distributionType === 'manually' ? 'manualDistributorId' : 'responsibleQueue',\n\t\t];\n\n\t\tif (this.#layout.taskTemplate.isChecked())\n\t\t{\n\t\t\trequiredData.push('templateId');\n\t\t}\n\n\t\treturn requiredData;\n\t}\n\n\tupdate(): void\n\t{\n\t\tsuper.update();\n\n\t\tDom.removeClass(this.#layout.queueDistribution, '--active');\n\t\tDom.removeClass(this.#layout.manuallyDistribution, '--active');\n\t\tDom.removeClass(this.#layout.himselfDistribution, '--active');\n\n\t\tif (this.#layout.queueRadio.checked)\n\t\t{\n\t\t\tDom.addClass(this.#layout.queueDistribution, '--active');\n\t\t}\n\n\t\tif (this.#layout.manuallyRadio.checked)\n\t\t{\n\t\t\tDom.addClass(this.#layout.manuallyDistribution, '--active');\n\t\t}\n\t}\n\n\tshowErrors(incorrectData: string[]): void\n\t{\n\t\tif (incorrectData.includes('responsibleQueue'))\n\t\t{\n\t\t\tthis.#layout.responsiblesSelector.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_TASKS_RESPONSIBLES_ERROR')]);\n\t\t}\n\n\t\tif (incorrectData.includes('manualDistributorId'))\n\t\t{\n\t\t\tthis.#layout.moderatorSelector.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_TASKS_MODERATOR_ERROR')]);\n\t\t}\n\n\t\tif (incorrectData.includes('groupId'))\n\t\t{\n\t\t\tthis.#layout.projectSelector.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_PROJECT_FOR_TASKS_ERROR')]);\n\t\t}\n\n\t\tif (incorrectData.includes('templateId'))\n\t\t{\n\t\t\tthis.#layout.taskTemplate.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_TEMPLATE_FOR_TASKS_ERROR')]);\n\t\t}\n\t}\n\n\tcleanErrors(): void\n\t{\n\t\tthis.#layout.projectSelector.cleanError();\n\t\tthis.#layout.responsiblesSelector.cleanError();\n\t\tthis.#layout.moderatorSelector.cleanError();\n\t\tthis.#layout.taskTemplate.cleanError();\n\t}\n\n\tgetFields(flowData: Flow = {}): Flow\n\t{\n\t\tlet responsibleQueue = this.#flow.responsibleQueue;\n\t\tif (this.#layout.responsiblesSelector?.getSelector().getDialog().isLoaded())\n\t\t{\n\t\t\tresponsibleQueue = this.#layout.responsiblesSelector?.getSelector().getTags().map((tag) => tag.id);\n\t\t}\n\n\t\tlet manualDistributorId = this.#flow.manualDistributorId;\n\t\tif (this.#layout.moderatorSelector?.getSelector().getDialog().isLoaded())\n\t\t{\n\t\t\tmanualDistributorId = this.#layout.moderatorSelector.getSelector().getTags()[0]?.id;\n\t\t}\n\n\t\tlet groupId = this.#flow.groupId;\n\t\tif (this.#layout.projectSelector?.getSelector().getDialog().isLoaded())\n\t\t{\n\t\t\tgroupId = this.#layout.projectSelector.getSelector().getTags()[0]?.id;\n\t\t}\n\n\t\treturn {\n\t\t\tdistributionType: flowData.distributionType ?? (new FormData(this.#layout.settingsPageForm).get('distribution') || 'queue'),\n\t\t\tresponsibleQueue: flowData.responsibleQueue ?? responsibleQueue,\n\t\t\tmanualDistributorId: flowData.manualDistributorId ?? (manualDistributorId || 0),\n\t\t\tresponsibleCanChangeDeadline: flowData.responsibleCanChangeDeadline ?? (this.#layout.responsibleCanChangeDeadline?.isChecked() ?? false),\n\t\t\tnotifyAtHalfTime: flowData.notifyAtHalfTime ?? (this.#layout.notifyAtHalfTime?.isChecked() ?? false),\n\t\t\ttaskControl: flowData.taskControl ?? (this.#layout.taskControl?.isChecked() ?? false),\n\t\t\tgroupId: flowData.groupId ?? (groupId || 0),\n\t\t\ttemplateId: flowData.templateId ?? (this.#layout.taskTemplate?.isChecked() ? this.#layout.taskTemplate.getValue() : 0),\n\t\t};\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.#layout.responsibleCanChangeDeadline = new ValueChecker({\n\t\t\tid: 'responsible-can-change-deadline',\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_RESPONSIBLE_CAN_CHANGE_DEADLINE'),\n\t\t\tvalue: this.#flow.responsibleCanChangeDeadline,\n\t\t});\n\n\t\tconst notifyAtHalfTimeTitle = `\n\t\t\t<div class=\"tasks-flow__create-title-with-hint\">\n\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_NOTIFY_AT_HALF_TIME')}\n\t\t\t\t<span data-id=\"notifyAtHalfTimeHint\" class=\"ui-hint ui-hint-flow-value-checker\">\n\t\t\t\t\t<span class=\"ui-hint-icon ui-hint-icon-flow-value-checker\"></span>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#layout.notifyAtHalfTime = new ValueChecker({\n\t\t\tid: 'notify-at-half-time',\n\t\t\ttitle: notifyAtHalfTimeTitle,\n\t\t\tvalue: this.#flow.notifyAtHalfTime,\n\t\t});\n\n\t\tthis.#layout.taskControl = new ValueChecker({\n\t\t\tid: 'task-control',\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_TASK_CONTROL'),\n\t\t\tvalue: this.#flow.taskControl,\n\t\t});\n\n\t\tthis.#layout.projectSelector = new UserSelector({\n\t\t\tlabel: Loc.getMessage('TASKS_FLOW_EDIT_FORM_PROJECT_FOR_TASKS'),\n\t\t\tenableUsers: false,\n\t\t\tenableDepartments: false,\n\t\t\tmultiple: false,\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: 'project',\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tfeatures: {\n\t\t\t\t\t\t\ttasks: [],\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\tvalues: this.#flow.groupId ? [['project', this.#flow.groupId]] : [],\n\t\t});\n\n\t\tthis.#layout.taskTemplate = new ValueChecker({\n\t\t\tid: 'task-template',\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_ACCEPT_TASKS_BY_TEMPLATE_TITLE'),\n\t\t\tentitySelector: this.#getTaskTemplateDialog(),\n\t\t});\n\n\t\tthis.#layout.settingsPageForm = Tag.render`\n\t\t\t<form class=\"tasks-flow__create-settings\">\n\t\t\t\t${this.#renderDistribution()}\n\t\t\t\t<div class=\"tasks-flow__create-separator --empty\"></div>\n\t\t\t\t${this.#layout.responsibleCanChangeDeadline.render()}\n\t\t\t\t${this.#layout.notifyAtHalfTime.render()}\n\t\t\t\t${this.#layout.taskControl.render()}\n\t\t\t\t<div class=\"tasks-flow__create-separator\"></div>\n\t\t\t\t${this.#layout.projectSelector.render()}\n\t\t\t\t<div class=\"tasks-flow__create-separator --empty\"></div>\n\t\t\t\t${this.#layout.taskTemplate.render()}\n\t\t\t</form>\n\t\t`;\n\n\t\tEvent.bind(this.#layout.settingsPageForm, 'change', this.#params.onChangeHandler);\n\n\t\tconst notifyAtHalfTimeHint = this.#layout.settingsPageForm.querySelector('[data-id=notifyAtHalfTimeHint]');\n\n\t\tconst hint = new Hint({ text: Loc.getMessage('TASKS_FLOW_EDIT_FORM_NOTIFY_AT_HALF_TIME_HINT') });\n\t\thint.bindTo(notifyAtHalfTimeHint);\n\n\t\treturn this.#layout.settingsPageForm;\n\t}\n\n\t#renderDistribution(): HTMLElement\n\t{\n\t\tthis.#layout.responsiblesSelector = new UserSelector({\n\t\t\tenableAll: false,\n\t\t\tenableDepartments: false,\n\t\t\tvalues: this.#flow.responsibleQueue?.map((responsibleId) => ['user', responsibleId]),\n\t\t\tlabel: Loc.getMessage('TASKS_FLOW_EDIT_FORM_DISTRIBUTION_QUEUE_SELECTOR_LABEL'),\n\t\t});\n\n\t\tthis.#layout.moderatorSelector = new UserSelector({\n\t\t\tenableAll: false,\n\t\t\tenableDepartments: false,\n\t\t\tmultiple: false,\n\t\t\tvalues: [['user', this.#flow.manualDistributorId || this.#currentUser]],\n\t\t});\n\n\t\tconst { root: queueDistribution, radio: queueRadio } = this.#renderDistributionType({\n\t\t\ttype: 'queue',\n\t\t\tselector: this.#layout.responsiblesSelector,\n\t\t});\n\t\tthis.#layout.queueDistribution = queueDistribution;\n\t\tthis.#layout.queueRadio = queueRadio;\n\n\t\tconst { root: manuallyDistribution, radio: manuallyRadio } = this.#renderDistributionType({\n\t\t\ttype: 'manually',\n\t\t\tselector: this.#layout.moderatorSelector,\n\t\t});\n\t\tthis.#layout.manuallyDistribution = manuallyDistribution;\n\t\tthis.#layout.manuallyRadio = manuallyRadio;\n\n\t\tconst { root: himselfDistribution, radio: himselfRadio } = this.#renderDistributionType({\n\t\t\ttype: 'himself',\n\t\t});\n\t\tthis.#layout.himselfDistribution = himselfDistribution;\n\t\tthis.#layout.himselfRadio = himselfRadio;\n\n\t\tthis.#layout.queueRadio.checked = this.#flow.distributionType === 'queue';\n\t\tthis.#layout.manuallyRadio.checked = this.#flow.distributionType === 'manually';\n\t\tthis.update();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-section__field-container\">\n\t\t\t\t<div class=\"ui-section__field-label_box\">\n\t\t\t\t\t<label class=\"ui-section__field-label\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_DISTRIBUTION_TYPE')}\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t\t${this.#layout.queueDistribution}\n\t\t\t\t${this.#layout.manuallyDistribution}\n\t\t\t\t${this.#layout.himselfDistribution}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderDistributionType({ type, selector }): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__create-distribution-type --${type}\" data-id=\"tasks-flow-distribution-${type}\">\n\t\t\t\t<label class=\"ui-ctl ui-ctl-radio ui-ctl-wa\">\n\t\t\t\t\t<input type=\"radio\" name=\"distribution\" value=\"${type}\" class=\"ui-ctl-element\" ref=\"radio\">\n\t\t\t\t\t<div class=\"tasks-flow__create-distribution-type_title-container\">\n\t\t\t\t\t\t<div class=\"tasks-flow__create-distribution-type_content\">\n\t\t\t\t\t\t<div class=\"tasks-flow__create-distribution-type_title\">\n\t\t\t\t\t\t\t\t<div class=\"tasks-flow__create-distribution-type_title-text\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage(`TASKS_FLOW_EDIT_FORM_DISTRIBUTION_${type.toUpperCase()}`)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span class=\"tasks-flow__create-distribution-type_label ui-label ui-label-primary ui-label-fill\">\n\t\t\t\t\t\t\t\t\t<span class=\"ui-label-inner\">\n\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_ANALYTICS_STUB_BUTTON')}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-flow__create-distribution-type_hint\">\n\t\t\t\t\t\t\t\t${Loc.getMessage(`TASKS_FLOW_EDIT_FORM_DISTRIBUTION_${type.toUpperCase()}_HINT`)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-flow__create-distribution-type_icon --${type}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</label>\n\t\t\t\t<div class=\"tasks-flow__create-distribution-type_selector\">\n\t\t\t\t\t${selector?.render()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getTaskTemplateDialog(): Dialog\n\t{\n\t\tthis.#layout.taskTemplateDialog = new Dialog({\n\t\t\twidth: 500,\n\t\t\tcontext: 'flow',\n\t\t\tpreselectedItems: this.#flow.templateId ? [['task-template', this.#flow.templateId]] : '',\n\t\t\tenableSearch: true,\n\t\t\tmultiple: false,\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: 'task-template',\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\n\t\treturn this.#layout.taskTemplateDialog;\n\t}\n}\n","import { Event, Extension, Loc, Tag } from 'main.core';\nimport { UserSelector } from 'ui.form-elements.view';\nimport { FormPage } from './form-page';\nimport { ValueChecker } from '../value-checker';\nimport { bindFilterNumberInput } from '../bind-filter-number-input';\nimport { Hint } from '../hint';\n\nimport type { Flow } from '../edit-form';\n\ntype Params = {\n\tonChangeHandler: Function,\n};\n\nexport class ControlPage extends FormPage\n{\n\t#params: Params;\n\n\t#layout: {\n\t\tcontrolPageForm: HTMLFormElement,\n\n\t\tflowOwnerSelector: UserSelector,\n\t\tnotifyOnQueueOverflow: ValueChecker,\n\t\tnotifyOnTasksInProgressOverflow: ValueChecker,\n\t\tnotifyWhenEfficiencyDecreases: ValueChecker,\n\t\tanalyticsPermissionsSelector: UserSelector,\n\t};\n\n\t#flow: Flow;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\t\tthis.#params = params;\n\t\tthis.#layout = {};\n\t\tthis.#flow = {};\n\t}\n\n\tget #currentUser(): number\n\t{\n\t\tconst settings = Extension.getSettings('tasks.flow.edit-form');\n\n\t\treturn settings.currentUser;\n\t}\n\n\tsetFlow(flow: Flow): void\n\t{\n\t\tthis.#flow = flow;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn 'control';\n\t}\n\n\tgetTitle(): string\n\t{\n\t\treturn Loc.getMessage('TASKS_FLOW_EDIT_FORM_CONTROL');\n\t}\n\n\tgetRequiredData(): string[]\n\t{\n\t\treturn this.#getCheckerValues().filter((checker) => this.#layout[checker].isChecked());\n\t}\n\n\tshowErrors(incorrectData: string[]): void\n\t{\n\t\tif (incorrectData.includes('ownerId'))\n\t\t{\n\t\t\tthis.#layout.flowOwnerSelector.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_OWNER_ERROR')]);\n\t\t}\n\n\t\tthis.#getCheckerValues().forEach((checker) => {\n\t\t\tif (incorrectData.includes(checker))\n\t\t\t{\n\t\t\t\tthis.#layout[checker].setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_VALUE_ERROR')]);\n\t\t\t}\n\t\t});\n\t}\n\n\tcleanErrors(): void\n\t{\n\t\tthis.#layout.flowOwnerSelector.cleanError();\n\t\tthis.#getCheckerValues().forEach((checker) => this.#layout[checker].cleanError());\n\t}\n\n\t#getCheckerValues(): string[]\n\t{\n\t\treturn ['notifyOnQueueOverflow', 'notifyOnTasksInProgressOverflow', 'notifyWhenEfficiencyDecreases'];\n\t}\n\n\tgetFields(flowData: Flow = {}): Flow\n\t{\n\t\tlet ownerId = this.#currentUser;\n\t\tif (this.#layout.flowOwnerSelector?.getSelector().getDialog().isLoaded())\n\t\t{\n\t\t\townerId = this.#layout.flowOwnerSelector.getSelector().getTags()[0]?.id;\n\t\t}\n\n\t\treturn {\n\t\t\townerId: flowData.ownerId || (ownerId || 0),\n\n\t\t\tnotifyOnQueueOverflow: flowData.notifyOnQueueOverflow ?? this.#getCheckerNumericValue(this.#layout.notifyOnQueueOverflow),\n\t\t\tnotifyOnTasksInProgressOverflow: flowData.notifyOnTasksInProgressOverflow ?? this.#getCheckerNumericValue(this.#layout.notifyOnTasksInProgressOverflow),\n\t\t\tnotifyWhenEfficiencyDecreases: flowData.notifyWhenEfficiencyDecreases ?? this.#getCheckerNumericValue(this.#layout.notifyWhenEfficiencyDecreases),\n\t\t}\n\t}\n\n\t#getCheckerNumericValue(checker: ?ValueChecker)\n\t{\n\t\treturn checker?.isChecked() ? this.#getInteger(checker.getValue()) : null;\n\t}\n\n\t#getInteger(value: string): boolean\n\t{\n\t\treturn /^\\d+$/.test(value) ? parseInt(value, 10) : 0;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst flowOwnerLabel = `\n\t\t\t<div class=\"tasks-flow__create-title-with-hint\">\n\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_OWNER')}\n\t\t\t\t<span data-id=\"flowOwnerHint\" class=\"ui-hint\"><span class=\"ui-hint-icon\"></span></span>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#layout.flowOwnerSelector = new UserSelector({\n\t\t\tid: 'tasks-flow-edit-form-field-owner',\n\t\t\tlabel: flowOwnerLabel,\n\t\t\tenableAll: false,\n\t\t\tenableDepartments: false,\n\t\t\tmultiple: false,\n\t\t\tvalues: [['user', this.#flow.ownerId]],\n\t\t});\n\n\t\tthis.#layout.notifyOnQueueOverflow = new ValueChecker({\n\t\t\tid: 'notify-on-queue-overflow',\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_NOTIFY_ON_QUEUE_OVERFLOW'),\n\t\t\tplaceholder: 50,\n\t\t\tvalue: this.#flow.notifyOnQueueOverflow,\n\t\t\tsize: 'extra-small',\n\t\t});\n\n\t\tbindFilterNumberInput({\n\t\t\tinput: this.#layout.notifyOnQueueOverflow.getInputNode(),\n\t\t\tmax: 99999,\n\t\t});\n\n\t\tthis.#layout.notifyOnTasksInProgressOverflow = new ValueChecker({\n\t\t\tid: 'notify-on-tasks-in-progress-overflow',\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_NOTIFY_ON_TASKS_IN_PROGRESS_OVERFLOW'),\n\t\t\tplaceholder: 50,\n\t\t\tvalue: this.#flow.notifyOnTasksInProgressOverflow,\n\t\t\tsize: 'extra-small',\n\t\t});\n\n\t\tbindFilterNumberInput({\n\t\t\tinput: this.#layout.notifyOnTasksInProgressOverflow.getInputNode(),\n\t\t\tmax: 99999,\n\t\t});\n\n\t\tthis.#layout.notifyWhenEfficiencyDecreases = new ValueChecker({\n\t\t\tid: 'notify-when-efficiency-decreases',\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_NOTIFY_WHEN_EFFICIENCY_DECREASES'),\n\t\t\tplaceholder: 70,\n\t\t\tunit: '%',\n\t\t\tvalue: this.#flow.notifyWhenEfficiencyDecreases,\n\t\t\tsize: 'extra-small',\n\t\t});\n\n\t\tbindFilterNumberInput({\n\t\t\tinput: this.#layout.notifyWhenEfficiencyDecreases.getInputNode(),\n\t\t\tmax: 100,\n\t\t});\n\n\t\tthis.#layout.analyticsPermissionsSelector = new UserSelector({\n\t\t\tid: 'tasks-flow-edit-form-field-analytics',\n\t\t\tlabel: Loc.getMessage('TASKS_FLOW_EDIT_FORM_ANALYTICS_PERMISSIONS'),\n\t\t\tenableAll: true,\n\t\t\tenableDepartments: true,\n\t\t\tclassName: '',\n\t\t});\n\n\t\tthis.#layout.controlPageForm = Tag.render`\n\t\t\t<form class=\"tasks-flow__create-control\">\n\t\t\t\t${this.#layout.flowOwnerSelector.render()}\n\t\t\t\t${this.#layout.notifyOnQueueOverflow.render()}\n\t\t\t\t${this.#layout.notifyOnTasksInProgressOverflow.render()}\n\t\t\t\t${this.#layout.notifyWhenEfficiencyDecreases.render()}\n\t\t\t\t<div class=\"tasks-flow__create-separator\"></div>\n\t\t\t\t${this.#renderAnalyticsStub()}\n\t\t\t</form>\n\t\t`;\n\n\t\tEvent.bind(this.#layout.controlPageForm, 'change', this.#params.onChangeHandler);\n\n\t\tconst flowOwnerHint = this.#layout.controlPageForm.querySelector('[data-id=flowOwnerHint]');\n\n\t\tconst hint = new Hint({ text: Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_OWNER_HINT') });\n\t\thint.bindTo(flowOwnerHint);\n\n\t\treturn this.#layout.controlPageForm;\n\t}\n\n\t#renderAnalyticsStub(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__create_analytics-stub\">\n\t\t\t\t<span>${Loc.getMessage('TASKS_FLOW_EDIT_FORM_ANALYTICS_STUB_LABEL')}</span>\n\t\t\t\t<span class=\"tasks-flow__create_analytics-stub-label ui-label ui-label-primary ui-label-fill\">\n\t\t\t\t\t<span class=\"ui-label-inner\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_ANALYTICS_STUB_BUTTON')}\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t`;\n\t}\n}\n","import { ajax, Event, Loc, Tag, Type } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Popup } from 'main.popup';\nimport { Button, ButtonState } from 'ui.buttons';\nimport { Wizard } from 'tasks.wizard';\nimport { FormPage } from './pages/form-page';\nimport { AboutPage } from './pages/about-page';\nimport { SettingsPage } from './pages/settings-page';\nimport { ControlPage } from './pages/control-page';\nimport { Lottie } from 'ui.lottie';\nimport flowfLottieIconInfo from '../lottie/tasks-flow-info-icon.json';\nimport 'ui.sidepanel-content';\nimport 'ui.forms';\nimport './style.css';\n\ntype Params = {\n\tflowId?: number,\n\tflowName?: string,\n\tdemoFlow?: 'Y' | 'N',\n\tguideFlow?: 'Y' | 'N',\n};\n\ntype DistributionType = 'manually' | 'queue' | 'by_workload';\n\nexport type Flow = {\n\tid: ?number,\n\tname: string,\n\tdescription: string,\n\ttaskCreators: string[],\n\tplannedCompletionTime: number,\n\tmatchWorkTime: boolean,\n\ttemplateId: number,\n\tresponsibleQueue: number[],\n\tresponsibleCanChangeDeadline: boolean,\n\tdistributionType: DistributionType,\n\tgroupId: number,\n\townerId: number,\n\tmanualDistributorId: number,\n\tdemo: boolean,\n\tnotifyOnQueueOverflow: ?number,\n\tnotifyOnTasksInProgressOverflow: ?number,\n\tnotifyWhenEfficiencyDecreases: ?number,\n\tnotifyAtHalfTime: boolean,\n\ttaskControl: boolean,\n\ttrialFeatureEnabled: boolean;\n};\n\nconst SLIDER_WIDTH = 692;\nconst HELPDESK_ARTICLE = 21272066;\n\nexport class EditForm extends EventEmitter\n{\n\t#params: Params;\n\n\t#layout: {};\n\n\t#wizard: Wizard;\n\t#pages: FormPage[];\n\t#finishButton: Button;\n\t#saveChangesButton: Button;\n\n\t#flow: Flow;\n\n\t#flowLottieAnimation: any = null;\n\t#lottieIconContainer: HTMLElement;\n\n\t#pageChanging: boolean = false;\n\n\tconstructor(params: Params = {})\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Flow.EditForm');\n\n\t\tthis.#params = params;\n\t\tthis.#layout = {};\n\t\tthis.#flowLottieAnimation = null;\n\t\tthis.#lottieIconContainer = null;\n\n\t\tconst onChangeHandler = this.#onChangeHandler.bind(this);\n\t\tthis.#pages = [\n\t\t\tnew AboutPage({ onChangeHandler }),\n\t\t\tnew SettingsPage({ onChangeHandler }),\n\t\t\tnew ControlPage({ onChangeHandler }),\n\t\t];\n\n\t\tconst initFlowData = {\n\t\t\tnotifyAtHalfTime: true,\n\t\t\tresponsibleCanChangeDeadline: true,\n\t\t\ttaskControl: true,\n\t\t\tnotifyOnQueueOverflow: 50,\n\t\t\tnotifyOnTasksInProgressOverflow: 50,\n\t\t\tnotifyWhenEfficiencyDecreases: 70,\n\t\t\ttaskCreators: [\n\t\t\t\t['meta-user', 'all-users'],\n\t\t\t],\n\t\t};\n\t\tif (this.#params.flowName)\n\t\t{\n\t\t\tinitFlowData.name = this.#params.flowName;\n\t\t}\n\n\t\tthis.#flow = this.#getFlow(initFlowData);\n\t}\n\n\tstatic createInstance(params: Params = {}): EditForm\n\t{\n\t\tconst instance = new EditForm(params);\n\t\tinstance.openInSlider();\n\n\t\treturn instance;\n\t}\n\n\topenInSlider()\n\t{\n\t\ttop.BX.SidePanel.Instance.open(`tasks-flow-create-slider-${this.#flow.id}`, {\n\t\t\tcacheable: true,\n\t\t\tcontentCallback: async (slider) => {\n\t\t\t\tthis.slider = slider;\n\n\t\t\t\tconst {data: noAccess} = await ajax.runAction('tasks.flow.View.Access.check', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tflowId: this.#flow.id > 0 ? this.#flow.id : 0,\n\t\t\t\t\t\tcontext: 'edit-form',\n\t\t\t\t\t\tdemoFlow: this.#params.demoFlow,\n\t\t\t\t\t\tguideFlow: this.#params.guideFlow,\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (noAccess !== null)\n\t\t\t\t{\n\t\t\t\t\treturn Tag.render`${noAccess.html}`;\n\t\t\t\t}\n\n\t\t\t\tif (this.#flow.id > 0)\n\t\t\t\t{\n\t\t\t\t\tconst { data: flowData, error } = await ajax.runAction('tasks.flow.Flow.get', {\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tflowId: this.#flow.id,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.#flow = this.#getFlow(flowData);\n\t\t\t\t}\n\n\t\t\t\tthis.#pages.forEach((page) => page.setFlow(this.#flow));\n\n\t\t\t\treturn this.#render();\n\t\t\t},\n\t\t\twidth: SLIDER_WIDTH,\n\t\t\tevents: {\n\t\t\t\tonLoad: () => {\n\t\t\t\t\tconst aboutPage = this.#pages\n\t\t\t\t\t\t.find((page) => page.getId() === 'about-flow')\n\t\t\t\t\t;\n\t\t\t\t\taboutPage.focusToEmptyName();\n\t\t\t\t},\n\t\t\t\tonClose: () => {\n\t\t\t\t\tthis.emit('afterClose');\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\t#render()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__create\">\n\t\t\t\t${this.#renderHeader()}\n\t\t\t\t${this.#renderWizard()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderHeader(): HTMLElement\n\t{\n\t\tconst title = (\n\t\t\tLoc.getMessage(this.#flow.id\n\t\t\t\t? 'TASKS_FLOW_EDIT_FORM_HEADER_TITLE_EDIT'\n\t\t\t\t: 'TASKS_FLOW_EDIT_FORM_HEADER_TITLE')\n\t\t);\n\n\t\tconst subTitle = (\n\t\t\tLoc.getMessage(this.#flow.id\n\t\t\t\t? 'TASKS_FLOW_EDIT_FORM_HEADER_SUBTITLE'\n\t\t\t\t: 'TASKS_FLOW_EDIT_FORM_HEADER_SUBTITLE_CREATE')\n\t\t);\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-slider-section ui-slider-section-icon-center --rounding --icon-sm\">\n\t\t\t\t<span class=\"tasks-flow__create-header_icon ui-icon ui-slider-icon\"></span>\n\t\t\t\t<div class=\"ui-slider-content-box\">\n\t\t\t\t\t<div class=\"ui-slider-heading-2\">${title}</div>\n\t\t\t\t\t<div class=\"ui-slider-inner-box\">\n\t\t\t\t\t\t<p class=\"ui-slider-paragraph-2\">\n\t\t\t\t\t\t\t${subTitle}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderWizard(): HTMLElement\n\t{\n\t\tthis.#wizard = new Wizard({\n\t\t\tsteps: this.#pages.map((page) => ({\n\t\t\t\tid: page.getId(),\n\t\t\t\ttitle: page.getTitle(),\n\t\t\t\tcontent: page.render(),\n\t\t\t\tisFilled: () => !this.#hasIncorrectData(page.getRequiredData()),\n\t\t\t})),\n\t\t\tonCancel: () => this.slider.close(false, () => this.slider.destroy()),\n\t\t\tonDisabledContinueButtonClick: this.#showErrors.bind(this),\n\t\t\tonContinueHandler: this.#onContinueHandler.bind(this),\n\t\t\tfinishButton: this.#getFinishButton(),\n\t\t\tsaveChangesButton: this.#getSaveChangesButton(),\n\t\t\tarticle: HELPDESK_ARTICLE,\n\t\t});\n\n\t\treturn this.#wizard.render();\n\t}\n\n\t#saveChangesAction(): ?Function\n\t{\n\t\tconst isEdit = this.#flow.id > 0;\n\n\t\tif (!isEdit || this.#flow.demo)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.#saveFlowAction();\n\t}\n\n\t#getFinishButton(): Button\n\t{\n\t\tthis.#finishButton ??= new Button({\n\t\t\ttext: Loc.getMessage(this.#flow.id ? 'TASKS_FLOW_EDIT_FORM_SAVE_FLOW' : 'TASKS_FLOW_EDIT_FORM_CREATE_FLOW'),\n\t\t\tcolor: Button.Color.PRIMARY,\n\t\t\tround: true,\n\t\t\tsize: Button.Size.LARGE,\n\t\t\tonclick: () => this.#saveFlowAction(),\n\t\t});\n\n\t\treturn this.#finishButton;\n\t}\n\n\t#getSaveChangesButton(): ?Button\n\t{\n\t\tif (!this.#flow.id || this.#flow.demo)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tthis.#saveChangesButton ??= new Button({\n\t\t\ttext: Loc.getMessage('TASKS_FLOW_EDIT_FORM_SAVE_CHANGES'),\n\t\t\tcolor: Button.Color.SUCCESS,\n\t\t\tround: true,\n\t\t\tsize: BX.UI.Button.Size.LARGE,\n\t\t\tonclick: () => this.#saveChangesAction(),\n\t\t});\n\n\t\treturn this.#saveChangesButton;\n\t}\n\n\t#onChangeHandler(): void\n\t{\n\t\tthis.#flow = this.#getFlow();\n\t\tthis.#pages.forEach((page) => page.update());\n\t\tthis.#wizard.update();\n\t}\n\n\t#saveFlowAction(): void\n\t{\n\t\tif (this.#hasIncorrectData())\n\t\t{\n\t\t\tthis.#showErrors();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.#saveChangesButton?.isDisabled() || this.#finishButton?.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#saveChangesButton?.setState(ButtonState.DISABLED);\n\t\tthis.#finishButton?.setState(ButtonState.DISABLED);\n\n\t\tconst flowData = Object.fromEntries(Object.entries(this.#getFlow()).map(([key, value]) => [\n\t\t\tkey,\n\t\t\tType.isBoolean(value) ? (value ? 1 : 0) : value,\n\t\t]));\n\n\t\tconst action = flowData.id ? 'update' : 'create';\n\t\tconst textNotification = flowData.id ? 'TASKS_FLOW_EDIT_FORM_FLOW_UPDATE' : 'TASKS_FLOW_EDIT_FORM_FLOW_CREATE';\n\n\t\tajax.runAction(\n\t\t\t`tasks.flow.Flow.${flowData.demo ? 'activateDemo' : action}`,\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tflowData,\n\t\t\t\t\tguideFlow: this.#params.guideFlow,\n\t\t\t\t},\n\t\t\t},\n\t\t).then((response) => {\n\t\t\tif (response.status === 'success')\n\t\t\t{\n\t\t\t\tconst flowData: Flow = response.data;\n\n\t\t\t\tthis.emit('afterSave', flowData);\n\n\t\t\t\tthis.slider.close(false, () => {\n\t\t\t\t\tif (flowData.trialFeatureEnabled)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#showDemoInfo();\n\t\t\t\t\t}\n\t\t\t\t\tthis.slider.destroy();\n\t\t\t\t});\n\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: Loc.getMessage(textNotification),\n\t\t\t\t\twidth: 'auto',\n\t\t\t\t});\n\t\t\t}\n\t\t}, (error) => {\n\t\t\t\tthis.#saveChangesButton?.setState(null);\n\t\t\t\tthis.#finishButton?.setState(null);\n\t\t\t\talert(error.errors.map((e) => e.message).join('\\n'))\n\t\t\t}\n\t\t);\n\t}\n\n\t#showErrors(): void\n\t{\n\t\tconst incorrectData = this.#getIncorrectData();\n\t\tthis.#pages.forEach((page) => page.showErrors(incorrectData));\n\t}\n\n\t#showDemoInfo(): void\n\t{\n\t\tconst popup: Popup = new Popup({\n\t\t\tid: 'tasks-flow-task-demo-info',\n\t\t\tclassName: 'tasks-flow__task-demo-info',\n\t\t\twidth: 620,\n\t\t\toverlay: true,\n\t\t\tpadding: 48,\n\t\t\tcloseIcon: true,\n\t\t\tcontent: this.#renderDemoInfoContent(),\n\t\t\tevents: {\n\t\t\t\tonFirstShow: (baseEvent: BaseEvent) => {\n\t\t\t\t\tthis.#bindStartWorkBtn(baseEvent.getTarget());\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\t#renderDemoInfoContent(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__task-demo-info_wrapper\">\n\t\t\t\t<div class=\"tasks-flow__task-demo-info_content\">\n\t\t\t\t\t<div class=\"tasks-flow__task-demo-info_title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_DEMO_INFO_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-flow__task-demo-info_text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_DEMO_INFO_TEXT')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-flow__task-demo-info_text-trial\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_DEMO_INFO_TEXT_TRIAL')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-btn ui-btn-sm ui-btn-primary ui-btn-round ui-btn-no-caps\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_DEMO_INFO_BTN')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t${this.#getLottieIconContainer()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getLottieIconContainer(): HTMLElement\n\t{\n\t\tif (!this.#lottieIconContainer)\n\t\t{\n\t\t\tthis.#lottieIconContainer = Tag.render`\n\t\t\t\t<div class=\"tasks-flow__task-demo-info_image\"></div>\n\t\t\t`;\n\n\t\t\tthis.#flowLottieAnimation = Lottie.loadAnimation({\n\t\t\t\tcontainer: this.#lottieIconContainer,\n\t\t\t\trenderer: 'svg',\n\t\t\t\tloop: false,\n\t\t\t\tanimationData: flowfLottieIconInfo,\n\t\t\t});\n\t\t}\n\n\t\treturn this.#lottieIconContainer;\n\t}\n\n\t#bindStartWorkBtn(popup: Popup)\n\t{\n\t\tconst popupContainer = popup.getContentContainer();\n\t\tif (Type.isDomNode(popupContainer))\n\t\t{\n\t\t\tconst btnNode = popup.getContentContainer().querySelector('.ui-btn');\n\t\t\tif (Type.isDomNode(popupContainer))\n\t\t\t{\n\t\t\t\tEvent.bind(btnNode, 'click', () => popup.close());\n\t\t\t}\n\t\t}\n\t}\n\n\t#hasIncorrectData(fields: string[] = []): boolean\n\t{\n\t\tconst incorrectData = this.#getIncorrectData();\n\n\t\tfor (const field of fields)\n\t\t{\n\t\t\tif (incorrectData.includes(field))\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn !Type.isArrayFilled(fields) && Type.isArrayFilled(incorrectData);\n\t}\n\n\t#getIncorrectData(): string[]\n\t{\n\t\tconst flowData = this.#flow;\n\n\t\tconst incorrectData = [];\n\t\tif (!Type.isStringFilled(flowData.name))\n\t\t{\n\t\t\tincorrectData.push('name');\n\t\t}\n\n\t\tif (flowData.plannedCompletionTime <= 0)\n\t\t{\n\t\t\tincorrectData.push('plannedCompletionTime');\n\t\t}\n\n\t\tif (!Type.isArrayFilled(flowData.taskCreators))\n\t\t{\n\t\t\tincorrectData.push('taskCreators');\n\t\t}\n\n\t\tif (flowData.distributionType === 'manually' && flowData.manualDistributorId <= 0)\n\t\t{\n\t\t\tincorrectData.push('manualDistributorId');\n\t\t}\n\n\t\tif (flowData.distributionType === 'queue' && !Type.isArrayFilled(flowData.responsibleQueue))\n\t\t{\n\t\t\tincorrectData.push('responsibleQueue');\n\t\t}\n\n\t\tif (flowData.id > 0 && flowData.groupId <= 0 && flowData.demo === false)\n\t\t{\n\t\t\tincorrectData.push('groupId');\n\t\t}\n\n\t\tif (!Type.isNumber(flowData.templateId))\n\t\t{\n\t\t\tincorrectData.push('templateId');\n\t\t}\n\n\t\tif (flowData.ownerId <= 0)\n\t\t{\n\t\t\tincorrectData.push('ownerId');\n\t\t}\n\n\t\tif (Type.isNumber(flowData.notifyOnQueueOverflow) && flowData.notifyOnQueueOverflow <= 0)\n\t\t{\n\t\t\tincorrectData.push('notifyOnQueueOverflow');\n\t\t}\n\n\t\tif (Type.isNumber(flowData.notifyOnTasksInProgressOverflow) && flowData.notifyOnTasksInProgressOverflow <= 0)\n\t\t{\n\t\t\tincorrectData.push('notifyOnTasksInProgressOverflow');\n\t\t}\n\n\t\tif (\n\t\t\tType.isNumber(flowData.notifyWhenEfficiencyDecreases)\n\t\t\t&& (\n\t\t\t\tflowData.notifyWhenEfficiencyDecreases <= 0\n\t\t\t\t|| flowData.notifyWhenEfficiencyDecreases > 100\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tincorrectData.push('notifyWhenEfficiencyDecreases');\n\t\t}\n\n\t\treturn incorrectData;\n\t}\n\n\t#getFlow(flowData: Flow = {}): Flow\n\t{\n\t\treturn {\n\t\t\tid: this.#params.flowId,\n\t\t\tdemo: ('demo' in flowData) ? flowData.demo === true : this.#flow?.demo === true,\n\t\t\t...this.#pages.reduce((fields, page) => ({ ...fields, ...page.getFields(flowData) }), {}),\n\t\t};\n\t}\n\n\t#onContinueHandler(): Promise<boolean>\n\t{\n\t\tif (this.#pageChanging === true)\n\t\t{\n\t\t\treturn Promise.resolve(false);\n\t\t}\n\n\t\tthis.#pageChanging = true;\n\n\t\tconst stepId = this.#wizard.getCurrentStep().id;\n\t\tconst currentPage = this.#pages.find((page) => page.getId() === stepId);\n\n\t\treturn currentPage?.onContinueClick(this.#flow)\n\t\t\t.then((canContinue: Boolean) => {\n\t\t\t\tthis.#pageChanging = false;\n\n\t\t\t\treturn canContinue;\n\t\t\t})\n\t\t;\n\t}\n}\n"],"names":["FormPage","getId","getTitle","setFlow","flow","render","getFields","flowData","getRequiredData","update","cleanErrors","showErrors","incorrectData","onContinueClick","Promise","resolve","ValueChecker","constructor","params","entitySelector","value","getPreselectedItems","isChecked","checker","getValue","entitySelectorValue","id","checkerValue","placeholder","setErrors","errors","cleanError","getInputNode","wrap","Tag","observer","IntersectionObserver","offsetWidth","disconnect","observe","Checker","checked","title","hideSeparator","size","subscribe","baseEvent","getData","length","focus","setSelectionRange","disabledValue","unit","Event","bind","Loc","getMessage","setTargetNode","show","hide","closest","dispatchEvent","window","Dom","addClass","removeClass","innerText","text","style","width","checkerField","querySelector","height","offsetHeight","getSelectedItems","BindFilterNumberInput","input","dispatchedProgrammatically","addEventListener","textBeforeCursor","selectionStart","slice","normalizedValue","replace","parseInt","Math","max","min","firstPart","lastCharacter","matches","match","formattedPosition","indexOf","bindFilterNumberInput","Hint","bindTo","bindElement","timer","hintNodePopup","handleScroll","setTimeout","Popup","getBindRect","angle","offset","darkMode","content","animation","cacheable","setBindElement","adjustPosition","document","clearTimeout","unbind","close","rect","getBoundingClientRect","DOMRect","x","scrollX","y","scrollY","AboutPage","includes","flowName","plannedCompletionTime","taskCreatorsSelector","plannedCompletionTimeValue","intervalDuration","plannedCompletionTimeIntervalSelector","getDuration","name","trim","description","flowDescription","taskCreators","matchWorkTime","skipWeekends","TextInput","label","TextArea","resizeOnlyY","UserSelector","enableDepartments","values","aboutPageForm","BX","UI","init","onChangeHandler","focusToEmptyName","isEmpty","data","response","ajax","runAction","exists","getSelector","getTags","map","tag","entityId","Type","isUndefined","getDialog","IntervalSelector","duration","plannedCompletionTimeLabel","inputDefaultWidth","String","maxInt","monthDuration","floor","root","plannedCompletionTimeHint","hint","PullRequests","EventEmitter","userId","setEventNamespace","getModuleId","getMap","template_add","emit","template","TEMPLATE_ID","TEMPLATE_TITLE","SettingsPage","requiredData","distributionType","taskTemplate","push","queueDistribution","manuallyDistribution","himselfDistribution","queueRadio","manuallyRadio","responsiblesSelector","moderatorSelector","projectSelector","responsibleQueue","isLoaded","manualDistributorId","groupId","FormData","settingsPageForm","get","responsibleCanChangeDeadline","notifyAtHalfTime","taskControl","templateId","notifyAtHalfTimeTitle","enableUsers","multiple","entities","options","features","tasks","notifyAtHalfTimeHint","settings","Extension","getSettings","currentUser","pullRequests","Pull","templateItem","tabs","taskTemplateDialog","addItem","getItems","find","item","select","enableAll","responsibleId","radio","type","selector","himselfRadio","toUpperCase","Dialog","context","preselectedItems","enableSearch","ControlPage","filter","flowOwnerSelector","forEach","ownerId","notifyOnQueueOverflow","notifyOnTasksInProgressOverflow","notifyWhenEfficiencyDecreases","flowOwnerLabel","analyticsPermissionsSelector","className","controlPageForm","flowOwnerHint","test","SLIDER_WIDTH","HELPDESK_ARTICLE","EditForm","initFlowData","createInstance","instance","openInSlider","top","SidePanel","Instance","open","contentCallback","slider","noAccess","flowId","demoFlow","guideFlow","html","error","page","events","onLoad","aboutPage","onClose","subTitle","Wizard","steps","isFilled","onCancel","destroy","onDisabledContinueButtonClick","onContinueHandler","finishButton","saveChangesButton","article","isEdit","demo","Button","color","Color","PRIMARY","round","Size","LARGE","onclick","SUCCESS","isDisabled","setState","ButtonState","DISABLED","Object","fromEntries","entries","key","isBoolean","action","textNotification","then","status","trialFeatureEnabled","Notification","Center","notify","alert","e","message","join","popup","overlay","padding","closeIcon","onFirstShow","getTarget","Lottie","loadAnimation","container","renderer","loop","animationData","flowfLottieIconInfo","popupContainer","getContentContainer","isDomNode","btnNode","fields","field","isArrayFilled","isStringFilled","isNumber","reduce","stepId","getCurrentStep","currentPage","canContinue"],"mappings":"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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}