{"version":3,"file":"company-selector.bundle.js","sources":["../src/index.js"],"sourcesContent":["import { Dom, Loc, Tag, Text as TextFormat, Type, Uri, Event } from 'main.core';\nimport { DateTimeFormat } from 'main.date';\nimport { Loader } from 'main.loader';\nimport { Menu } from 'main.popup';\nimport { Api } from 'sign.v2.api';\nimport { CompanyEditor, CompanyEditorMode, DocumentEntityTypeId, EditorTypeGuid } from 'sign.v2.company-editor';\nimport { Helpdesk, Link } from 'sign.v2.helper';\nimport { Dialog } from 'ui.entity-selector';\nimport { Guide } from 'sign.tour';\nimport { Label, LabelColor } from 'ui.label';\nimport { Alert, AlertColor } from 'ui.alerts';\n\nimport './style.css';\n\ntype CompanyInfo = {\n\tid: ?Number,\n\ttitle: ?String,\n\trqInn: ?Number,\n\tregisterUrl: ?String,\n\tproviders: ?Array<Provider>,\n};\n\nexport type ProviderCodeType = 'goskey' | 'ses-com' | 'ses-ru' | 'taxcom';\nexport const ProviderCode: $ReadOnly<{ [key: string]: ProviderCodeType }> = Object.freeze({\n\tgoskey: 'goskey',\n\tsesCom: 'ses-com',\n\tsesRu: 'ses-ru',\n\ttaxcom: 'taxcom',\n});\n\nexport type Provider = {\n\tcode: ProviderCodeType,\n\tuid: ?string,\n\ttimestamp: ?number,\n\tvirtual: boolean,\n\tautoRegister: boolean,\n\texpires: ?number,\n};\n\ntype CompanyData = {\n\tid: ?number,\n\tprovider: ?Provider\n};\n\nexport type CompanySelectorOptions = {\n\tcompanyId: ?number,\n\tentityId: number;\n\tregion: string;\n};\n\nconst allowedSignatureProviders: Array<ProviderCodeType> = ['goskey', 'taxcom', 'ses-ru', 'ses-com'];\nconst sesComLearnMoreLink = new Uri('https://www.bitrix24.com/terms/esignature-for-hr-rules.php');\n\nexport const HelpdeskCodes: $ReadOnly<{ [key: string]: string }> = Object.freeze({\n\tHowToChooseProvider: '19740650',\n\tGoskeyDetails: '19740688',\n\tSesRuDetails: '19740668',\n\tSesComDetails: '19740668',\n\tTaxcomDetails: '19740696',\n\tGoskeyApiKey: '19740816',\n});\n\nexport class CompanySelector\n{\n\t#api: Api;\n\t#companyList: Array<CompanyInfo> = [];\n\n\t#reloadDelayForHide: Number = 1000;\n\n\t#company: CompanyData = {\n\t\tid: null,\n\t\tprovider: {\n\t\t\tcode: null,\n\t\t\tuid: null,\n\t\t\ttimestamp: null,\n\t\t},\n\t};\n\n\t#loader: Loader = null;\n\t#providerMenu: Dialog = null;\n\t#dialog: Dialog = null;\n\t#showTaxId: boolean = true;\n\n\t#ui = {\n\t\tcontainer: HTMLDivElement = null,\n\t\tinfo: {\n\t\t\tcontainer: HTMLDivElement = null,\n\t\t\ttitle: {\n\t\t\t\tcontainer: HTMLDivElement = null,\n\t\t\t\theader: {\n\t\t\t\t\tcontainer: HTMLDivElement = null,\n\t\t\t\t\tname: HTMLDivElement = null,\n\t\t\t\t\tdropdownButton: HTMLDivElement = null,\n\t\t\t\t},\n\t\t\t\trqInn: HTMLDivElement = null,\n\t\t\t},\n\t\t\teditButton: HTMLDivElement = null,\n\t\t\tsetRqInnButton: HTMLButtonElement = null,\n\t\t},\n\t\tselect: {\n\t\t\tcontainer: HTMLDivElement = null,\n\t\t\ttext: HTMLSpanElement = null,\n\t\t\tbutton: HTMLButtonElement = null,\n\t\t},\n\t\tprovider: {\n\t\t\tcontainer: HTMLDivElement = null,\n\t\t\tinfo: HTMLParagraphElement = null,\n\t\t\tconnected: {\n\t\t\t\tcontainer: HTMLDivElement = null,\n\t\t\t\tnameContainer: HTMLElement,\n\t\t\t\tnameLabelContainer: HTMLElement,\n\t\t\t\tname: HTMLSpanElement,\n\t\t\t\tdescription: HTMLSpanElement,\n\t\t\t\tselectDropdownButton: HTMLSpanElement,\n\t\t\t\tconnectDropdownButton: HTMLSpanElement,\n\t\t\t},\n\t\t\tdisconnected: {\n\t\t\t\tcontainer: HTMLDivElement = null,\n\t\t\t\temptyProvider: HTMLSpanElement = null,\n\t\t\t\tbutton: HTMLButtonElement = null,\n\t\t\t},\n\t\t\tunset: {\n\t\t\t\tcontainer: HTMLDivElement = null,\n\t\t\t\ttext: HTMLSpanElement = null,\n\t\t\t\tbutton: HTMLButtonElement = null,\n\t\t\t},\n\t\t},\n\t};\n\n\t#isSubscribedIframeCloseEvent = false;\n\t#isSubscribedIframeConnectedEvent = false;\n\t#registerIframe: HTMLElement | null;\n\t#iframeConnectInterval = null;\n\t#options: CompanySelectorOptions;\n\t#loadPromise: Promise<void>;\n\t#providerExpiresDaysToShowInfo: Number = 45;\n\n\tconstructor(options: CompanySelectorOptions)\n\t{\n\t\tthis.#api = new Api();\n\t\tthis.#options = options;\n\t\tthis.#ui.provider.container = this.getProviderLayout();\n\t\tthis.#ui.container = this.getLayout();\n\t\tthis.#setEmptyState();\n\t\tthis.#bindEvents();\n\t\tthis.#loadPromise = this.#load();\n\t}\n\n\t#showLoader(): void\n\t{\n\t\tBX.hide(this.#ui.info.container);\n\t\tBX.hide(this.#ui.select.container);\n\t\tthis.#getLoader().show(this.#ui.container);\n\t}\n\n\t#hideLoader(): void\n\t{\n\t\tthis.#setEmptyState();\n\t\tthis.#getLoader().hide();\n\t}\n\n\tasync load(companyUid: string): Promise<void>\n\t{\n\t\tawait this.#loadPromise;\n\t\tconst company = this.#companyList.find((company) => {\n\t\t\treturn company.providers.some((provider) => {\n\t\t\t\treturn provider.uid === companyUid;\n\t\t\t});\n\t\t});\n\t\tthis.#company.id = company.id;\n\t\tthis.#updateDialogItems();\n\t\tthis.#selectProvider(companyUid);\n\t}\n\n\tsetOptions(options: CompanySelectorOptions): void\n\t{\n\t\tthis.#options = { ...this.#options, ...options };\n\t}\n\n\tgetProviderLayout(): HTMLElement\n\t{\n\t\tif (this.#ui.provider.container)\n\t\t{\n\t\t\treturn this.#ui.provider.container;\n\t\t}\n\n\t\tthis.#ui.provider.disconnected.emptyProvider = Tag.render`\n\t\t\t<span class=\"sign-document-b2e-company-select-text\">\n\t\t\t\t${Loc.getMessage('SIGN_B2E_COMPANY_NOT_CONNECTED_PROVIDER_STATUS')}\n\t\t\t</span>\n\t\t`;\n\t\tthis.#ui.provider.disconnected.button = Tag.render`\n\t\t\t<button\n\t\t\t\tclass=\"ui-btn ui-btn-success ui-btn-xs ui-btn-round\"\n\t\t\t\tonclick=\"${() => this.#openProvidersConnectionSlider()}\"\n\t\t\t>\n\t\t\t\t${Loc.getMessage('SIGN_B2E_PROVIDER_CONNECT')}\n\t\t\t</button>\n\t\t`;\n\t\tthis.#ui.provider.disconnected.container = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-company-select --provider\">\n\t\t\t\t${this.#ui.provider.disconnected.emptyProvider}\n\t\t\t\t${this.#ui.provider.disconnected.button}\n\t\t\t</div>\n\t\t`;\n\t\tthis.#ui.provider.connected.name = Tag.render`\n\t\t\t<span class=\"sign-document-b2e-company__provider_name\"></span>\n\t\t`;\n\t\tthis.#ui.provider.connected.nameLabelContainer = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-company__provider_name_label\"></div>\n\t\t`;\n\t\tthis.#ui.provider.connected.nameContainer = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-company__provider_name_container\">\n\t\t\t\t${this.#ui.provider.connected.name}\n\t\t\t\t${this.#ui.provider.connected.nameLabelContainer}\n\t\t\t</div>\n\t\t`;\n\t\tthis.#ui.provider.connected.description = Tag.render`\n\t\t\t<span class=\"sign-document-b2e-company__provider_descr\"></span>\n\t\t`;\n\t\tthis.#ui.provider.connected.selectDropdownButton = Tag.render`\n\t\t\t<span\n\t\t\t\tclass=\"sign-document-b2e-company-info-dropdown-btn sign-document-b2e-company__provider_dropdown-btn\"\n\t\t\t\tonclick=\"${() => this.#providerMenu.show()}\"\n\t\t\t></span>\n\t\t`;\n\t\tthis.#ui.provider.connected.connectDropdownButton = Tag.render`\n\t\t\t<span\n\t\t\t\tclass=\"sign-document-b2e-company-info-edit\"\n\t\t\t\tonclick=\"${() => this.#showConnectMenu()}\"\n\t\t\t></span>\n\t\t`;\n\t\tthis.#ui.provider.connected.container = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-company__provider_selected\">\n\t\t\t\t<div>\n\t\t\t\t\t${this.#ui.provider.connected.nameContainer}\n\t\t\t\t\t${this.#ui.provider.connected.description}\n\t\t\t\t</div>\n\t\t\t\t${this.#ui.provider.connected.selectDropdownButton}\n\t\t\t\t${this.#ui.provider.connected.connectDropdownButton}\n\t\t\t</div>\n\t\t`;\n\t\tthis.#ui.provider.info = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-company__provider_info\"></div>\n\t\t`;\n\t\tthis.#ui.provider.unset.text = Tag.render`\n\t\t\t<span class=\"sign-document-b2e-company-select-text\">\n\t\t\t\t${Loc.getMessage('SIGN_B2E_COMPANY_NOT_SET_PROVIDER_STATUS')}\n\t\t\t</span>\n\t\t`;\n\t\tthis.#ui.provider.unset.button = Tag.render`\n\t\t\t<button\n\t\t\t\tclass=\"ui-btn ui-btn-success ui-btn-xs ui-btn-round\"\n\t\t\t\tonclick=\"${() => this.#providerMenu.show()}\"\n\t\t\t>\n\t\t\t\t${Loc.getMessage('SIGN_B2E_COMPANIES_SELECT_BUTTON')}\n\t\t\t</button>\n\t\t`;\n\t\tthis.#ui.provider.unset.container = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-company-select --provider\">\n\t\t\t\t${this.#ui.provider.unset.text}\n\t\t\t\t${this.#ui.provider.unset.button}\n\t\t\t</div>\n\t\t`;\n\t\tthis.#ui.provider.container = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-company__provider\">\n\t\t\t\t<div class=\"sign-document-b2e-company__provider_content\">\n\t\t\t\t\t${this.#ui.provider.connected.container}\n\t\t\t\t\t${this.#ui.provider.disconnected.container}\n\t\t\t\t\t${this.#ui.provider.unset.container}\n\t\t\t\t</div>\n\t\t\t\t${this.#ui.provider.info}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#ui.provider.container;\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\tif (this.#ui.container)\n\t\t{\n\t\t\treturn this.#ui.container;\n\t\t}\n\n\t\tthis.#ui.info.title.header.dropdownButton = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-company-info-dropdown-btn\"></div>\n\t\t`;\n\t\tthis.#ui.info.title.header.name = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-company-info-name\"></div>\n\t\t`;\n\n\t\tthis.#ui.info.editButton = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-company-info-edit\"></div>\n\t\t`;\n\t\tthis.#ui.info.setRqInnButton = Tag.render`\n\t\t\t<button class=\"ui-btn ui-btn-xs ui-btn-round ui-btn-success\">\n\t\t\t\t${Loc.getMessage('SIGN_B2E_COMPANIES_CHANGE_INN')}\n\t\t\t</button>\n\t\t`;\n\n\t\tthis.#ui.info.title.header.container = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-company-info-header\">\n\t\t\t\t${this.#ui.info.title.header.name}\n\t\t\t\t${this.#ui.info.title.header.dropdownButton}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#ui.info.title.rqInn = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-company-info-rq-inn\"></div>\n\t\t`;\n\t\tif (!this.#showTaxId)\n\t\t{\n\t\t\tthis.#ui.info.title.rqInn.style.display = 'none';\n\t\t}\n\t\tthis.#ui.info.title.container = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-company-info-title\">\n\t\t\t\t${this.#ui.info.title.header.container}\n\t\t\t\t${this.#ui.info.title.rqInn}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#ui.info.container = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-company-info\">\n\t\t\t\t<div class=\"sign-document-b2e-company-info-img\"></div>\n\t\t\t\t${this.#ui.info.title.container}\n\t\t\t\t${this.#ui.info.editButton}\n\t\t\t\t${this.#ui.info.setRqInnButton}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#ui.select.text = Tag.render`\n\t\t\t<span class=\"sign-document-b2e-company-select-text\">\n\t\t\t\t${Loc.getMessage('SIGN_B2E_COMPANIES_NOT_CHANGED')}\n\t\t\t</span>\n\t\t`;\n\t\tthis.#ui.select.button = Tag.render`\n\t\t\t<button class=\"ui-btn ui-btn-success ui-btn-xs ui-btn-round\">\n\t\t\t\t${Loc.getMessage('SIGN_B2E_COMPANIES_SELECT_BUTTON')}\n\t\t\t</button>\n\t\t`;\n\t\tthis.#ui.select.container = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-company-select\">\n\t\t\t\t${this.#ui.select.text}\n\t\t\t\t${this.#ui.select.button}\n\t\t\t</div>\n\t\t`;\n\t\tthis.#ui.container = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-company\">\n\t\t\t\t${this.#ui.select.container}\n\t\t\t\t${this.#ui.info.container}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#ui.container;\n\t}\n\n\t#tryStartProviderTour(): void\n\t{\n\t\tconst guide = new Guide({\n\t\t\tid: 'sign-b2e-provider-tour',\n\t\t\tonEvents: true,\n\t\t\tautoSave: true,\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: this.#ui.provider.connected.selectDropdownButton,\n\t\t\t\t\ttitle: `\n\t\t\t\t\t\t<p class=\"sign-document-b2e-company__provider_tour-step-head\">\n\t\t\t\t\t\t\t${Loc.getMessage('SIGN_B2E_TOUR_HEAD')}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t`,\n\t\t\t\t\ttext: `\n\t\t\t\t\t\t<p class=\"sign-document-b2e-company__provider_tour-step-text\">\n\t\t\t\t\t\t\t${Loc.getMessage('SIGN_B2E_TOUR_TEXT')}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<span class=\"sign-document-b2e-company__provider_tour-step-icon\"></span>\n\t\t\t\t\t`,\n\t\t\t\t\tcondition: {\n\t\t\t\t\t\ttop: true,\n\t\t\t\t\t\tbottom: false,\n\t\t\t\t\t\tcolor: 'primary',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\tpopupOptions: {\n\t\t\t\twidth: 380,\n\t\t\t\tautoHide: true,\n\t\t\t\tclassName: 'sign-document-b2e-company__provider_popup-tour',\n\t\t\t\tcenterAngle: true,\n\t\t\t},\n\t\t});\n\t\tguide.startOnce();\n\t}\n\n\t#showConnectMenu()\n\t{\n\t\tconst menu = new Menu({\n\t\t\tbindElement: this.#ui.provider.connected.connectDropdownButton,\n\t\t\tcacheable: false,\n\t\t});\n\t\tmenu.addMenuItem({\n\t\t\ttext: Loc.getMessage('SIGN_B2E_PROVIDER_DISCONNECT'),\n\t\t\tonclick: () => {\n\t\t\t\tthis.#disconnectCurrentProvider();\n\t\t\t\tmenu.close();\n\t\t\t},\n\t\t});\n\t\tmenu.show();\n\t}\n\n\t#setEmptyState(): void\n\t{\n\t\tBX.hide(this.#ui.info.container);\n\t\tBX.hide(this.#ui.provider.container);\n\t\tthis.#ui.select.container.style.display = 'flex';\n\t}\n\n\t#setInfoState(): void\n\t{\n\t\tthis.#ui.info.container.style.display = 'flex';\n\t\tBX.hide(this.#ui.select.container);\n\t}\n\n\t#load(): Promise<void>\n\t{\n\t\tthis.#showLoader();\n\n\t\treturn this.#api.loadB2eCompanyList()\n\t\t\t.then((data) => {\n\t\t\t\tthis.#hideLoader();\n\t\t\t\tif (Type.isObject(data.companies) && Type.isArray(data.companies))\n\t\t\t\t{\n\t\t\t\t\tthis.#companyList = data.companies;\n\t\t\t\t\tthis.#showTaxId = Boolean(data?.showTaxId);\n\t\t\t\t\tthis.#updateDialogItems();\n\t\t\t\t}\n\t\t\t}).catch((response) => {\n\t\t\t\tthis.#hideLoader();\n\t\t\t\tconsole.log(response);\n\t\t\t});\n\t}\n\n\t#getLoader(): Loader\n\t{\n\t\tif (this.#loader)\n\t\t{\n\t\t\treturn this.#loader;\n\t\t}\n\n\t\tthis.#loader = new BX.Loader({\n\t\t\ttarget: this.#ui.container,\n\t\t\tmode: 'inline',\n\t\t\tsize: 40,\n\t\t});\n\n\t\treturn this.#loader;\n\t}\n\n\t#getDialog(): Dialog\n\t{\n\t\tif (this.#dialog)\n\t\t{\n\t\t\treturn this.#dialog;\n\t\t}\n\n\t\tthis.#dialog = new Dialog({\n\t\t\twidth: 425,\n\t\t\theight: 363,\n\t\t\titems: this.#companyList.map((company) => {\n\t\t\t\treturn {\n\t\t\t\t\tid: company.id,\n\t\t\t\t\tentityId: 'b2e-company',\n\t\t\t\t\ttitle: company.title,\n\t\t\t\t\ttabs: 'b2e-companies',\n\t\t\t\t};\n\t\t\t}),\n\t\t\ttabs: [\n\t\t\t\t{ id: 'b2e-companies', title: Loc.getMessage('SIGN_B2E_COMPANIES_TAB') },\n\t\t\t],\n\t\t\tshowAvatars: false,\n\t\t\tdropdownMode: true,\n\t\t\tmultiple: false,\n\t\t\tenableSearch: true,\n\t\t\tevents: {\n\t\t\t\t'Item:OnSelect': (event) => {\n\t\t\t\t\tthis.#onCompanySelectedHandler(event);\n\t\t\t\t\tthis.#dialog.hide();\n\t\t\t\t},\n\t\t\t\t'Item:OnDeselect': (event) => {\n\t\t\t\t\tthis.#onCompanyDeselectedHandler(event);\n\t\t\t\t\tthis.#dialog.hide();\n\t\t\t\t},\n\t\t\t},\n\t\t\tfooter: Tag.render`\n\t\t\t\t<span\n\t\t\t\t\tclass=\"ui-selector-footer-link ui-selector-footer-link-add\"\n\t\t\t\t\tonclick=\"${() => this.#createCompany()}\"\n\t\t\t\t>\n\t\t\t\t\t${Loc.getMessage('SIGN_B2E_ADD_COMPANY')}\n\t\t\t\t</span>\n\t\t\t`,\n\t\t});\n\n\t\treturn this.#dialog;\n\t}\n\n\t#getProviderMenu(): Dialog\n\t{\n\t\tif (this.#providerMenu)\n\t\t{\n\t\t\treturn this.#providerMenu;\n\t\t}\n\n\t\tthis.#providerMenu = new Dialog({\n\t\t\twidth: 425,\n\t\t\theight: 363,\n\t\t\ttargetNode: this.#ui.provider.container.firstElementChild,\n\t\t\titems: [],\n\t\t\tshowAvatars: true,\n\t\t\tdropdownMode: true,\n\t\t\tmultiple: false,\n\t\t\tautoHide: true,\n\t\t\ttabs: [\n\t\t\t\t{ id: 'b2e-providers', title: Loc.getMessage('SIGN_B2E_PROVIDERS_TAB') },\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\t'Item:OnSelect': ({ data }) => {\n\t\t\t\t\tthis.#onProviderSelect(data.item.id);\n\t\t\t\t},\n\t\t\t\t'Item:OnDeselect': () => this.#onProviderDeselect(),\n\t\t\t},\n\t\t\tfooter: this.#getProviderAddButton(),\n\t\t});\n\n\t\treturn this.#providerMenu;\n\t}\n\n\t#getProviderAddButton(): ?HTMLElement\n\t{\n\t\tconst company = this.#getCompanyById(this.#company?.id);\n\t\tif (company?.registerUrl)\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<span\n\t\t\t\t\tclass=\"ui-selector-footer-link ui-selector-footer-link-add\"\n\t\t\t\t\tonclick=\"${() => {\n\t\t\t\t\t\tthis.#providerMenu.hide();\n\t\t\t\t\t\tthis.#openProvidersConnectionSlider();\n\t\t\t\t\t}}\"\n\t\t\t\t>\n\t\t\t\t\t${Loc.getMessage('SIGN_B2E_PROVIDER_CONNECT_SELECTOR')}\n\t\t\t\t</span>\n\t\t\t`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#selectProvider(id: string): void\n\t{\n\t\tconst providerMenu = this.#getProviderMenu();\n\t\tconst providers = providerMenu.getItems();\n\t\tconst currentProvider = providers.find((provider) => provider.id === id);\n\t\tcurrentProvider.select();\n\t}\n\n\t#onProviderDeselect()\n\t{\n\t\tthis.#ui.provider.unset.container.style.display = 'flex';\n\t\tBX.hide(this.#ui.provider.connected.container);\n\t\tthis.#renderProviderInfo();\n\t\tthis.#providerMenu.hide();\n\t\tthis.#company.provider = null;\n\t}\n\n\t#onProviderSelect(id: string)\n\t{\n\t\tconst company = this.#getCompanyById(this.#company.id ?? 0);\n\t\tconst provider = company.providers.find((provider) => provider.uid === id);\n\t\tBX.hide(this.#ui.provider.unset.container);\n\t\tBX.show(this.#ui.provider.connected.container);\n\t\tBX.show(this.#ui.provider.info);\n\t\tthis.#chooseProvider(provider, company.rqInn);\n\t\tthis.#providerMenu.hide();\n\t}\n\n\t#resetProviderClasses()\n\t{\n\t\tconst providerClasses = allowedSignatureProviders.map((provider) => `--${provider}`);\n\t\tproviderClasses.push('--expired');\n\t\tDom.removeClass(this.#ui.provider.connected.container, providerClasses);\n\t}\n\n\t#resetProvider()\n\t{\n\t\tthis.#providerMenu = null;\n\t\tthis.#resetProviderClasses();\n\t}\n\n\t#updateProviderMenu(): void\n\t{\n\t\tthis.#resetProvider();\n\t\tconst menu = this.#getProviderMenu();\n\t\tconst company = this.#getCompanyById(this.#company.id);\n\t\tcompany.providers.forEach((provider) => {\n\t\t\tconst { providerName, description } = this.#getConnectedName(provider, company.rqInn);\n\n\t\t\tmenu.addItem({\n\t\t\t\tid: provider.uid,\n\t\t\t\ttitle: providerName,\n\t\t\t\tsubtitle: description,\n\t\t\t\tavatar: this.#getEntityAvatar(provider),\n\t\t\t\tentityId: 'b2e-provider',\n\t\t\t\ttabs: 'b2e-providers',\n\t\t\t\tbadges: this.#getEntityBadges(provider),\n\t\t\t});\n\t\t});\n\t\tconst [firstItem] = menu.getItems();\n\t\tfirstItem.select();\n\t\tconst nothingToSelect = !company?.registerUrl && company?.providers?.length < 2;\n\t\tthis.#ui.provider.connected.selectDropdownButton.style.display = nothingToSelect ? 'none' : 'block';\n\t}\n\n\t#renderProviderInfo(provider: ?Provider = null): void\n\t{\n\t\tconst code = provider?.code ?? '';\n\t\tDom.clean(this.#ui.provider.info);\n\t\tif (code === '')\n\t\t{\n\t\t\tconst firstParagraph = Tag.render`\n\t\t\t\t<p>\n\t\t\t\t\t${Loc.getMessage('SIGN_B2E_COMPANIES_UNSET_PROVIDER_PARAGRAPH_1')}\n\t\t\t\t</p>\n\t\t\t`;\n\t\t\tconst secondParagraph = Tag.render`\n\t\t\t\t<p>\n\t\t\t\t\t${Loc.getMessage('SIGN_B2E_COMPANIES_UNSET_PROVIDER_PARAGRAPH_2')}\n\t\t\t\t</p>\n\t\t\t`;\n\t\t\tconst thirdParagraph = Tag.render`\n\t\t\t\t<p>\n\t\t\t\t\t${Helpdesk.replaceLink(Loc.getMessage('SIGN_B2E_COMPANIES_UNSET_PROVIDER_MORE'), HelpdeskCodes.HowToChooseProvider)}\n\t\t\t\t</p>\n\t\t\t`;\n\t\t\tDom.append(firstParagraph, this.#ui.provider.info);\n\t\t\tDom.append(secondParagraph, this.#ui.provider.info);\n\t\t\tDom.append(thirdParagraph, this.#ui.provider.info);\n\t\t}\n\t\telse if (code === ProviderCode.sesCom)\n\t\t{\n\t\t\tlet providerInfo = Loc.getMessage('SIGN_B2E_COMPANY_SES_COM_INFO') ?? '';\n\t\t\tproviderInfo = Helpdesk.replaceLink(\n\t\t\t\tproviderInfo,\n\t\t\t\tHelpdeskCodes.SesComDetails,\n\t\t\t);\n\t\t\tproviderInfo = Link.replaceInLoc(\n\t\t\t\tproviderInfo,\n\t\t\t\tsesComLearnMoreLink,\n\t\t\t);\n\n\t\t\tconst text = Tag.render`<span>${providerInfo}</span>`;\n\t\t\t// Waiting for ready an article\n\t\t\ttext.firstElementChild.style.display = 'none';\n\t\t\tDom.append(text, this.#ui.provider.info);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst providerCodeToProviderInfoTextMap: { [key: ProviderCodeType]: ?string } = {\n\t\t\t\tgoskey: Loc.getMessage('SIGN_B2E_COMPANY_GOSKEY_INFO'),\n\t\t\t\t'ses-ru': Loc.getMessage('SIGN_B2E_COMPANY_SES_RU_INFO'),\n\t\t\t};\n\t\t\tconst providerCodeToHelpdeskCodeMap: { [key: ProviderCodeType]: string } = {\n\t\t\t\tgoskey: HelpdeskCodes.GoskeyDetails,\n\t\t\t\t'ses-ru': HelpdeskCodes.SesRuDetails,\n\t\t\t};\n\n\t\t\tconst text = Tag.render`<span>${Helpdesk.replaceLink(providerCodeToProviderInfoTextMap[code] ?? '', providerCodeToHelpdeskCodeMap[code] ?? '')}</span>`;\n\t\t\tDom.append(text, this.#ui.provider.info);\n\n\t\t\tif (this.#isProviderExpiresSoon(provider) || this.#isProviderExpired(provider))\n\t\t\t{\n\t\t\t\tDom.append(this.#getProviderAlert(provider).render(), this.#ui.provider.info);\n\t\t\t}\n\t\t}\n\t}\n\n\t#chooseProvider(provider: Provider, rqInn: number): void\n\t{\n\t\tif (!allowedSignatureProviders.includes(provider.code))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst { providerName, description } = this.#getConnectedName(provider, rqInn);\n\t\tthis.#ui.provider.connected.name.textContent = providerName;\n\t\tthis.#ui.provider.connected.description.textContent = description;\n\n\t\tthis.#renderProviderInfo(provider);\n\t\tthis.#resetProviderClasses();\n\t\tDom.addClass(this.#ui.provider.connected.container, `--with-icon --${provider.code}`);\n\t\tDom.clean(this.#ui.provider.connected.nameLabelContainer);\n\t\tif (this.#isProviderExpired(provider))\n\t\t{\n\t\t\tDom.addClass(this.#ui.provider.connected.container, '--expired');\n\t\t\tDom.append(this.#makeLabel().render(), this.#ui.provider.connected.nameLabelContainer);\n\t\t}\n\t\tthis.#ui.provider.connected.connectDropdownButton.style.display = provider.autoRegister ? 'none' : ' flex';\n\t\tthis.#company.provider = provider;\n\t}\n\n\tgetSelectedCompanyProvider(): Provider | null\n\t{\n\t\treturn this.#company.provider ?? null;\n\t}\n\n\t#onCompanySelectedHandler(event): void\n\t{\n\t\tif (!event.data || event.data.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst selectedItem = event.data.item;\n\t\tif (selectedItem?.id <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#selectCompany(selectedItem?.id);\n\t}\n\n\t#selectCompany(id: number): void\n\t{\n\t\tconst company = this.#getCompanyById(id);\n\t\tif (Type.isUndefined(company))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#company.id = company.id;\n\t\tthis.#company.provider = null;\n\t\tif (company?.providers?.length > 0)\n\t\t{\n\t\t\tconst filteredProviders = company.providers\n\t\t\t\t?.filter((provider) => allowedSignatureProviders.includes(provider.code))\n\t\t\t\t?? []\n\t\t\t;\n\t\t\tif (filteredProviders.length > 0)\n\t\t\t{\n\t\t\t\tthis.#company.provider = filteredProviders[0];\n\t\t\t}\n\t\t}\n\n\t\tthis.#refreshView();\n\t}\n\n\t#refreshView(): void\n\t{\n\t\tconst selectedItem = this.#getCompanyById(this.#company?.id);\n\t\tif (!selectedItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#ui.info.title.header.name.innerText = selectedItem.title;\n\t\tBX.show(this.#ui.info.editButton);\n\t\tBX.show(this.#ui.info.setRqInnButton);\n\t\tif (Type.isStringFilled(selectedItem.rqInn))\n\t\t{\n\t\t\tthis.#ui.info.title.rqInn.innerText = Loc.getMessage('SIGN_B2E_COMPANIES_INN', { '%innValue%': TextFormat.encode(selectedItem.rqInn) });\n\t\t\tthis.#ui.info.title.rqInn.style.display = this.#showTaxId ? '' : 'none';\n\n\t\t\tBX.hide(this.#ui.info.setRqInnButton);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#ui.info.title.rqInn.textContent = Loc.getMessage('SIGN_B2E_COMPANIES_NO_RQ_INN');\n\t\t\tBX.hide(this.#ui.info.editButton);\n\t\t}\n\n\t\tthis.#resetProviderState();\n\t\tthis.#toggleProviderState(selectedItem.rqInn);\n\t\tthis.#setInfoState();\n\t}\n\n\t#resetProviderState()\n\t{\n\t\tBX.show(this.#ui.provider.container);\n\t\tBX.show(this.#ui.provider.info);\n\t\tBX.show(this.#ui.provider.disconnected.button);\n\t\tthis.#ui.provider.connected.container.style.display = 'flex';\n\t\tthis.#ui.provider.disconnected.container.style.display = 'flex';\n\t}\n\n\t#toggleProviderState(rqInn: ?string)\n\t{\n\t\tconst company = this.#getCompanyById(this.#company.id ?? 0);\n\t\tif (company?.providers?.length > 0)\n\t\t{\n\t\t\tBX.hide(this.#ui.provider.disconnected.container);\n\t\t\tthis.#updateProviderMenu();\n\t\t\tif (this.#options.region === 'ru')\n\t\t\t{\n\t\t\t\tthis.#tryStartProviderTour();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tBX.hide(this.#ui.provider.connected.container);\n\t\tBX.hide(this.#ui.provider.unset.container);\n\t\tBX.hide(this.#ui.provider.info);\n\t\tif (!rqInn)\n\t\t{\n\t\t\tBX.hide(this.#ui.provider.disconnected.button);\n\t\t}\n\t}\n\n\t#updateDialogItems(): void\n\t{\n\t\tthis.#dialog = null;\n\t\tthis.#dialog = this.#getDialog();\n\t\tconst item = this.#dialog.getItems().find((item) => item.id === this.#company.id);\n\t\titem?.select();\n\t}\n\n\t#getCompanyById(id: number): CompanyInfo | undefined\n\t{\n\t\treturn this.#companyList.find((company) => id === company.id);\n\t}\n\n\t#getConnectedName(provider: Provider, rqInn: number): string\n\t{\n\t\tconst providerName = this.#getProviderNameByCode(provider.code);\n\t\tconst description = this.#getProviderConnectedDescription(provider, rqInn);\n\n\t\treturn { providerName, description };\n\t}\n\n\t#getProviderConnectedDescription(provider: Provider, rqInn: number): string\n\t{\n\t\tif (provider.autoRegister)\n\t\t{\n\t\t\treturn this.#showTaxId\n\t\t\t\t? Loc.getMessage('SIGN_B2E_SELECT_PROVIDER_WITHOUT_DATE', {\n\t\t\t\t\t'#RQINN#': rqInn,\n\t\t\t\t})\n\t\t\t\t: Loc.getMessage('SIGN_B2E_SELECT_PROVIDER_WITHOUT_INN_DATE')\n\t\t\t;\n\t\t}\n\n\t\tconst formattedDate = DateTimeFormat.format(\n\t\t\tDateTimeFormat.getFormat('FORMAT_DATE'),\n\t\t\tprovider.timestamp,\n\t\t);\n\n\t\treturn this.#showTaxId\n\t\t\t? Loc.getMessage('SIGN_B2E_SELECT_PROVIDER', {\n\t\t\t\t'#RQINN#': rqInn,\n\t\t\t\t'#DATE#': formattedDate,\n\t\t\t})\n\t\t\t: Loc.getMessage('SIGN_B2E_SELECT_PROVIDER_WITHOUT_INN', { '#DATE#': formattedDate })\n\t\t;\n\t}\n\n\t#getProviderNameByCode(code): string\n\t{\n\t\tswitch (code)\n\t\t{\n\t\t\tcase 'goskey':\n\t\t\t\treturn Loc.getMessage('SIGN_B2E_PROVIDER_GOSKEY_NAME');\n\t\t\tcase 'taxcom':\n\t\t\t\treturn Loc.getMessage('SIGN_B2E_PROVIDER_TAXCOM_NAME');\n\t\t\tcase 'ses-ru':\n\t\t\t\treturn Loc.getMessage('SIGN_B2E_PROVIDER_SES_NAME');\n\t\t\tcase 'ses-com':\n\t\t\t\treturn Loc.getMessage('SIGN_B2E_PROVIDER_SES_COM_NAME');\n\t\t\tdefault:\n\t\t\t\treturn '';\n\t\t}\n\t}\n\n\t#openProvidersConnectionSlider(): void\n\t{\n\t\tconst company = this.#getCompanyById(this.#company?.id);\n\t\tif (company && company.registerUrl)\n\t\t{\n\t\t\tconst url = new URL(company.registerUrl);\n\t\t\tconst allowedOrigin = url.origin;\n\t\t\tBX.SidePanel.Instance.open('sign:stub', {\n\t\t\t\twidth: 1100,\n\t\t\t\tcacheable: false,\n\t\t\t\tallowCrossDomain: true,\n\t\t\t\tallowChangeHistory: false,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\tconst frameStyles = 'position: absolute; left: 0; top: 0; padding: 0;'\n\t\t\t\t\t\t+ ' border: none; margin: 0; width: 100%; height: 100%;';\n\t\t\t\t\tthis.#registerIframe = Tag.render`<iframe src=\"${company.registerUrl}\" style=\"${frameStyles}\"></iframe>`;\n\n\t\t\t\t\treturn this.#registerIframe;\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: () => this.#load(),\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.#initIframeConnect(allowedOrigin);\n\t\t\tthis.#subscribeIframeConnectedEvent(allowedOrigin);\n\t\t\tthis.#subscribeIframeCloseEvent(allowedOrigin);\n\t\t}\n\t}\n\n\tasync #disconnectCurrentProvider(): Promise\n\t{\n\t\tif (!this.#company.provider)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst company = this.#getCompanyById(this.#company.id ?? 0);\n\t\tif (!company)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst id = this.#company.provider.uid;\n\t\tif (!id || this.#company.provider.autoRegister)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#showLoader();\n\n\t\ttry\n\t\t{\n\t\t\tawait this.#api.deleteB2eCompany(id);\n\t\t\tcompany.providers = company.providers.filter((provider: Provider) => provider.uid !== id);\n\t\t\tthis.#company.provider = null;\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tconsole.error(e);\n\t\t}\n\t\tthis.#hideLoader();\n\t\tthis.#selectCompany(company.id);\n\t}\n\n\t#bindEvents(): void\n\t{\n\t\tEvent.bind(this.#ui.select.button, 'click', () => {\n\t\t\tthis.#getDialog().setTargetNode(this.#ui.container);\n\t\t\tthis.#getDialog().show();\n\t\t});\n\t\tEvent.bind(this.#ui.info.title.header.dropdownButton, 'click', () => {\n\t\t\tthis.#getDialog().setTargetNode(this.#ui.container);\n\t\t\tthis.#getDialog().show();\n\t\t});\n\t\tEvent.bind(this.#ui.info.editButton, 'click', () => this.#showEditMenu());\n\t\tEvent.bind(this.#ui.info.setRqInnButton, 'click', () => this.#editCompany());\n\t}\n\n\t#onCompanyDeselectedHandler(event): void\n\t{\n\t\tthis.#company.id = null;\n\t\tthis.#company.provider = {\n\t\t\tkey: null,\n\t\t\tuid: null,\n\t\t};\n\n\t\tthis.#setEmptyState();\n\t}\n\n\t#initIframeConnect(allowedOrigin)\n\t{\n\t\tthis.#iframeConnectInterval = setInterval(() => {\n\t\t\tif (this.#registerIframe && this.#registerIframe.contentWindow)\n\t\t\t{\n\t\t\t\tthis.#registerIframe.contentWindow.postMessage('Event:b2e-crossorigin:initConnection', allowedOrigin);\n\t\t\t}\n\t\t}, 500);\n\t}\n\n\t#showEditMenu()\n\t{\n\t\tconst menu = new Menu({\n\t\t\tbindElement: this.#ui.info.editButton,\n\t\t\tcacheable: false,\n\t\t});\n\t\tmenu.addMenuItem({\n\t\t\ttext: Loc.getMessage('SIGN_B2E_COMPANIES_EDIT'),\n\t\t\tonclick: () => {\n\t\t\t\tthis.#editCompany();\n\t\t\t\tmenu.close();\n\t\t\t},\n\t\t});\n\t\tmenu.show();\n\t}\n\n\t#createCompany(): void\n\t{\n\t\tCompanyEditor.openSlider({\n\t\t\tmode: CompanyEditorMode.Create,\n\t\t\tdocumentEntityId: this.#options.entityId,\n\t\t\tlayoutTitle: Loc.getMessage('SIGN_B2E_COMPANY_CREATE'),\n\t\t\tentityTypeId: DocumentEntityTypeId.B2e,\n\t\t\tguid: EditorTypeGuid.B2e,\n\t\t\tevents: {\n\t\t\t\tonCompanySavedHandler: (companyId: number): void => {\n\t\t\t\t\tthis.#company.id = companyId;\n\t\t\t\t},\n\t\t\t},\n\t\t}, {\n\t\t\tonCloseHandler: () => {\n\t\t\t\tthis.#load();\n\t\t\t\tthis.#dialog.hide();\n\t\t\t},\n\t\t});\n\t}\n\n\t#editCompany(): void\n\t{\n\t\tif (!Type.isInteger(this.#company.id))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tCompanyEditor.openSlider({\n\t\t\tmode: CompanyEditorMode.Edit,\n\t\t\tdocumentEntityId: this.#options.entityId,\n\t\t\tcompanyId: this.#company.id,\n\t\t\tlayoutTitle: Loc.getMessage('SIGN_B2E_COMPANY_EDIT'),\n\t\t\tentityTypeId: DocumentEntityTypeId.B2e,\n\t\t\tguid: EditorTypeGuid.B2e,\n\t\t}, {\n\t\t\tonCloseHandler: () => this.#load(),\n\t\t});\n\t}\n\n\t#subscribeIframeConnectedEvent(allowedOrigin)\n\t{\n\t\tif (this.#isSubscribedIframeConnectedEvent)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\twindow.addEventListener('message', (event) => {\n\t\t\tif (event.origin === allowedOrigin && event.data === 'Event:b2e-crossorigin:connected')\n\t\t\t{\n\t\t\t\tclearInterval(this.#iframeConnectInterval);\n\t\t\t\tconst company = this.#getCompanyById(this.#company.id ?? 0);\n\t\t\t\tif (company)\n\t\t\t\t{\n\t\t\t\t\tthis.#registerIframe.contentWindow.postMessage({ companyName: company.title }, allowedOrigin);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.#isSubscribedIframeConnectedEvent = true;\n\t}\n\n\t#subscribeIframeCloseEvent(allowedOrigin)\n\t{\n\t\tif (this.#isSubscribedIframeCloseEvent)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\twindow.addEventListener('message', (event) => {\n\t\t\tif (event.origin === allowedOrigin && event.data === 'Event:b2e-crossorigin:close-iframe')\n\t\t\t{\n\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t}\n\t\t});\n\n\t\tthis.#isSubscribedIframeCloseEvent = true;\n\t}\n\n\tasync #registerVirtualProviderIfNeed(): Promise<void>\n\t{\n\t\tif (!this.#company.provider.virtual)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst selectedItem = this.#getCompanyById(this.#company.id);\n\t\tconst { id } = await this.#api.registerB2eCompany(this.#company.provider.code, selectedItem.rqInn);\n\t\tthis.#company.provider.uid = id;\n\t\tthis.#company.provider.virtual = false;\n\t\tsetTimeout(() => this.#load(), this.#reloadDelayForHide);\n\t}\n\n\tgetCompanyId(): ?number\n\t{\n\t\treturn this.#company?.id;\n\t}\n\n\tvalidate(): boolean\n\t{\n\t\tDom.removeClass(this.#ui.container, '--invalid');\n\t\tDom.removeClass(this.#ui.provider.container.firstElementChild, '--invalid');\n\t\tconst isCompanyValid = Type.isInteger(this.#company.id) && this.#company.id > 0;\n\t\tconst isProviderValid = Type.isObject(this.#company.provider)\n\t\t\t&& Type.isStringFilled(this.#company.provider.uid)\n\t\t\t&& !this.#isProviderExpired(this.#company.provider)\n\t\t;\n\t\tconst isValid = isCompanyValid && isProviderValid;\n\t\tif (isValid)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (isCompanyValid)\n\t\t{\n\t\t\tDom.addClass(this.#ui.provider.container.firstElementChild, '--invalid');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.#ui.container, '--invalid');\n\t\t}\n\n\t\treturn isValid;\n\t}\n\n\tasync save(documentId: string): Promise\n\t{\n\t\tawait this.#registerVirtualProviderIfNeed();\n\t\tconst provider = this.#company.provider;\n\n\t\treturn this.#api.modifyB2eCompany(documentId, provider.uid);\n\t}\n\n\t#isProviderExpiresSoon(provider: Provider): boolean\n\t{\n\t\tif (!provider.expires)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tconst daysLeft = this.#getProviderDaysLeft(provider.expires);\n\n\t\treturn daysLeft <= this.#providerExpiresDaysToShowInfo && daysLeft >= 1;\n\t}\n\n\t#isProviderExpired(provider: Provider): boolean\n\t{\n\t\treturn provider.expires && this.#getProviderDaysLeft(provider.expires) < 1;\n\t}\n\n\t#getProviderDaysLeft(expires: Number): Number\n\t{\n\t\tconst now = Date.now() / 1000;\n\n\t\treturn Math.floor((expires - now) / 86400);\n\t}\n\n\t#makeLabel(): Label\n\t{\n\t\treturn new Label({\n\t\t\ttext: Loc.getMessage('SIGN_B2E_GOSKEY_APIKEY_EXPIRED'),\n\t\t\tcolor: LabelColor.WARNING,\n\t\t\tfill: true,\n\t\t\tcustomClass: 'sign-document-b2e-company__provider_label',\n\t\t});\n\t}\n\n\t#getEntityAvatar(provider: Provider): string\n\t{\n\t\tif (provider.code === ProviderCode.goskey)\n\t\t{\n\t\t\treturn this.#isProviderExpired(provider)\n\t\t\t\t? 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIHZpZXdCb3g9IjAgMCAzNiAzNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjM2IiBoZWlnaHQ9IjM2IiByeD0iMTgiIGZpbGw9IiNCREMxQzYiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNi4zMzA1IDE0Ljg5OTlMMTkuNzU3MiAxMS40NzMxQzIwLjM4ODEgMTAuODQyMyAyMS40MTA5IDEwLjg0MjMgMjIuMDQxNyAxMS40NzMxTDI0LjcwNyAxNC4xMzg0QzI1LjMzNzggMTQuNzY5MiAyNS4zMzc4IDE1Ljc5MiAyNC43MDcgMTYuNDIyOUwyMS4yODAyIDE5Ljg0OTZDMjAuODU5NyAyMC4yNzAyIDIwLjE3OTEgMjAuMjcxNSAxOS43NTg1IDE5Ljg1MDlMMTYuMzI5OCAxNi40MjIyQzE1LjkwOTMgMTYuMDAxNiAxNS45MDk5IDE1LjMyMDQgMTYuMzMwNSAxNC44OTk5Wk0yMS42NjEgMTUuNjYxNEMyMS4zNDU2IDE1Ljk3NjggMjAuODM0MiAxNS45NzY4IDIwLjUxODcgMTUuNjYxNEMyMC4yMDMzIDE1LjM0NiAyMC4yMDMzIDE0LjgzNDYgMjAuNTE4NyAxNC41MTkxQzIwLjgzNDIgMTQuMjAzNyAyMS4zNDU2IDE0LjIwMzcgMjEuNjYxIDE0LjUxOTFDMjEuOTc2NCAxNC44MzQ2IDIxLjk3NjQgMTUuMzQ2IDIxLjY2MSAxNS42NjE0WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTE3LjA5MiAxNy45NDU5TDE4LjQyNDYgMTkuMjc4NUMxOC42MzQ5IDE5LjQ4ODggMTguNjM0OSAxOS44Mjk3IDE4LjQyNDYgMjAuMDRMMTcuMDU5MyAyMS40MDUzQzE2Ljk1ODQgMjEuNTA2MyAxNi44MjE0IDIxLjU2MyAxNi42Nzg2IDIxLjU2M0gxNS4zNzg2VjIyLjg2M0MxNS4zNzg2IDIzLjAwNTggMTUuMzIxOSAyMy4xNDI3IDE1LjIyMDkgMjMuMjQzN0wxNS4xNTU2IDIzLjMwOUMxNS4wNTQ2IDIzLjQxIDE0LjkxNzYgMjMuNDY2OCAxNC43NzQ4IDIzLjQ2NjhIMTMuNDc0OVYyNC43NjY3QzEzLjQ3NDkgMjQuOTA5NSAxMy40MTgxIDI1LjA0NjUgMTMuMzE3MiAyNS4xNDc1TDEyLjg3MTEgMjUuNTkzNUMxMi43NzAxIDI1LjY5NDUgMTIuNjMzMSAyNS43NTEzIDEyLjQ5MDMgMjUuNzUxM0gxMS4zMjVDMTEuMjM4OCAyNS43NTEzIDExLjE1NjEgMjUuNzE3IDExLjA5NTIgMjUuNjU2MUMxMS4wMzQyIDI1LjU5NTEgMTEgMjUuNTEyNSAxMSAyNS40MjYzVjIzLjY1NzFMMTUuMTg4MiAxOS40Njg5QzE0Ljk3OCAxOS4yNTg2IDE0Ljk3OCAxOC45MTc3IDE1LjE4ODIgMTguNzA3NEwxNS45NDk3IDE3Ljk0NTlDMTYuMjY1MiAxNy42MzA1IDE2Ljc3NjYgMTcuNjMwNSAxNy4wOTIgMTcuOTQ1OVoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNS42MTUyNiAxNy4wNTY0VjE5LjMwMDJDNS42MTUyNiAyMC43MzA5IDUuNjE2ODIgMjEuNjk0NiA1LjY4NTA2IDIyLjQ1MjJDNS43NTAzMSAyMy4xNzY1IDUuODY4ODYgMjMuNTk0MiA2LjA0MzgxIDIzLjkzNDVDNi4yMTg3NyAyNC4yNzQ5IDYuNDg4MzggMjQuNjEyMyA3LjAzNjA3IDI1LjA4MDRDNy42MDg4NiAyNS41NyA4LjM4NjI5IDI2LjEyMTcgOS41NDE2OCAyNi45Mzg3TDExLjA0NTkgMjguMDAyNEwxMy41Nzc5IDI5LjQyMjRDMTQuODc2MiAzMC4xNTA1IDE1Ljc1MjYgMzAuNjQwMSAxNi40NzUgMzAuOTU4NUMxNy4xNjYgMzEuMjYzIDE3LjYwNCAzMS4zNTc5IDE3Ljk5OTkgMzEuMzU3OUMxOC4zOTU3IDMxLjM1NzkgMTguODMzNyAzMS4yNjMgMTkuNTI0NyAzMC45NTg1QzIwLjI0NzIgMzAuNjQwMSAyMS4xMjM1IDMwLjE1MDUgMjIuNDIxOSAyOS40MjI0TDI0Ljk1MzkgMjguMDAyNEwyNi40NTgxIDI2LjkzODdDMjcuNjEzNSAyNi4xMjE3IDI4LjM5MDkgMjUuNTcgMjguOTYzNyAyNS4wODA0QzI5LjUxMTQgMjQuNjEyMyAyOS43ODEgMjQuMjc0OSAyOS45NTU5IDIzLjkzNDVDMzAuMTMwOSAyMy41OTQyIDMwLjI0OTQgMjMuMTc2NSAzMC4zMTQ3IDIyLjQ1MjJDMzAuMzgyOSAyMS42OTQ2IDMwLjM4NDUgMjAuNzMwOSAzMC4zODQ1IDE5LjMwMDJWMTcuMDU2NEMzMC4zODQ1IDE1LjYyNTcgMzAuMzgyOSAxNC42NjE5IDMwLjMxNDcgMTMuOTA0NEMzMC4yNDk0IDEzLjE4IDMwLjEzMDkgMTIuNzYyMyAyOS45NTU5IDEyLjQyMkMyOS43ODEgMTIuMDgxNiAyOS41MTE0IDExLjc0NDIgMjguOTYzNyAxMS4yNzYxQzI4LjM5MDkgMTAuNzg2NSAyNy42MTM1IDEwLjIzNDkgMjYuNDU4MSA5LjQxNzgzTDI0LjkxOTggOC4zMzAwNEwyMi44MjczIDcuMDA5OEMyMS40MTc3IDYuMTIwNDIgMjAuNDYzNCA1LjUyMDc0IDE5LjY3MzQgNS4xMzA3QzE4LjkxNzMgNC43NTczMyAxOC40MzY4IDQuNjQyMDYgMTcuOTk5OSA0LjY0MjA2QzE3LjU2MyA0LjY0MjA2IDE3LjA4MjUgNC43NTczMyAxNi4zMjYzIDUuMTMwN0MxNS41MzYzIDUuNTIwNzQgMTQuNTgyMSA2LjEyMDQyIDEzLjE3MjUgNy4wMDk4TDExLjA4IDguMzMwMDNMOS41NDE2NyA5LjQxNzgzQzguMzg2MjkgMTAuMjM0OSA3LjYwODg2IDEwLjc4NjUgNy4wMzYwNyAxMS4yNzYxQzYuNDg4MzggMTEuNzQ0MiA2LjIxODc3IDEyLjA4MTYgNi4wNDM4MSAxMi40MjJDNS44Njg4NiAxMi43NjIzIDUuNzUwMzEgMTMuMTggNS42ODUwNiAxMy45MDQ0QzUuNjE2ODIgMTQuNjYxOSA1LjYxNTI2IDE1LjYyNTcgNS42MTUyNiAxNy4wNTY0Wk0xMC4xOTIyIDYuOTU3NTNMMTIuMzIwNiA1LjYxNDY0QzE1LjA4MzMgMy44NzE1NSAxNi40NjQ2IDMgMTcuOTk5OSAzQzE5LjUzNTEgMyAyMC45MTY1IDMuODcxNTUgMjMuNjc5MiA1LjYxNDY0TDI1LjgwNzYgNi45NTc1M0wyNy4zODA2IDguMDY5ODZDMjkuNjQzOCA5LjY3MDI5IDMwLjc3NTQgMTAuNDcwNSAzMS4zODc3IDExLjY2MTVDMzEuOTk5OSAxMi44NTI1IDMxLjk5OTkgMTQuMjUzOCAzMS45OTk5IDE3LjA1NjRWMTkuMzAwMkMzMS45OTk5IDIyLjEwMjcgMzEuOTk5OSAyMy41MDQgMzEuMzg3NyAyNC42OTVDMzAuNzc1NCAyNS44ODYgMjkuNjQzOCAyNi42ODYyIDI3LjM4MDYgMjguMjg2N0wyNS44MDc2IDI5LjM5OUwyMy4yMDIzIDMwLjg2MDFDMjAuNjU4NiAzMi4yODY3IDE5LjM4NjggMzMgMTcuOTk5OSAzM0MxNi42MTMgMzMgMTUuMzQxMiAzMi4yODY3IDEyLjc5NzUgMzAuODYwMUwxMC4xOTIyIDI5LjM5OUw4LjYxOTE3IDI4LjI4NjZDNi4zNTU5MyAyNi42ODYyIDUuMjI0MzEgMjUuODg2IDQuNjEyMDkgMjQuNjk1QzMuOTk5ODggMjMuNTA0IDMuOTk5ODggMjIuMTAyNyAzLjk5OTg4IDE5LjMwMDJWMTcuMDU2NEMzLjk5OTg4IDE0LjI1MzggMy45OTk4OCAxMi44NTI1IDQuNjEyMDkgMTEuNjYxNUM1LjIyNDMxIDEwLjQ3MDUgNi4zNTU5NCA5LjY3MDI5IDguNjE5MTggOC4wNjk4NkwxMC4xOTIyIDYuOTU3NTNaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K'\n\t\t\t\t: 'data:image/png;base64,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'\n\t\t\t;\n\t\t}\n\n\t\treturn 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAANQSURBVHgBxZi/b9NAFMffnZOaFgopEkggEK5AohKgJKgLIETzD6B2YmAo3boBAyv9sXaAbh2QCgMzVQbWpELQBYErFpCQcAUqPyogoqipm9jHe5fYikMs2/n5lZxcchffJ+/dvXfPDCJqZK2o9VnWOFOUJAgxhlcCGEvITiEK2DaAgyHK9iovlVb0zJAR4fbAwg688PLvLc6VSQkRTbot7MV3Vw48DjM4EOj8i+0xRVGWsalBazIQbC4IzBcolfudsFV1BgfcgTZKADzkpjmHrixAWCCE0YSqPqMmdEYGM81Mo/XFfGBy0LqLmoJidTAJhHnbBRhHehXKdR+v7aU100UYUqo6pyvXQnJbM74MPRCzrIx+dTBPbddCCDMDPZKohJUKB72QdaANrpo+GYfnF/fBcTV0vHWkVRkqQJyx29CiCGb6REzCPDqnRoaSWYDeaZujF1uKNw6MI4IZPcij3QRTUvqNOMXteHwcWlA9DGnpcwmyWxZElbVbnOAsxq9Bk/KDWfpShmbEGEtysIUGTajdMFLoNo7ZToOI6ghMRQnuHq56D1MFiqCbx2KdhJHi8tgZQrSVc78s+LAjOgaDKsTQZQQU6DayzughBe6+N+HBiAq5n+V2w5AMLkCshhlJMGcHGMyfjsON9V14/ceG+TN9nohMwdCJ1o6uH1HkFUbIshHDba9j7pgMGpz9XpLuIhCa0IHJDHFY2CjDIM55T4tXII7GYMEoyc8OXHarCMFieZbCskYI8QlCiqzgwNCayhz2/vvtsoDBGPN8Jtc+/RrsXgyMw/KXybViLkx5Q+6if79pCrj/cU9ai1xEoYAmJqvUujL7A0G+WbIvhPT1ywNpCZTC1C9CHs5oHW3ugWcSmnzbgrATNxQT9pSOJZJr2+SrHXKbBr2RgdYZpoYbGPEYOQU9Elpnzmm7QHSmFVjyQpeFMIt6TTXrSR18rzSL0UCH7smAgf2ztV94gKg+YoxPyIFdgMFtntHTrOALJKEu9cuBHYbSJQzOVd/RMNtLKNNMd2JN0Zph/f0NYWR/0A2qMaodFa1BO9kpCP0UulapgFG5FLlCyaNVnujtemD1HxjmPsBHeoJTcYDncToCex/p0ZVHa6yDoqz4ucZP/wB0m3kbYruWeAAAAABJRU5ErkJggg==';\n\t}\n\n\t#getEntityBadges(provider: Provider): Array<Object>\n\t{\n\t\tif (provider.code === ProviderCode.goskey && this.#isProviderExpired(provider))\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\ttitle: Loc.getMessage('SIGN_B2E_GOSKEY_APIKEY_EXPIRED'),\n\t\t\t\t\ttextColor: 'var(--ui-color-palette-white-base)',\n\t\t\t\t\tbgColor: 'var(--ui-color-palette-orange-60)',\n\t\t\t\t},\n\t\t\t];\n\t\t}\n\n\t\treturn [];\n\t}\n\n\t#getProviderAlert(provider: Provider): Alert\n\t{\n\t\treturn new Alert({\n\t\t\ttext: this.#getProviderAlertMessage(provider),\n\t\t\tcolor: AlertColor.WARNING,\n\t\t\tcustomClass: 'sign-document-b2e-company__provider_alert',\n\t\t});\n\t}\n\n\t#getProviderAlertMessage(provider: Provider): string\n\t{\n\t\tif (this.#isProviderExpired(provider))\n\t\t{\n\t\t\treturn Helpdesk.replaceLink(\n\t\t\t\tLoc.getMessage('SIGN_B2E_GOSKEY_APIKEY_EXPIRED_MORE'),\n\t\t\t\tHelpdeskCodes.GoskeyApiKey,\n\t\t\t);\n\t\t}\n\n\t\tconst daysLeft = this.#getProviderDaysLeft(provider.expires);\n\t\tconst alertText = Loc.getMessagePlural('SIGN_B2E_GOSKEY_APIKEY_EXPIRES', daysLeft, {\n\t\t\t'#DAYS#': daysLeft,\n\t\t});\n\n\t\treturn Helpdesk.replaceLink(alertText, HelpdeskCodes.GoskeyApiKey);\n\t}\n}\n"],"names":["ProviderCode","Object","freeze","goskey","sesCom","sesRu","taxcom","allowedSignatureProviders","sesComLearnMoreLink","Uri","HelpdeskCodes","HowToChooseProvider","GoskeyDetails","SesRuDetails","SesComDetails","TaxcomDetails","GoskeyApiKey","CompanySelector","constructor","options","id","provider","code","uid","timestamp","container","HTMLDivElement","info","title","header","name","dropdownButton","rqInn","editButton","setRqInnButton","HTMLButtonElement","select","text","HTMLSpanElement","button","HTMLParagraphElement","connected","nameContainer","HTMLElement","nameLabelContainer","description","selectDropdownButton","connectDropdownButton","disconnected","emptyProvider","unset","Api","getProviderLayout","getLayout","load","companyUid","company","find","providers","some","setOptions","Tag","render","Loc","getMessage","show","style","display","getSelectedCompanyProvider","getCompanyId","validate","Dom","removeClass","firstElementChild","isCompanyValid","Type","isInteger","isProviderValid","isObject","isStringFilled","isValid","addClass","save","documentId","modifyB2eCompany","BX","hide","guide","Guide","onEvents","autoSave","steps","target","condition","top","bottom","color","popupOptions","width","autoHide","className","centerAngle","startOnce","menu","Menu","bindElement","cacheable","addMenuItem","onclick","close","loadB2eCompanyList","then","data","companies","isArray","Boolean","showTaxId","catch","response","console","log","Loader","mode","size","Dialog","height","items","map","entityId","tabs","showAvatars","dropdownMode","multiple","enableSearch","events","event","footer","targetNode","item","registerUrl","providerMenu","getItems","currentProvider","providerClasses","push","forEach","providerName","addItem","subtitle","avatar","badges","firstItem","nothingToSelect","length","clean","firstParagraph","secondParagraph","thirdParagraph","Helpdesk","replaceLink","append","providerInfo","Link","replaceInLoc","providerCodeToProviderInfoTextMap","providerCodeToHelpdeskCodeMap","includes","textContent","autoRegister","selectedItem","isUndefined","filteredProviders","filter","innerText","TextFormat","encode","region","formattedDate","DateTimeFormat","format","getFormat","url","URL","allowedOrigin","origin","SidePanel","Instance","open","allowCrossDomain","allowChangeHistory","contentCallback","frameStyles","onClose","deleteB2eCompany","e","error","Event","bind","setTargetNode","key","setInterval","contentWindow","postMessage","CompanyEditor","openSlider","CompanyEditorMode","Create","documentEntityId","layoutTitle","entityTypeId","DocumentEntityTypeId","B2e","guid","EditorTypeGuid","onCompanySavedHandler","companyId","onCloseHandler","Edit","window","addEventListener","clearInterval","companyName","virtual","registerB2eCompany","setTimeout","expires","daysLeft","now","Date","Math","floor","Label","LabelColor","WARNING","fill","customClass","textColor","bgColor","Alert","AlertColor","alertText","getMessagePlural"],"mappings":"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"}