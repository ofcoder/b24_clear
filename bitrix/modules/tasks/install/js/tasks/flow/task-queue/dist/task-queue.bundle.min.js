this.BX=this.BX||{};this.BX.Tasks=this.BX.Tasks||{};(function(e,s,a,l,t){"use strict";let i=e=>e,r,o;var b=babelHelpers.classPrivateFieldLooseKey("id");var p=babelHelpers.classPrivateFieldLooseKey("name");var n=babelHelpers.classPrivateFieldLooseKey("avatar");var d=babelHelpers.classPrivateFieldLooseKey("workPosition");var c=babelHelpers.classPrivateFieldLooseKey("pathToProfile");var v=babelHelpers.classPrivateFieldLooseKey("renderAvatar");class u{constructor(e){Object.defineProperty(this,v,{value:P});Object.defineProperty(this,b,{writable:true,value:void 0});Object.defineProperty(this,p,{writable:true,value:void 0});Object.defineProperty(this,n,{writable:true,value:void 0});Object.defineProperty(this,d,{writable:true,value:void 0});Object.defineProperty(this,c,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,b)[b]=parseInt(e.id,10);babelHelpers.classPrivateFieldLooseBase(this,p)[p]=e.name;babelHelpers.classPrivateFieldLooseBase(this,n)[n]=e.avatar;babelHelpers.classPrivateFieldLooseBase(this,d)[d]=e.workPosition;babelHelpers.classPrivateFieldLooseBase(this,c)[c]=e.pathToProfile}render(){return t.Tag.render(r||(r=i`
			<div class="tasks-flow__task-queue-member" data-id="tasks-flow-task-queue-member-${0}">
				${0}
			</div>
		`),this.getId(),babelHelpers.classPrivateFieldLooseBase(this,v)[v]())}getId(){return babelHelpers.classPrivateFieldLooseBase(this,b)[b]}getName(){return babelHelpers.classPrivateFieldLooseBase(this,p)[p]}getAvatar(){return babelHelpers.classPrivateFieldLooseBase(this,n)[n]}getPathToProfile(){return babelHelpers.classPrivateFieldLooseBase(this,c)[c]}}function P(){let e="<i></i>";if(this.getAvatar()){e=`<i style="background-image: url('${encodeURI(this.getAvatar())}')"></i>`}return t.Tag.render(o||(o=i`
			<a 
				href="${0}"
				class="tasks-flow__task-queue-member_avatar ui-icon ui-icon-common-user"
			>
				${0}
			</a>
		`),t.Text.encode(this.getPathToProfile()),e)}let h=e=>e,L;var F=babelHelpers.classPrivateFieldLooseKey("serial");var H=babelHelpers.classPrivateFieldLooseKey("createdBy");var f=babelHelpers.classPrivateFieldLooseKey("creator");var B=babelHelpers.classPrivateFieldLooseKey("responsibleId");var y=babelHelpers.classPrivateFieldLooseKey("responsible");var w=babelHelpers.classPrivateFieldLooseKey("timeInStatus");class _{constructor(e){Object.defineProperty(this,F,{writable:true,value:void 0});Object.defineProperty(this,H,{writable:true,value:void 0});Object.defineProperty(this,f,{writable:true,value:void 0});Object.defineProperty(this,B,{writable:true,value:void 0});Object.defineProperty(this,y,{writable:true,value:void 0});Object.defineProperty(this,w,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,F)[F]=parseInt(e.serial,10);babelHelpers.classPrivateFieldLooseBase(this,H)[H]=parseInt(e.createdBy,10);babelHelpers.classPrivateFieldLooseBase(this,f)[f]=new u(e.creator);babelHelpers.classPrivateFieldLooseBase(this,B)[B]=parseInt(e.responsibleId,10);babelHelpers.classPrivateFieldLooseBase(this,y)[y]=new u(e.responsible);babelHelpers.classPrivateFieldLooseBase(this,w)[w]=e.timeInStatus.formatted}render(){return t.Tag.render(L||(L=h`
			<div class="tasks-flow__task-queue-line">
				<div class="tasks-flow__task-queue-line_number">${0}</div>
				<div class="tasks-flow__task-queue-line_avatar">${0}</div>
				<div class="ui-icon-set --chevron-right" style="--ui-icon-set__icon-size: 18px;"></div>
				<div class="tasks-flow__task-queue-line_avatar">${0}</div>
				<div class="tasks-flow__task-queue-line_time" title="${0}">${0}</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,F)[F],babelHelpers.classPrivateFieldLooseBase(this,f)[f].render(),babelHelpers.classPrivateFieldLooseBase(this,y)[y].render(),babelHelpers.classPrivateFieldLooseBase(this,w)[w],babelHelpers.classPrivateFieldLooseBase(this,w)[w])}}let k=e=>e,g,O;var K=babelHelpers.classPrivateFieldLooseKey("params");var I=babelHelpers.classPrivateFieldLooseKey("flowId");var j=babelHelpers.classPrivateFieldLooseKey("type");var m=babelHelpers.classPrivateFieldLooseKey("pageSize");var T=babelHelpers.classPrivateFieldLooseKey("pageNum");var E=babelHelpers.classPrivateFieldLooseKey("pending");var $=babelHelpers.classPrivateFieldLooseKey("pages");var q=babelHelpers.classPrivateFieldLooseKey("popup");var C=babelHelpers.classPrivateFieldLooseKey("loader");var A=babelHelpers.classPrivateFieldLooseKey("layout");var S=babelHelpers.classPrivateFieldLooseKey("getList");var X=babelHelpers.classPrivateFieldLooseKey("renderContent");var D=babelHelpers.classPrivateFieldLooseKey("renderLines");var N=babelHelpers.classPrivateFieldLooseKey("showLines");var M=babelHelpers.classPrivateFieldLooseKey("appendLines");var x=babelHelpers.classPrivateFieldLooseKey("showLoader");var z=babelHelpers.classPrivateFieldLooseKey("destroyLoader");var R=babelHelpers.classPrivateFieldLooseKey("consoleError");class U{constructor(e){Object.defineProperty(this,R,{value:ee});Object.defineProperty(this,z,{value:Z});Object.defineProperty(this,x,{value:V});Object.defineProperty(this,M,{value:J});Object.defineProperty(this,N,{value:Y});Object.defineProperty(this,D,{value:Q});Object.defineProperty(this,X,{value:G});Object.defineProperty(this,S,{value:W});Object.defineProperty(this,K,{writable:true,value:void 0});Object.defineProperty(this,I,{writable:true,value:void 0});Object.defineProperty(this,j,{writable:true,value:void 0});Object.defineProperty(this,m,{writable:true,value:10});Object.defineProperty(this,T,{writable:true,value:1});Object.defineProperty(this,E,{writable:true,value:false});Object.defineProperty(this,$,{writable:true,value:void 0});Object.defineProperty(this,q,{writable:true,value:void 0});Object.defineProperty(this,C,{writable:true,value:void 0});Object.defineProperty(this,A,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,K)[K]=e;babelHelpers.classPrivateFieldLooseBase(this,I)[I]=parseInt(e.flowId,10);if(!(e.type in U.TYPES)){throw new Error("The specified queue type is incorrect")}babelHelpers.classPrivateFieldLooseBase(this,j)[j]=e.type;babelHelpers.classPrivateFieldLooseBase(this,$)[$]={};babelHelpers.classPrivateFieldLooseBase(this,A)[A]={}}static showInstance(e){this.getInstance(e).show(e.bindElement)}static getInstance(e){var s,a;const l=e.flowId+e.type;(a=(s=this.instances)[l])!=null?a:s[l]=new this(e);return this.instances[l]}show(e){babelHelpers.classPrivateFieldLooseBase(this,q)[q]=this.getPopup();babelHelpers.classPrivateFieldLooseBase(this,q)[q].setContent(babelHelpers.classPrivateFieldLooseBase(this,X)[X]());babelHelpers.classPrivateFieldLooseBase(this,q)[q].setBindElement(e);babelHelpers.classPrivateFieldLooseBase(this,q)[q].show()}getPopup(){const e=babelHelpers.classPrivateFieldLooseBase(this,K)[K].flowId+babelHelpers.classPrivateFieldLooseBase(this,K)[K].type;const s=`tasks-flow-task-queue-popup-${e}`;if(a.PopupManager.getPopupById(s)){return a.PopupManager.getPopupById(s)}const t=new a.Popup({id:s,className:"tasks-flow__task-queue-popup",width:200,padding:2,autoHide:true,closeByEsc:true,events:{onFirstShow:()=>{babelHelpers.classPrivateFieldLooseBase(this,N)[N]()}}});new l.SidePanelIntegration(t);return t}}function W(e){babelHelpers.classPrivateFieldLooseBase(this,E)[E]=true;const s={PENDING:"Pending",AT_WORK:"Progress",COMPLETED:"Completed"};return new Promise((a=>{t.ajax.runAction(`tasks.flow.Task.${s[babelHelpers.classPrivateFieldLooseBase(this,j)[j]]}.list`,{data:{flowData:{id:babelHelpers.classPrivateFieldLooseBase(this,I)[I]},ago:{days:30}},navigation:{page:e,size:babelHelpers.classPrivateFieldLooseBase(this,m)[m]}}).then((e=>{babelHelpers.classPrivateFieldLooseBase(this,E)[E]=false;if(e.data.tasks.length>=babelHelpers.classPrivateFieldLooseBase(this,m)[m]){babelHelpers.classPrivateFieldLooseBase(this,T)[T]++}a(e.data.tasks)})).catch((e=>{babelHelpers.classPrivateFieldLooseBase(this,R)[R]("getList",e)}))}))}function G(){const{popupContainer:e,popupContent:s}=t.Tag.render(g||(g=k`
			<div ref="popupContainer" class="tasks-flow__task-queue-popup_container">
				<div ref="listContainer" class="tasks-flow__task-queue-popup_content">
					<div class="tasks-flow__task-queue-popup_content-box">
						<span class="tasks-flow__task-queue-popup_label">
							<span class="tasks-flow__task-queue-popup_label-text">
								${0}
							</span>
						</span>
						${0}
					</div>
				</div>
			</div>
		`),t.Loc.getMessage(`TASKS_FLOW_TASK_QUEUE_POPUP_LABEL_${babelHelpers.classPrivateFieldLooseBase(this,j)[j]}`),babelHelpers.classPrivateFieldLooseBase(this,D)[D]());babelHelpers.classPrivateFieldLooseBase(this,A)[A].popupContainer=e;babelHelpers.classPrivateFieldLooseBase(this,A)[A].popupContent=s;return babelHelpers.classPrivateFieldLooseBase(this,A)[A].popupContainer}function Q(){babelHelpers.classPrivateFieldLooseBase(this,A)[A].popupInner=t.Tag.render(O||(O=k`
			<div class="tasks-flow__task-queue-popup_inner">
				${0}
			</div>
		`),Object.values(babelHelpers.classPrivateFieldLooseBase(this,$)[$]).flat().map((e=>e.render())));t.Event.bind(babelHelpers.classPrivateFieldLooseBase(this,A)[A].popupInner,"scroll",(()=>{const e=babelHelpers.classPrivateFieldLooseBase(this,A)[A].popupInner.scrollTop;const s=babelHelpers.classPrivateFieldLooseBase(this,A)[A].popupInner.scrollHeight-babelHelpers.classPrivateFieldLooseBase(this,A)[A].popupInner.offsetHeight;if(Math.abs(e-s)<1&&babelHelpers.classPrivateFieldLooseBase(this,E)[E]===false){babelHelpers.classPrivateFieldLooseBase(this,N)[N]()}}));return babelHelpers.classPrivateFieldLooseBase(this,A)[A].popupInner}function Y(){babelHelpers.classPrivateFieldLooseBase(this,x)[x]();babelHelpers.classPrivateFieldLooseBase(this,M)[M](babelHelpers.classPrivateFieldLooseBase(this,T)[T]).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,z)[z]()}))}function J(e){if(babelHelpers.classPrivateFieldLooseBase(this,$)[$][e]){return Promise.resolve()}const s=babelHelpers.classPrivateFieldLooseBase(this,A)[A].popupInner;return babelHelpers.classPrivateFieldLooseBase(this,S)[S](e).then((a=>{babelHelpers.classPrivateFieldLooseBase(this,$)[$][e]=a.map((e=>new _(e)));babelHelpers.classPrivateFieldLooseBase(this,$)[$][e].forEach((e=>t.Dom.append(e.render(),s)))}))}function V(){const e=t.Dom.getPosition(babelHelpers.classPrivateFieldLooseBase(this,A)[A].popupInner);const a=40;babelHelpers.classPrivateFieldLooseBase(this,C)[C]=new s.Loader({target:babelHelpers.classPrivateFieldLooseBase(this,A)[A].popupInner,size:a,mode:"inline",offset:{left:`${e.width/2-a/2}px`}});babelHelpers.classPrivateFieldLooseBase(this,C)[C].show()}function Z(){babelHelpers.classPrivateFieldLooseBase(this,C)[C].destroy()}function ee(e,s){console.error(`TaskQueue: ${e} error`,s)}U.instances={};U.TYPES={PENDING:"PENDING",AT_WORK:"AT_WORK",COMPLETED:"COMPLETED"};e.TaskQueue=U})(this.BX.Tasks.Flow=this.BX.Tasks.Flow||{},BX,BX.Main,BX.Tasks,BX);
//# sourceMappingURL=task-queue.bundle.map.js