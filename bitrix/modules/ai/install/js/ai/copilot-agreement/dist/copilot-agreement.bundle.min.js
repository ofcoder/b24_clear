this.BX=this.BX||{};(function(e,s,t,a,l,o){"use strict";let i=e=>e,r;var n=babelHelpers.classPrivateFieldLooseKey("events");var c=babelHelpers.classPrivateFieldLooseKey("wasAccepted");var p=babelHelpers.classPrivateFieldLooseKey("engine");var b=babelHelpers.classPrivateFieldLooseKey("popup");var d=babelHelpers.classPrivateFieldLooseKey("checkAgreementResult");var v=babelHelpers.classPrivateFieldLooseKey("showAgreementPopup");var u=babelHelpers.classPrivateFieldLooseKey("hideAgreementPopup");var P=babelHelpers.classPrivateFieldLooseKey("initAgreementPopup");var h=babelHelpers.classPrivateFieldLooseKey("renderPopupContent");var L=babelHelpers.classPrivateFieldLooseKey("renderApplyButton");var H=babelHelpers.classPrivateFieldLooseKey("renderCancelButton");var B=babelHelpers.classPrivateFieldLooseKey("handleClickOnAcceptBtn");var F=babelHelpers.classPrivateFieldLooseKey("getFullAgreementLink");var f=babelHelpers.classPrivateFieldLooseKey("acceptAgreement");var g=babelHelpers.classPrivateFieldLooseKey("validateOptions");class A{constructor(e){Object.defineProperty(this,g,{value:j});Object.defineProperty(this,f,{value:T});Object.defineProperty(this,F,{value:C});Object.defineProperty(this,B,{value:E});Object.defineProperty(this,H,{value:I});Object.defineProperty(this,L,{value:O});Object.defineProperty(this,h,{value:w});Object.defineProperty(this,P,{value:m});Object.defineProperty(this,u,{value:y});Object.defineProperty(this,v,{value:_});Object.defineProperty(this,n,{writable:true,value:void 0});Object.defineProperty(this,c,{writable:true,value:false});Object.defineProperty(this,p,{writable:true,value:void 0});Object.defineProperty(this,b,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,g)[g](e);babelHelpers.classPrivateFieldLooseBase(this,n)[n]=e.events||{};babelHelpers.classPrivateFieldLooseBase(this,p)[p]=new o.Engine;babelHelpers.classPrivateFieldLooseBase(this,p)[p].setContextId(e.contextId);babelHelpers.classPrivateFieldLooseBase(this,p)[p].setModuleId(e.moduleId)}async checkAgreement(){if(babelHelpers.classPrivateFieldLooseBase(A,d)[d]!==null&&babelHelpers.classPrivateFieldLooseBase(A,d)[d]!==undefined){if(babelHelpers.classPrivateFieldLooseBase(A,d)[d]===false){babelHelpers.classPrivateFieldLooseBase(this,v)[v]()}return Promise.resolve(babelHelpers.classPrivateFieldLooseBase(A,d)[d])}try{const e=await babelHelpers.classPrivateFieldLooseBase(this,p)[p].checkAgreement();if(e.data.isAccepted===false){babelHelpers.classPrivateFieldLooseBase(this,v)[v]()}babelHelpers.classPrivateFieldLooseBase(A,d)[d]=e.data.isAccepted;return e.data.isAccepted}catch(e){console.error(e);return true}}}function _(){if(!babelHelpers.classPrivateFieldLooseBase(this,b)[b]){babelHelpers.classPrivateFieldLooseBase(this,P)[P]()}babelHelpers.classPrivateFieldLooseBase(this,b)[b].show()}function y(){var e;(e=babelHelpers.classPrivateFieldLooseBase(this,b)[b])==null?void 0:e.close();babelHelpers.classPrivateFieldLooseBase(this,b)[b]=null}function m(){babelHelpers.classPrivateFieldLooseBase(this,b)[b]=new t.Popup({content:babelHelpers.classPrivateFieldLooseBase(this,h)[h](),cacheable:false,overlay:true,disableScroll:true,width:492,minHeight:448,closeByEsc:true,autoHide:true,closeIcon:true,closeIconSize:t.CloseIconSize.LARGE,padding:20,borderRadius:"10px",events:{onDestroy:()=>{var e,s;if((e=babelHelpers.classPrivateFieldLooseBase(this,n)[n])!=null&&e.onAgreementPopupHide){var t;(t=babelHelpers.classPrivateFieldLooseBase(this,n)[n])==null?void 0:t.onAgreementPopupHide()}if(babelHelpers.classPrivateFieldLooseBase(this,c)[c]===false&&(s=babelHelpers.classPrivateFieldLooseBase(this,n)[n])!=null&&s.onCancel){var a;(a=babelHelpers.classPrivateFieldLooseBase(this,n)[n])==null?void 0:a.onCancel()}babelHelpers.classPrivateFieldLooseBase(this,b)[b]=null},onPopupShow:()=>{var e;if((e=babelHelpers.classPrivateFieldLooseBase(this,n)[n])!=null&&e.onAgreementPopupShow){var s;(s=babelHelpers.classPrivateFieldLooseBase(this,n)[n])==null?void 0:s.onAgreementPopupShow()}}}})}function w(){return s.Tag.render(r||(r=i`
			<div
				class="ai__copilot-agreement-popup-content"
			>
				<header class="ai__copilot-agreement-popup-content_header">
					<h3 class="ai__copilot-agreement-popup-content_title">
						${0}
					</h3>
				</header>
				<main class="ai__copilot-agreement-popup-content_main">
					<div class="ai__copilot-agreement-popup-content_img"></div>
					<p class="ai__copilot-agreement-popup-content_text">
						${0}
					</p>
					<p class="ai__copilot-agreement-popup-content_text">
						${0}
					</p>
				</main>
				<footer class="ai__copilot-agreement-popup-content_footer">
					<div class="ai__copilot-agreement-popup_footer-content-buttons">
						${0}
						${0}
					</div>
				</footer>
			</div>
		`),s.Loc.getMessage("COPILOT_AGREEMENT_POPUP_TITLE"),s.Loc.getMessage("COPILOT_AGREEMENT_POPUP_PARAGRAPH_1"),s.Loc.getMessage("COPILOT_AGREEMENT_POPUP_PARAGRAPH_2",{"#LINK#":`<a target="_blank" href="${babelHelpers.classPrivateFieldLooseBase(this,F)[F]()}">`,"#/LINK#":"</a>"}),babelHelpers.classPrivateFieldLooseBase(this,L)[L](),babelHelpers.classPrivateFieldLooseBase(this,H)[H]())}function O(){const e=new a.Button({text:s.Loc.getMessage("COPILOT_AGREEMENT_POPUP_APPLY_BTN"),color:a.Button.Color.SUCCESS,round:true,onclick:babelHelpers.classPrivateFieldLooseBase(this,B)[B].bind(this)});return e.render()}function I(){const e=new a.Button({text:s.Loc.getMessage("COPILOT_AGREEMENT_POPUP_CANCEL_BTN"),round:true,color:a.Button.Color.LIGHT,onclick:()=>{babelHelpers.classPrivateFieldLooseBase(this,b)[b].destroy()}});return e.render()}async function E(e){try{var t;e.setState(a.Button.State.WAITING);babelHelpers.classPrivateFieldLooseBase(A,d)[d]=await babelHelpers.classPrivateFieldLooseBase(this,f)[f]();babelHelpers.classPrivateFieldLooseBase(this,c)[c]=babelHelpers.classPrivateFieldLooseBase(A,d)[d];if((t=babelHelpers.classPrivateFieldLooseBase(this,n)[n])!=null&&t.onAccept){babelHelpers.classPrivateFieldLooseBase(this,n)[n].onAccept()}babelHelpers.classPrivateFieldLooseBase(this,u)[u]()}catch(e){var o;if((o=babelHelpers.classPrivateFieldLooseBase(this,n)[n])!=null&&o.onAcceptError){var i;(i=babelHelpers.classPrivateFieldLooseBase(this,n)[n])==null?void 0:i.onAcceptError()}l.UI.Notification.Center.notify({content:s.Loc.getMessage("COPILOT_AGREEMENT_POPUP_APPLY_ERROR")});console.error(e)}finally{e.setState(null)}}function C(){const e=s.Extension.getSettings("ai.copilot-agreement").zone;const t={ru:"https://www.bitrix24.ru/about/terms-of-use-ai.php",kz:"https://www.bitrix24.kz/about/terms-of-use-ai.php",by:"https://www.bitrix24.by/about/terms-of-use-ai.php",en:"https://www.bitrix24.com/terms/bitrix24copilot-rules.php"};return t[e]||t.en}async function T(){const e=await babelHelpers.classPrivateFieldLooseBase(this,p)[p].acceptAgreement();return e.data.isAccepted}function j(e){if(!e.moduleId||s.Type.isStringFilled(e.moduleId)===false){throw new Error("AI: CopilotAgreement: moduleId option is required and must be the string")}if(!e.contextId||s.Type.isStringFilled(e.contextId)===false){throw new Error("AI: CopilotAgreement: moduleId option is required and must be the string")}if(e.events&&s.Type.isObject(e.events)===false){throw new Error("AI: CopilotAgreement: events option must be the object")}}Object.defineProperty(A,d,{writable:true,value:null});e.CopilotAgreement=A})(this.BX.AI=this.BX.AI||{},BX,BX.Main,BX.UI,BX,BX.AI);
//# sourceMappingURL=copilot-agreement.bundle.map.js