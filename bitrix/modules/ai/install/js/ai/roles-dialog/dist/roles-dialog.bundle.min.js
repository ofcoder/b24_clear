this.BX=this.BX||{};(function(e,t,s,a,i,l,o,r,n,c){"use strict";let d=e=>e,b,p;var v=babelHelpers.classPrivateFieldLooseKey("popup");var u=babelHelpers.classPrivateFieldLooseKey("initPopup");var h=babelHelpers.classPrivateFieldLooseKey("renderContent");var L=babelHelpers.classPrivateFieldLooseKey("renderPopupTitleBar");class P{constructor(){Object.defineProperty(this,L,{value:m});Object.defineProperty(this,h,{value:g});Object.defineProperty(this,u,{value:_});Object.defineProperty(this,v,{writable:true,value:void 0})}show(){if(!babelHelpers.classPrivateFieldLooseBase(this,v)[v]){babelHelpers.classPrivateFieldLooseBase(this,u)[u]()}babelHelpers.classPrivateFieldLooseBase(this,v)[v].show()}hide(){var e;(e=babelHelpers.classPrivateFieldLooseBase(this,v)[v])==null?void 0:e.close()}}function _(){babelHelpers.classPrivateFieldLooseBase(this,v)[v]=new s.Popup({content:babelHelpers.classPrivateFieldLooseBase(this,h)[h](),resizable:true,width:881,height:621,padding:0,contentPadding:0,borderRadius:"10px 10px 4px 4px",className:"ai_roles-dialog_popup",animation:true,cacheable:false})}function g(){return l.Tag.render(b||(b=d`
			<div class="ai__roles-dialog_loader-popup-inner">
				${0}
				<div class="ai__roles-dialog_loader-popup-content">
					<div class="ai__roles-dialog_loader-popup-content-left">
						<div style="width: 145px; height: 10px; margin-bottom: 22px; margin-left: 12px;">
							<div class="rec --color-ai"></div>
						</div>
						<div style="width: 100%; height: 119px; margin-bottom: 14px;">
							<div class="rec --color-ai"></div>
						</div>
						<div style="width: 100%; height: 54px;">
							<div class="rec --color-ai"></div>
						</div>
					</div>
					<div class="ai__roles-dialog_loader-popup-content-right">
					<div style="width: 101px; height: 10px; margin-bottom: 22px;">
							<div class="rec"></div>
						</div>
						<div style="width: 100%; height: 75px; margin-bottom: 8px;">
							<div class="rec"></div>
						</div>
						<div style="width: 100%; height: 75px;">
							<div class="rec"></div>
						</div>
					</div>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,L)[L]())}function m(){return l.Tag.render(p||(p=d`
			<div class="ai__roles-dialog_loader-popup-title-bar">
				<div
					style="width: 152px; height: 16px;"
					class="ai__roles-dialog_loader-popup-title-bar-left"
				>
					<div class="rec"></div>
				</div>
				<div
					style="width: 98px; height: 16px;"
					class="ai__roles-dialog_loader-popup-title-bar-left"
				>
					<div class="rec"></div>
				</div>
			</div>
		`))}let H=e=>e,f;function F(){const e=new s.Popup({content:B(),resizable:false,width:881,height:621,padding:0,contentPadding:0,borderRadius:"10px 10px 4px 4px",className:"ai_roles-dialog_popup",animation:true,cacheable:false,autoHide:true,closeByEsc:true,closeIcon:true,closeIconSize:s.CloseIconSize.LARGE});e.show()}function B(){return l.Tag.render(f||(f=H`
		<div class="ai__roles-dialog_error-popup-inner">
			<div class="ai__roles-dialog_error-popup-content">
				<div class="ai__roles-dialog_error-popup-content-warning-icon">
					${0}
				</div>
				<p class="ai__roles-dialog_error-popup-content-error-text">
					${0}
				</p>
			</div>
		</div>
	`),y(),l.Loc.getMessage("AI_COPILOT_ROLES_ERROR_TEXT"))}function y(){const e="rgba(176, 149, 220, 0.4)";const t=new c.Icon({icon:c.Main.WARNING,size:56,color:e});return t.render()}const I=Object.freeze({OPEN:"open",CLOSE:"close",SAVE:"save",SEARCH:"search",FEEDBACK:"feedback",SELECT:"save"});const O=Object.freeze({SUCCESS:"success",ERROR:"error"});var R=babelHelpers.classPrivateFieldLooseKey("cSection");var E=babelHelpers.classPrivateFieldLooseKey("sendLabel");var S=babelHelpers.classPrivateFieldLooseKey("getCommonParameters");var C=babelHelpers.classPrivateFieldLooseKey("getFormattedExtraParams");class w{constructor(e){Object.defineProperty(this,C,{value:A});Object.defineProperty(this,S,{value:T});Object.defineProperty(this,E,{value:D});Object.defineProperty(this,R,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,R)[R]=e.cSection}sendOpenLabel(e,t){const s=e?O.SUCCESS:O.ERROR;const a=t?{p1:{name:"role",value:t}}:{};babelHelpers.classPrivateFieldLooseBase(this,E)[E]({status:s,extraParams:a,event:I.OPEN})}sendCloseLabel(e){const t=e?{p1:{name:"role",value:e}}:{};babelHelpers.classPrivateFieldLooseBase(this,E)[E]({extraParams:t,event:I.CLOSE})}sendSelectLabel(e){const t=e?{p1:{name:"role",value:e}}:{};babelHelpers.classPrivateFieldLooseBase(this,E)[E]({extraParams:t,event:I.SELECT})}sendSearchLabel(e){const t=e?{p1:{name:"search",value:e}}:{};babelHelpers.classPrivateFieldLooseBase(this,E)[E]({extraParams:t,event:I.SEARCH})}sendFeedBackLabel(){babelHelpers.classPrivateFieldLooseBase(this,E)[E]({event:I.FEEDBACK})}}async function D(e){const t=e.status||O.SUCCESS;const s=e.event;const a=e.extraParams||{};try{const{sendData:e}=await l.Runtime.loadExtension("ui.analytics");const i={event:s,status:t,...babelHelpers.classPrivateFieldLooseBase(this,S)[S](),...babelHelpers.classPrivateFieldLooseBase(this,C)[C](a)};e(i)}catch(e){console.error("AI: RolesDialog: Can't send analytics",e)}}function T(){return{tool:"ai",category:"roles_picker",c_section:babelHelpers.classPrivateFieldLooseBase(this,R)[R]}}function A(e){const t={};Object.entries(e).forEach((([e,s])=>{t[e]=`${l.Text.toCamelCase(s.name)}_${l.Text.toCamelCase(s.value)}`}));return t}const x={CHOOSE_STANDARD_ROLE:"AI.RolesDialog.GroupListFooter:ChooseStandardRole"};const N={methods:{handleClick(){a.EventEmitter.emit(document,x.CHOOSE_STANDARD_ROLE)}},template:`\n\t\t<button @click="handleClick" class="ai__roles-dialog_standard-group-btn">\n\t\t\t<span class="ai__roles-dialog_standard-group-btn-text">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('AI_COPILOT_ROLES_USE_STANDARD_ROLE') }}\n\t\t\t</span>\n\t\t</button>\n\t`};const j={components:{Hint:i.Hint},props:{header:{type:String,required:false,default:""},hint:{type:String,required:false,default:""}},template:`\n\t\t<div class="ai__roles-dialog_header-with-hint">\n\t\t\t<span class="ai__roles-dialog_header-with-hint-text">\n\t\t\t\t{{ header }}\n\t\t\t</span>\n\t\t\t<span\n\t\t\t\tv-if="hint"\n\t\t\t\tclass="ai__roles-dialog_header-with-hint-text-hint"\n\t\t\t>\n\t\t\t\t<Hint :text="hint" />\n\t\t\t</span>\n\t\t</div>\n\t`};const K={components:{RolesDialogHeaderWithHint:j},computed:{text(){return this.$Bitrix.Loc.getMessage("AI_COPILOT_ROLES_GROUP_LIST_HEADER_2")},hint(){return this.$Bitrix.Loc.getMessage("AI_COPILOT_ROLES_GROUP_LIST_HEADER_HINT_2")}},template:`\n\t\t<div class="ai__roles-dialog_group-list-header">\n\t\t\t<RolesDialogHeaderWithHint\n\t\t\t\t:header="text"\n\t\t\t\t:hint="hint"\n\t\t\t/>\n\t\t</div>\n\t`};function M(e,t){const s=e=>{t.sendSearchLabel(e)};const a=l.Runtime.debounce(s,800);return{components:{RolesDialogHeaderWithHint:j},computed:{...o.mapWritableState(e.useGlobalState,{searchQuery:"searchQuery",searching:"searchApplied"}),header(){return this.$Bitrix.Loc.getMessage("AI_COPILOT_ROLES_MAIN_CONTENT_HEADER")},hint(){return this.$Bitrix.Loc.getMessage("AI_COPILOT_ROLES_MAIN_CONTENT_HEADER_HINT")}},watch:{searchQuery(){if(this.searching){a(this.searchQuery)}}},template:`\n\t\t\t<div class="ai__roles-dialog_main-content-header">\n\t\t\t\t<RolesDialogHeaderWithHint\n\t\t\t\t\t:header="header"\n\t\t\t\t\t:hint="hint"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t`}}const z={name:"RolesDialogRoleItemAvatar",components:{BIcon:n.BIcon},data(){return{isAvatarLoaded:null}},props:{avatar:{type:String,required:false,default:null},avatarAlt:{type:String,required:false,default:""},icon:{type:String,required:false,default:null}},computed:{iconSize(){return 24},iconColor(){return getComputedStyle(document.body).getPropertyValue("--ui-color-background-primary")||"#fff"},fallbackIcon(){return c.Main.COPILOT_AI}},methods:{onImageLoad(){this.isAvatarLoaded=true},onImageLoadError(){this.isAvatarLoaded=false}},template:`\n\t\t<div\n\t\t\tclass="ai__roles-dialog_role-image-wrapper"\n\t\t>\n\t\t\t<div\n\t\t\t\tv-if="icon"\n\t\t\t\tclass="ai__roles-dialog_role-image-icon"\n\t\t\t>\n\t\t\t\t<BIcon\n\t\t\t\t\t:name="icon"\n\t\t\t\t\t:size="iconSize"\n\t\t\t\t\t:color="iconColor"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-else\n\t\t\t>\n\t\t\t\t<transition name="ai-roles-dialog-icon-fade">\n\t\t\t\t\t<img\n\t\t\t\t\t\tv-show="isAvatarLoaded"\n\t\t\t\t\t\tclass="ai__roles-dialog_role-image"\n\t\t\t\t\t\t:src="avatar"\n\t\t\t\t\t\t:alt="avatarAlt"\n\t\t\t\t\t\t@error="onImageLoadError"\n\t\t\t\t\t\t@load="onImageLoad"\n\t\t\t\t\t/>\n\t\t\t\t</transition>\n\t\t\t\t<div\n\t\t\t\t\tv-if="isAvatarLoaded === null || isAvatarLoaded === false"\n\t\t\t\t\t:class="{'ai__roles-dialog_role-image-icon': true, '--loading': isAvatarLoaded === null}"\n\t\t\t\t>\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\t:name="fallbackIcon"\n\t\t\t\t\t\t:size="iconSize"\n\t\t\t\t\t\t:color="iconColor"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const k={props:{inverted:{type:Boolean,required:false,default:false}},computed:{labelHTML(){const e=this.inverted?r.LabelColor.COPILOT_LIGHT_REVERSE:r.LabelColor.COPILOT_LIGHT;const t=new r.Label({color:e,size:r.LabelSize.SM,text:"NEW",fill:true});return t.render().outerHTML}},template:`\n\t\t<div ref="label" class="ai__roles-dialog_label" v-html="labelHTML"></div>\n\t`};function G(e){return{name:"RolesDialogRoleItem",components:{BIcon:n.BIcon,RolesDialogRoleItemAvatar:z,RolesDialogLabelNew:k},props:["itemData"],computed:{...o.mapWritableState(e.useGlobalState,{searching:"searchApplied",searchQuery:"searchQuery"}),item(){return this.itemData.itemData},subtitle(){const e=this.item.subtitle;if(this.searching&&this.searchQuery!==""){return e.replaceAll(new RegExp(this.searchQuery,"gi"),(e=>`<mark>${e}</mark>`))}return e},title(){const e=this.item.title;if(this.searching&&this.searchQuery!==""){return e.replaceAll(new RegExp(this.searchQuery,"gi"),(e=>`<mark>${e}</mark>`))}return e},isSelected(){var e;return Boolean((e=this.item.customData)==null?void 0:e.selected)},isNew(){var e;return Boolean((e=this.item.customData)==null?void 0:e.isNew)},isInfoItem(){var e;return Boolean((e=this.item.customData)==null?void 0:e.isInfoItem)},className(){return{"ai__roles-dialog_role-item":true,"--selected":this.isSelected}},selectedIconData(){return{name:c.Main.CHECK,color:this.getUiTokenValue("--ui-color-copilot-soft")||"#B095DC",size:16}},infoIcon(){return c.Main.INFO}},methods:{selectRole(){if(l.Type.isFunction(this.item.button.action)){this.item.button.action()}},getUiTokenValue(e){getComputedStyle(document.body).getPropertyValue(e)}},template:`\n\t\t\t<article @click="selectRole" :class="className">\n\t\t\t  <RolesDialogRoleItemAvatar\n\t\t\t      :avatar="item.customData.avatar"\n\t\t\t      :avatar-alt="item.title"\n\t\t\t      :icon="isInfoItem ? infoIcon : null"\n\t\t\t  />\n\t\t\t  <div class="ai__roles-dialog_role-item-info">\n\t\t\t    <div class="ai__roles-dialog_role-item-title-wrapper">\n\t\t\t\t\t<div class="ai__roles-dialog_role-item-title" v-html="title"></div>\n\t\t\t\t\t<div class="ai__roles-dialog_role-item-label">\n\t\t\t\t\t\t<RolesDialogLabelNew v-if="isNew" />\n\t\t\t\t\t</div>\n\t\t\t    </div>\n\t\t\t    <p class="ai__roles-dialog_role-item-description" v-html="subtitle"></p>\n\t\t\t  </div>\n\t\t\t  <div\n\t\t\t      v-if="isSelected"\n\t\t\t      class="ai__roles-dialog_role-item-select-icon"\n\t\t\t  >\n\t\t\t    <BIcon\n\t\t\t        :name="selectedIconData.name"\n\t\t\t        :size="selectedIconData.size"\n\t\t\t        :color="selectedIconData.color"\n\t\t\t    />\n\t\t\t  </div>\n\t\t\t</article>\n\t\t`}}const U={components:{BIcon:n.BIcon,RolesDialogLabelNew:k},props:["groupData"],computed:{group(){return this.groupData.groupData},isNew(){return this.group.customData.isNew},isSelected(){return this.group.selected},handleClick(){if(this.group.selected){return undefined}return this.groupData.handleClick},groupItemClassname(){return{"ai__roles-dialog_group-item":true,"--selected":this.isSelected}},chevronRightIconName(){return c.Actions.CHEVRON_RIGHT}},template:`\n\t\t<div @click="handleClick" class="ai__roles-dialog_group-item-wrapper">\n\t\t\t<div :class="groupItemClassname">\n\t\t\t\t<div class="ai__roles-dialog_group-item-inner">\n\t\t\t\t<div class="ai__roles-dialog_group-item-title-wrapper">\n\t\t\t\t\t<span class="ai__roles-dialog_group-item-title">\n\t\t\t\t\t\t{{ group.name }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<div class="ai__roles-dialog_group-item-label-new">\n\t\t\t\t\t\t<RolesDialogLabelNew\n\t\t\t\t\t\t\tv-if="isNew"\n\t\t\t\t\t\t\t:inverted="isSelected"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t\t<b-icon :size="16" :name="chevronRightIconName"></b-icon>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const $={template:`\n\t\t<div class="ai__roles-dialog_search-stub">\n\t\t\t<div class="ai__roles-dialog_search-stub-content">\n\t\t\t\t<div class="ai__roles-dialog_search-stub-image"></div>\n\t\t\t\t<div class="ai__roles-dialog_search-stub-text">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('AI_COPILOT_ROLES_SEARCH_NO_RESULT_2') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const X={HIDE:"hide",SELECT_ROLE:"select-role",SELECT_DEFAULT_ROLE:"select-default-role"};const q="recommended";const Q="recents";var V=babelHelpers.classPrivateFieldLooseKey("entityCatalog");var W=babelHelpers.classPrivateFieldLooseKey("engine");var J=babelHelpers.classPrivateFieldLooseKey("analytic");var Y=babelHelpers.classPrivateFieldLooseKey("roles");var Z=babelHelpers.classPrivateFieldLooseKey("recentRoles");var ee=babelHelpers.classPrivateFieldLooseKey("defaultRoleCode");var te=babelHelpers.classPrivateFieldLooseKey("industries");var se=babelHelpers.classPrivateFieldLooseKey("selectedDefaultRoleHandler");var ae=babelHelpers.classPrivateFieldLooseKey("selectedRoleCode");var ie=babelHelpers.classPrivateFieldLooseKey("universalRole");var le=babelHelpers.classPrivateFieldLooseKey("title");var oe=babelHelpers.classPrivateFieldLooseKey("moduleId");var re=babelHelpers.classPrivateFieldLooseKey("contextId");var ne=babelHelpers.classPrivateFieldLooseKey("validateOptions");var ce=babelHelpers.classPrivateFieldLooseKey("showAfterInit");var de=babelHelpers.classPrivateFieldLooseKey("subscribeEvents");var be=babelHelpers.classPrivateFieldLooseKey("unsubscribeEvents");var pe=babelHelpers.classPrivateFieldLooseKey("selectRole");var ve=babelHelpers.classPrivateFieldLooseKey("selectDefaultRole");var ue=babelHelpers.classPrivateFieldLooseKey("init");var he=babelHelpers.classPrivateFieldLooseKey("initEntityCatalog");var Le=babelHelpers.classPrivateFieldLooseKey("getSlots");var Pe=babelHelpers.classPrivateFieldLooseKey("getInfoItemData");var _e=babelHelpers.classPrivateFieldLooseKey("getAllIndustryCodes");var ge=babelHelpers.classPrivateFieldLooseKey("loadData");var me=babelHelpers.classPrivateFieldLooseKey("getRecommendedRoleIndustry");var He=babelHelpers.classPrivateFieldLooseKey("getRecentRoleIndustry");var fe=babelHelpers.classPrivateFieldLooseKey("getItemsData");var Fe=babelHelpers.classPrivateFieldLooseKey("getUniversalRoleItemData");var Be=babelHelpers.classPrivateFieldLooseKey("getItemGroupsFromIndustries");var ye=babelHelpers.classPrivateFieldLooseKey("getItemGroupDataFromIndustry");var Ie=babelHelpers.classPrivateFieldLooseKey("getRecentItemGroupData");var Oe=babelHelpers.classPrivateFieldLooseKey("compareRecentItems");var Re=babelHelpers.classPrivateFieldLooseKey("getItemDataFromRole");var Ee=babelHelpers.classPrivateFieldLooseKey("getSelectedGroupIndex");var Se=babelHelpers.classPrivateFieldLooseKey("isSelectedIndustry");class Ce extends a.EventEmitter{constructor(e){super(e);Object.defineProperty(this,Se,{value:et});Object.defineProperty(this,Ee,{value:Ze});Object.defineProperty(this,Re,{value:Ye});Object.defineProperty(this,Oe,{value:Je});Object.defineProperty(this,Ie,{value:We});Object.defineProperty(this,ye,{value:Ve});Object.defineProperty(this,Be,{value:Qe});Object.defineProperty(this,Fe,{value:qe});Object.defineProperty(this,fe,{value:Xe});Object.defineProperty(this,He,{value:$e});Object.defineProperty(this,me,{value:Ue});Object.defineProperty(this,ge,{value:Ge});Object.defineProperty(this,_e,{value:ke});Object.defineProperty(this,Pe,{value:ze});Object.defineProperty(this,Le,{value:Me});Object.defineProperty(this,he,{value:Ke});Object.defineProperty(this,ue,{value:je});Object.defineProperty(this,ve,{value:Ne});Object.defineProperty(this,pe,{value:xe});Object.defineProperty(this,be,{value:Ae});Object.defineProperty(this,de,{value:Te});Object.defineProperty(this,ce,{value:De});Object.defineProperty(this,ne,{value:we});Object.defineProperty(this,V,{writable:true,value:void 0});Object.defineProperty(this,W,{writable:true,value:void 0});Object.defineProperty(this,J,{writable:true,value:void 0});Object.defineProperty(this,Y,{writable:true,value:void 0});Object.defineProperty(this,Z,{writable:true,value:void 0});Object.defineProperty(this,ee,{writable:true,value:void 0});Object.defineProperty(this,te,{writable:true,value:void 0});Object.defineProperty(this,se,{writable:true,value:void 0});Object.defineProperty(this,ae,{writable:true,value:void 0});Object.defineProperty(this,ie,{writable:true,value:void 0});Object.defineProperty(this,le,{writable:true,value:void 0});Object.defineProperty(this,oe,{writable:true,value:void 0});Object.defineProperty(this,re,{writable:true,value:void 0});this.setEventNamespace("AI.RolesDialog");babelHelpers.classPrivateFieldLooseBase(this,ne)[ne](e);babelHelpers.classPrivateFieldLooseBase(this,le)[le]=e.title||"";if(e.engine){babelHelpers.classPrivateFieldLooseBase(this,W)[W]=e.engine}else{babelHelpers.classPrivateFieldLooseBase(this,W)[W]=new t.Engine({})}babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]=e.moduleId;babelHelpers.classPrivateFieldLooseBase(this,re)[re]=e.contextId;babelHelpers.classPrivateFieldLooseBase(this,W)[W].setModuleId(e.moduleId);babelHelpers.classPrivateFieldLooseBase(this,W)[W].setContextId(e.contextId);babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]=l.Type.isString(e.selectedRoleCode)?e.selectedRoleCode:"";babelHelpers.classPrivateFieldLooseBase(this,J)[J]=new w({cSection:`${babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]}_${babelHelpers.classPrivateFieldLooseBase(this,re)[re]}`})}setSelectedRoleCode(e){babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]=e;if(babelHelpers.classPrivateFieldLooseBase(this,V)[V]){babelHelpers.classPrivateFieldLooseBase(this,V)[V].setGroups(babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]());babelHelpers.classPrivateFieldLooseBase(this,V)[V].setItems(babelHelpers.classPrivateFieldLooseBase(this,fe)[fe]())}}async show(){if(babelHelpers.classPrivateFieldLooseBase(this,V)[V]){babelHelpers.classPrivateFieldLooseBase(this,V)[V].show();babelHelpers.classPrivateFieldLooseBase(this,J)[J].sendOpenLabel(true,babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]);return}await babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]()}hide(){var e;(e=babelHelpers.classPrivateFieldLooseBase(this,V)[V])==null?void 0:e.close()}}function we(e){if(l.Type.isStringFilled(e.moduleId)===false){throw new l.BaseError("AI.RolesDialog: moduleId is required option and must be string")}if(l.Type.isStringFilled(e.contextId)===false){throw new l.BaseError("AI.RolesDialog: contextId is required option and must be string")}if(e.selectedRoleCode!==undefined&&l.Type.isString(e.selectedRoleCode)===false){throw new l.BaseError("AI.RolesDialog: selectedRoleCode must be string")}if(e.title&&l.Type.isString(e.title)===false){throw new l.BaseError("AI.RolesDialog: title must be string")}if(e.engine&&!(e.engine instanceof t.Engine)){throw new l.BaseError("AI.RolesDialog: engine option must be instance of Engine")}}async function De(){const e=new P;let t=true;setTimeout((()=>{if(t){e.show()}}),300);try{await babelHelpers.classPrivateFieldLooseBase(this,ue)[ue]();babelHelpers.classPrivateFieldLooseBase(this,J)[J].sendOpenLabel(true,babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]);babelHelpers.classPrivateFieldLooseBase(this,V)[V].show()}catch(e){F();babelHelpers.classPrivateFieldLooseBase(this,J)[J].sendOpenLabel(false,babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]);console.error(e)}finally{t=false;e.hide()}}function Te(){babelHelpers.classPrivateFieldLooseBase(this,se)[se]=babelHelpers.classPrivateFieldLooseBase(this,ve)[ve].bind(this);a.EventEmitter.subscribe(document,x.CHOOSE_STANDARD_ROLE,babelHelpers.classPrivateFieldLooseBase(this,se)[se])}function Ae(){a.EventEmitter.unsubscribe(document,x.CHOOSE_STANDARD_ROLE,babelHelpers.classPrivateFieldLooseBase(this,se)[se])}function xe(e){const t=new a.BaseEvent({data:{role:e}});this.setSelectedRoleCode(e.code);babelHelpers.classPrivateFieldLooseBase(this,J)[J].sendSelectLabel(babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]);this.emit(X.SELECT_ROLE,t)}function Ne(){this.setSelectedRoleCode(babelHelpers.classPrivateFieldLooseBase(this,ee)[ee]);const e=new a.BaseEvent({data:{code:babelHelpers.classPrivateFieldLooseBase(this,ee)[ee]}});this.emit(X.SELECT_DEFAULT_ROLE,e);babelHelpers.classPrivateFieldLooseBase(this,V)[V].close()}async function je(){await babelHelpers.classPrivateFieldLooseBase(this,ge)[ge]();await babelHelpers.classPrivateFieldLooseBase(this,he)[he]()}async function Ke(){const{EntityCatalog:e,States:t}=await l.Runtime.loadExtension("ui.entity-catalog");babelHelpers.classPrivateFieldLooseBase(this,V)[V]=new e({title:babelHelpers.classPrivateFieldLooseBase(this,le)[le],showSearch:true,customComponents:{RolesDialogContentHeader:M(t,babelHelpers.classPrivateFieldLooseBase(this,J)[J]),RolesDialogRoleItem:G(t),RolesDialogGroupListHeader:K,RolesDialogGroupItem:U,RolesDialogGroupListFooter:N,RolesDialogSearchStub:$},popupOptions:{className:"ai_roles-dialog_popup ui-entity-catalog__scope",resizable:false,width:852,height:510,animation:true,events:{onPopupShow:()=>{babelHelpers.classPrivateFieldLooseBase(this,de)[de]()},onPopupClose:()=>{this.emit(X.HIDE);babelHelpers.classPrivateFieldLooseBase(this,be)[be]();babelHelpers.classPrivateFieldLooseBase(this,J)[J].sendCloseLabel(babelHelpers.classPrivateFieldLooseBase(this,ae)[ae])}}},slots:babelHelpers.classPrivateFieldLooseBase(this,Le)[Le](e),groups:babelHelpers.classPrivateFieldLooseBase(this,Be)[Be](),items:babelHelpers.classPrivateFieldLooseBase(this,fe)[fe]()})}function Me(e){const t={[e.SLOT_MAIN_CONTENT_HEADER]:"<RolesDialogContentHeader />",[e.SLOT_MAIN_CONTENT_ITEM]:'<RolesDialogRoleItem :itemData="itemSlotProps" />',[e.SLOT_GROUP]:'<RolesDialogGroupItem :groupData="groupSlotProps" />',[e.SLOT_GROUP_LIST_HEADER]:"<RolesDialogGroupListHeader />"};if(e.SLOT_MAIN_CONTENT_SEARCH_STUB){t[e.SLOT_MAIN_CONTENT_NO_SELECTED_GROUP_STUB]="<RolesDialogSearchStub />";t[e.SLOT_MAIN_CONTENT_SEARCH_STUB]="<RolesDialogSearchStub />"}return t}function ze(){return{id:"info-item-data",title:l.Loc.getMessage("AI_COPILOT_ROLES_HELP_ITEM_TITLE"),subtitle:l.Loc.getMessage("AI_COPILOT_ROLES_HELP_ITEM_DESCRIPTION"),groupIds:babelHelpers.classPrivateFieldLooseBase(this,_e)[_e](),customData:{isInfoItem:true},button:{action:async()=>{await l.Runtime.loadExtension("ui.feedback.form");const e=Math.round(Math.random()*1e3);BX.UI.Feedback.Form.open({id:`ai.roles-dialog.feedback-form_${e}`,presets:{sender_page:`${babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]}_${babelHelpers.classPrivateFieldLooseBase(this,re)[re]}`},forms:[{zones:["es"],id:738,lang:"es",sec:"77ui4p"},{zones:["en"],id:740,lang:"en",sec:"obza3e"},{zones:["de"],id:742,lang:"de",sec:"vqqxgr"},{zones:["com.br"],id:744,lang:"com.br",sec:"nz3zig"},{zones:["ru","by","kz"],id:746,lang:"ru",sec:"we50kv"}]});babelHelpers.classPrivateFieldLooseBase(this,J)[J].sendFeedBackLabel()}}}}function ke(){return babelHelpers.classPrivateFieldLooseBase(this,te)[te].map((e=>e.code))}async function Ge(){const e=await babelHelpers.classPrivateFieldLooseBase(this,W)[W].getRolesDialogData();babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]=e.data.universalRole;babelHelpers.classPrivateFieldLooseBase(this,ee)[ee]=babelHelpers.classPrivateFieldLooseBase(this,ie)[ie].code;babelHelpers.classPrivateFieldLooseBase(this,te)[te]=e.data.items.map((e=>{const{code:t,name:s,isNew:a}=e;return{code:t,name:s,isNew:a}}));babelHelpers.classPrivateFieldLooseBase(this,te)[te].unshift(babelHelpers.classPrivateFieldLooseBase(this,He)[He](),babelHelpers.classPrivateFieldLooseBase(this,me)[me]());babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]=e.data.items.reduce(((e,t)=>{const s=t.roles;return[...e,...s]}),[]);babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]=e.data.recents;babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]=[...babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]];babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]=babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]||null}function Ue(){return{code:q,name:l.Loc.getMessage("AI_COPILOT_ROLES_RECOMMENDED_GROUP")}}function $e(){return{code:Q,name:l.Loc.getMessage("AI_COPILOT_ROLES_RECENT_GROUP")}}function Xe(){let e=null;const t=babelHelpers.classPrivateFieldLooseBase(this,Y)[Y].map((t=>{const s=[t.industryCode];if(t.isRecommended){s.push(q)}if(babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].findIndex((e=>e.code===t.code))>-1){s.push(Q)}if(t.code===babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]){e=babelHelpers.classPrivateFieldLooseBase(this,Re)[Re](t,s);return null}return babelHelpers.classPrivateFieldLooseBase(this,Re)[Re](t,s)})).filter((e=>e));const s=t.sort((e=>e.customData.isNew?-1:1));const a=babelHelpers.classPrivateFieldLooseBase(this,Fe)[Fe]();return[a,e,...s,babelHelpers.classPrivateFieldLooseBase(this,Pe)[Pe]()].filter((e=>e))}function qe(){const e=babelHelpers.classPrivateFieldLooseBase(this,ie)[ie];const t=[...babelHelpers.classPrivateFieldLooseBase(this,_e)[_e]()];return babelHelpers.classPrivateFieldLooseBase(this,Re)[Re](e,t)}function Qe(){const e=babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee]();const t=babelHelpers.classPrivateFieldLooseBase(this,te)[te].map(((t,s)=>{if(t.code===Q){return babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie](s===e)}return babelHelpers.classPrivateFieldLooseBase(this,ye)[ye](t,s===e)}));return[[...t]]}function Ve(e,t=false){return{id:e.code,name:e.name,selected:t,customData:{isNew:e.isNew}}}function We(e=false){return{...babelHelpers.classPrivateFieldLooseBase(this,ye)[ye](babelHelpers.classPrivateFieldLooseBase(this,He)[He](),e),compare:(e,t)=>babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe](e,t)}}function Je(e,t){const s=babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].findIndex((t=>e.id===t.code))+1;const a=babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].findIndex((e=>t.id===e.code))+1;if(e.id===babelHelpers.classPrivateFieldLooseBase(this,Pe)[Pe]().id){return 1}return s-a}function Ye(e,t=[]){return{groupIds:t,id:e.code,name:e.name,title:e.name,subtitle:e.description,description:e.description,button:{text:l.Loc.getMessage("AI_COPILOT_ROLES_USE_ROLE_BTN"),action:()=>{babelHelpers.classPrivateFieldLooseBase(this,pe)[pe](e);babelHelpers.classPrivateFieldLooseBase(this,V)[V].close()}},customData:{selected:e.code===babelHelpers.classPrivateFieldLooseBase(this,ae)[ae],avatar:e.avatar.medium,isNew:e.isNew}}}function Ze(){const e=babelHelpers.classPrivateFieldLooseBase(this,te)[te].findIndex((e=>babelHelpers.classPrivateFieldLooseBase(this,Se)[Se](e)));return e>-1?e:0}function et(e){const t=babelHelpers.classPrivateFieldLooseBase(this,fe)[fe]();const s=t.find((e=>e.id===babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]));return(s==null?void 0:s.groupIds.includes(e.code))||false}e.RolesDialogEvents=X;e.RolesDialog=Ce})(this.BX.AI=this.BX.AI||{},BX.AI,BX.Main,BX.Event,BX.Vue3.Components,BX,BX.Vue3.Pinia,BX.UI,BX.UI.IconSet,BX.UI.IconSet);
//# sourceMappingURL=roles-dialog.bundle.map.js