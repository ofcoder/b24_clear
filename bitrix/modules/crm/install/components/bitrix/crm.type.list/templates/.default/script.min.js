(function(e,t,r,n,i){"use strict";function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){babelHelpers.defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){l(e,t);t.add(e)}function l(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function c(e,t,r){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return r}var d=r.Reflection.namespace("BX.Crm");var u=new WeakSet;var p=new WeakSet;var h=function(){function e(t){babelHelpers.classCallCheck(this,e);s(this,p);s(this,u);if(r.Type.isPlainObject(t)){if(r.Type.isString(t.gridId)){this.gridId=t.gridId}if(this.gridId&&BX.Main.grid&&BX.Main.gridManager){this.grid=BX.Main.gridManager.getInstanceById(this.gridId)}if(r.Type.isElementNode(t.errorTextContainer)){this.errorTextContainer=t.errorTextContainer}if(r.Type.isElementNode(t.welcomeMessageContainer)){this.welcomeMessageContainer=t.welcomeMessageContainer}}}babelHelpers.createClass(e,[{key:"init",value:function e(){this.bindEvents()}},{key:"bindEvents",value:function e(){var t=this;n.EventEmitter.subscribe("BX.Crm.TypeListComponent:onClickCreate",this.handleTypeCreate.bind(this));n.EventEmitter.subscribe("BX.Crm.TypeListComponent:onClickDelete",this.handleTypeDelete.bind(this));n.EventEmitter.subscribe("BX.Crm.TypeListComponent:onFilterByAutomatedSolution",this.handleFilterByAutomatedSolution.bind(this));n.EventEmitter.subscribe("BX.Crm.TypeListComponent:onResetFilterByAutomatedSolution",this.handleFilterByAutomatedSolution.bind(this));var i=this.getToolbarComponent();if(i){i.subscribeTypeUpdatedEvent((function(e){var n=r.Type.isObject(e.getData())&&e.getData().isUrlChanged===true;if(n){window.location.reload();return}if(t.gridId&&r.Reflection.getClass("BX.Main.gridManager.reload")){r.Dom.removeClass(document.getElementById("crm-type-list-container"),"crm-type-list-grid-empty");BX.Main.gridManager.reload(t.gridId)}}))}}},{key:"showErrors",value:function e(t){var n="";t.forEach((function(e){n="".concat(n+e," ")}));if(r.Type.isElementNode(this.errorTextContainer)){this.errorTextContainer.innerText=n;r.Dom.style(this.errorTextContainer.parentElement,{display:"block"})}else{console.error(n)}}},{key:"hideErrors",value:function e(){if(r.Type.isElementNode(this.errorTextContainer)){this.errorTextContainer.innerText="";r.Dom.style(this.errorTextContainer.parentElement,{display:"none"})}}},{key:"showErrorsFromResponse",value:function e(t){var r=t.errors;var n=[];r.forEach((function(e){var t=e.message;return n.push(t)}));this.showErrors(n)}},{key:"handleTypeCreate",value:function e(n){var i=n.getData(),o=i.queryParams;if(!r.Type.isPlainObject(o)){o={}}var a=c(this,u,y).call(this);if(a>0){o.automatedSolutionId=a}void t.Router.Instance.openTypeDetail(0,null,o)}},{key:"handleTypeDelete",value:function e(t){var n=this;var o=r.Text.toInteger(t.data.id);if(!o){this.showErrors([r.Loc.getMessage("CRM_TYPE_TYPE_NOT_FOUND")]);return}i.MessageBox.show({title:r.Loc.getMessage("CRM_TYPE_TYPE_DELETE_CONFIRMATION_TITLE"),message:r.Loc.getMessage("CRM_TYPE_TYPE_DELETE_CONFIRMATION_MESSAGE"),modal:true,buttons:i.MessageBoxButtons.YES_CANCEL,onYes:function e(t){r.ajax.runAction("crm.controller.type.delete",{analyticsLabel:"crmTypeListDeleteType",data:{id:o}}).then((function(e){var t=r.Type.isObject(e.data)&&e.data.isUrlChanged===true;if(t){window.location.reload();return}n.grid.reloadTable()}))["catch"](n.showErrorsFromResponse.bind(n));t.close()}})}},{key:"getToolbarComponent",value:function e(){if(r.Reflection.getClass("BX.Crm.ToolbarComponent")){return BX.Crm.ToolbarComponent.Instance}return null}},{key:"handleFilterByAutomatedSolution",value:function e(t){var r,n;var i=a(a({},c(this,p,f).call(this)),{},{AUTOMATED_SOLUTION:t.data||null});var o=(r=BX.Main.filterManager)===null||r===void 0?void 0:(n=r.getList()[0])===null||n===void 0?void 0:n.getApi();if(!o){return}o.setFields(i);o.apply()}}]);return e}();function y(){var e=c(this,p,f).call(this),t=e.AUTOMATED_SOLUTION;if(r.Text.toInteger(t)>0){return r.Text.toInteger(t)}return null}function f(){var e,t;return((e=BX.Main.filterManager)===null||e===void 0?void 0:(t=e.getList()[0])===null||t===void 0?void 0:t.getFilterFieldsValues())||{}}d.TypeListComponent=h})(this.window=this.window||{},BX.Crm,BX,BX.Event,BX.UI.Dialogs);
//# sourceMappingURL=script.map.js