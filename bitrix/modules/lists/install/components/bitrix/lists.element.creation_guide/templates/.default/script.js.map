{"version":3,"file":"script.js","sources":["src/index.js"],"sourcesContent":["import { Dom, Loc, Reflection, Tag, Text, Type, ajax, Runtime, Uri } from 'main.core';\nimport { DateTimeFormat } from 'main.date';\nimport { Button, ButtonSize, ButtonColor } from 'ui.buttons';\nimport 'ui.tooltip';\n\nimport './css/style.css';\n\nconst namespace = Reflection.namespace('BX.Lists.Component');\n\nconst HTML_ELEMENT_ID = 'lists-element-creation-guide';\nconst BP_STATE_FORM_NAME = 'lists_element_creation_guide_bp';\nconst BP_STATE_CONSTANTS_FORM_NAME = 'lists_element_creation_guide_bp_constants';\nconst AJAX_COMPONENT = 'bitrix:lists.element.creation_guide';\n\nconst STEPS = Object.freeze({\n\tDESCRIPTION: 'description',\n\tCONSTANTS: 'constants',\n\tFIELDS: 'fields',\n});\n\ntype ComponentData = {\n\tname: string,\n\tdescription: string,\n\tduration: ?number,\n\tsignedParameters: string,\n\tbpTemplateIds: [],\n\thasFieldsToShow: boolean,\n\thasStatesToTuning: boolean,\n\tcanUserTuningStates: boolean,\n};\n\ntype Step = {\n\tstep: string,\n\tcontentNode: HTMLElement,\n\tprogressBarNode: HTMLElement,\n};\n\nclass ElementCreationGuide\n{\n\t#steps: Array<Step> = [];\n\n\t#name: string;\n\t#description: string;\n\t#duration: ?number = null;\n\t#signedParameters: string;\n\t#templateIds: [] = [];\n\n\t#currentStep: ?string;\n\t#startTime: number;\n\t#descriptionNode: HTMLElement;\n\t#durationNode: HTMLElement;\n\t#difference: number;\n\t#canUserTuningStates: boolean;\n\t#isAdminLoaded: boolean = false;\n\t#isLoading: boolean = false;\n\t#stepsEnterTime: Map<string, number> = new Map();\n\n\tconstructor(props: ComponentData)\n\t{\n\t\tif (!Type.isStringFilled(props.signedParameters))\n\t\t{\n\t\t\tthrow new TypeError('signedParameters must be filled string');\n\t\t}\n\t\tthis.#signedParameters = props.signedParameters;\n\n\t\tthis.#name = Type.isString(props.name) ? props.name : '';\n\t\tthis.#description = Type.isString(props.description) ? props.description : '';\n\n\t\tif (Type.isInteger(props.duration) && props.duration >= 0)\n\t\t{\n\t\t\tthis.#duration = props.duration;\n\t\t}\n\n\t\tif (Type.isArrayFilled(props.bpTemplateIds))\n\t\t{\n\t\t\tthis.#templateIds = props.bpTemplateIds;\n\t\t}\n\n\t\tthis.#canUserTuningStates = Type.isBoolean(props.canUserTuningStates) ? props.canUserTuningStates : false;\n\n\t\tthis.#startTime = Math.round(Date.now() / 1000);\n\n\t\tthis.#setCurrentStep(STEPS.DESCRIPTION);\n\t\tthis.#fillSteps(props);\n\t\tthis.#toggleButtons();\n\t\tthis.#renderProgressBar();\n\t\tthis.#renderFirstStep();\n\t}\n\n\t#setCurrentStep(step: ?string): void\n\t{\n\t\tthis.#currentStep = step;\n\n\t\tif (this.#currentStep === STEPS.DESCRIPTION)\n\t\t{\n\t\t\tthis.#stepsEnterTime.set(STEPS.DESCRIPTION, Date.now());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.#stepsEnterTime.has(STEPS.DESCRIPTION))\n\t\t\t{\n\t\t\t\tconst diffTime = Date.now() - this.#stepsEnterTime.get(STEPS.DESCRIPTION);\n\n\t\t\t\tRuntime.loadExtension('ui.analytics')\n\t\t\t\t\t.then(({ sendData }) => {\n\t\t\t\t\t\tsendData({\n\t\t\t\t\t\t\ttool: 'automation',\n\t\t\t\t\t\t\tcategory: 'bizproc_operations',\n\t\t\t\t\t\t\tevent: 'process_instructions_read',\n\t\t\t\t\t\t\tp1: this.#name,\n\t\t\t\t\t\t\tp4: Math.round(diffTime / 1000),\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => {})\n\t\t\t\t;\n\t\t\t}\n\n\t\t\tthis.#stepsEnterTime.delete(STEPS.DESCRIPTION);\n\t\t}\n\t}\n\n\t#fillSteps(props)\n\t{\n\t\tconst contentNode = document.querySelectorAll('.list-el-cg__content >.list-el-cg__content-body');\n\n\t\tconst showBPConstantsStep = Type.isBoolean(props.hasStatesToTuning) ? props.hasStatesToTuning : false;\n\t\tconst showFieldsStep = Type.isBoolean(props.hasFieldsToShow) ? props.hasFieldsToShow : false;\n\n\t\tthis.#steps.push({\n\t\t\tstep: STEPS.DESCRIPTION,\n\t\t\tcontentNode: contentNode.item(0),\n\t\t\tprogressBarNode: null,\n\t\t});\n\n\t\tif (showBPConstantsStep)\n\t\t{\n\t\t\tthis.#steps.push({\n\t\t\t\tstep: STEPS.CONSTANTS,\n\t\t\t\tcontentNode: contentNode.item(1),\n\t\t\t\tprogressBarNode: null,\n\t\t\t});\n\t\t}\n\n\t\tif (showFieldsStep)\n\t\t{\n\t\t\tthis.#steps.push({\n\t\t\t\tstep: STEPS.FIELDS,\n\t\t\t\tcontentNode: contentNode.item(2),\n\t\t\t\tprogressBarNode: null,\n\t\t\t});\n\t\t}\n\t}\n\n\t#toggleButtons()\n\t{\n\t\tconst backButton = document.getElementById(`${HTML_ELEMENT_ID}-back-button`);\n\t\tconst nextButton = document.getElementById(`${HTML_ELEMENT_ID}-next-button`);\n\t\tconst createButton = document.getElementById(`${HTML_ELEMENT_ID}-create-button`);\n\n\t\tthis.#removeNotTunedConstantsHint(createButton);\n\t\tthis.#removeNotTunedConstantsHint(nextButton);\n\n\t\tif (this.#isFirstStep())\n\t\t{\n\t\t\tconst showNextStep = this.#steps.length > 1;\n\t\t\tthis.#hideButton(showNextStep ? createButton : nextButton);\n\t\t\tthis.#showButton(showNextStep ? nextButton : createButton);\n\t\t}\n\t\telse if (this.#isLastStep())\n\t\t{\n\t\t\tthis.#hideButton(nextButton);\n\t\t\tthis.#showButton(createButton);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#hideButton(createButton);\n\t\t\tthis.#showButton(nextButton);\n\t\t}\n\n\t\tif (this.#currentStep === STEPS.CONSTANTS && !this.#canUserTuningStates)\n\t\t{\n\t\t\tthis.#disableButton(createButton);\n\t\t\tthis.#disableButton(nextButton);\n\t\t\tthis.#addNotTunedConstantsHint(createButton);\n\t\t\tthis.#addNotTunedConstantsHint(nextButton);\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tthis.#removeWaitFromButton(backButton);\n\t\t\tthis.#removeWaitFromButton(nextButton);\n\t\t\tthis.#removeWaitFromButton(createButton);\n\t\t}, 100);\n\t}\n\n\t#isFirstStep(): boolean\n\t{\n\t\treturn this.#currentStep === STEPS.DESCRIPTION;\n\t}\n\n\t#isLastStep(): boolean\n\t{\n\t\treturn (\n\t\t\t(this.#currentStep === STEPS.DESCRIPTION && this.#steps.length === 1)\n\t\t\t|| (this.#currentStep === STEPS.CONSTANTS && this.#steps.length === 2)\n\t\t\t|| (this.#currentStep === STEPS.FIELDS)\n\t\t);\n\t}\n\n\t#hideButton(button)\n\t{\n\t\tif (Type.isDomNode(button))\n\t\t{\n\t\t\tDom.addClass(button, ['--hidden']);\n\t\t\tthis.#disableButton(button);\n\t\t}\n\t}\n\n\t#disableButton(button)\n\t{\n\t\tif (Type.isDomNode(button))\n\t\t{\n\t\t\tDom.addClass(button, ['ui-btn-disabled']);\n\t\t\tDom.attr(button, 'disabled', 'disabled');\n\t\t}\n\t}\n\n\t#removeWaitFromButton(button)\n\t{\n\t\tif (Type.isDomNode(button))\n\t\t{\n\t\t\tDom.removeClass(button, 'ui-btn-wait');\n\t\t}\n\t}\n\n\t#setWaitToButton(button)\n\t{\n\t\tif (Type.isDomNode(button))\n\t\t{\n\t\t\tDom.addClass(button, 'ui-btn-wait');\n\t\t}\n\t}\n\n\t#showButton(button)\n\t{\n\t\tif (Type.isDomNode(button))\n\t\t{\n\t\t\tDom.removeClass(button, ['--hidden']);\n\t\t\tthis.#enableButton(button);\n\t\t}\n\t}\n\n\t#enableButton(button)\n\t{\n\t\tif (Type.isDomNode(button))\n\t\t{\n\t\t\tDom.removeClass(button, ['ui-btn-disabled']);\n\t\t\tDom.attr(button, 'disabled', null);\n\t\t}\n\t}\n\n\t#renderProgressBar(): void\n\t{\n\t\tconst container = document.getElementById(`${HTML_ELEMENT_ID}-breadcrumbs`);\n\t\tif (!container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst { step0, step1, step2 } = Tag.render`\n\t\t\t<div>\n\t\t\t\t<div class=\"list-el-cg__breadcrumbs-item --active\" ref=\"step0\">\n\t\t\t\t\t<span>${Text.encode(Loc.getMessage('LISTS_ELEMENT_CREATION_GUIDE_CMP_STEP_RECOMMENDATION'))}</span>\n\t\t\t\t\t<span class=\"ui-icon-set --chevron-right\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"list-el-cg__breadcrumbs-item\" ref=\"step1\">\n\t\t\t\t\t<span>${Text.encode(Loc.getMessage('LISTS_ELEMENT_CREATION_GUIDE_CMP_STEP_CONSTANTS'))}</span>\n\t\t\t\t\t<span class=\"ui-icon-set --chevron-right\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"list-el-cg__breadcrumbs-item\" ref=\"step2\">\n\t\t\t\t\t<span>${Text.encode(Loc.getMessage('LISTS_ELEMENT_CREATION_GUIDE_CMP_STEP_FIELDS'))}</span>\n\t\t\t\t\t<span class=\"ui-icon-set --chevron-right\"></span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#steps[0].progressBarNode = step0;\n\t\tDom.append(step0, container);\n\n\t\tconst constantsStep = this.#steps.find((step) => step.step === STEPS.CONSTANTS);\n\t\tif (constantsStep)\n\t\t{\n\t\t\tconstantsStep.progressBarNode = step1;\n\t\t\tDom.append(step1, container);\n\t\t}\n\n\t\tconst fieldsStep = this.#steps.find((step) => step.step === STEPS.FIELDS);\n\t\tif (fieldsStep)\n\t\t{\n\t\t\tfieldsStep.progressBarNode = step2;\n\t\t\tDom.append(step2, container);\n\t\t}\n\t}\n\n\t#renderFirstStep()\n\t{\n\t\tconst container = document.getElementById(`${HTML_ELEMENT_ID}-container`);\n\t\tconst contentNode = this.#steps[0].contentNode;\n\t\tif (container && contentNode)\n\t\t{\n\t\t\tconst description = this.#renderDescription();\n\t\t\tthis.#descriptionNode = description;\n\t\t\tDom.append(description, contentNode);\n\n\t\t\tconst expandNode = this.#renderExpandDescriptionNode();\n\t\t\tDom.append(expandNode, contentNode);\n\n\t\t\tthis.#durationNode = this.#renderDuration();\n\t\t\tDom.append(this.#durationNode, container);\n\n\t\t\tconst slider = document.querySelector('.ui-page-slider-workarea-content-padding');\n\t\t\tconst difference = slider ? (slider.offsetHeight - window.innerHeight) : 0;\n\t\t\tthis.#difference = difference;\n\t\t\tif (difference > 0)\n\t\t\t{\n\t\t\t\tthis.#toggleDescription({ target: expandNode });\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.remove(expandNode);\n\t\t\t}\n\t\t}\n\t}\n\n\t#renderDescription(): HTMLElement\n\t{\n\t\tif (Type.isStringFilled(this.#description))\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"list-el-cg__content-wrapper\">\n\t\t\t\t\t${BX.util.nl2br(this.#description)}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"list-el-cg__content-wrapper\">\n\t\t\t\t<span class=\"list-el-cg__text-empty\">${Loc.getMessage('LISTS_ELEMENT_CREATION_GUIDE_CMP_EMPTY_DESCRIPTION')}</span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderExpandDescriptionNode(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"list-el-cg__content-open\" onclick=\"${this.#toggleDescription.bind(this)}\">\n\t\t\t\t${Loc.getMessage('LISTS_ELEMENT_CREATION_GUIDE_CMP_EXPAND_DESCRIPTION')}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#toggleDescription(event)\n\t{\n\t\tconst target = event.target;\n\t\tif (target && this.#difference > 0)\n\t\t{\n\t\t\tDom.clean(target);\n\t\t\tif (Dom.hasClass(this.#descriptionNode, '--hide'))\n\t\t\t{\n\t\t\t\ttarget.innerText = Loc.getMessage('LISTS_ELEMENT_CREATION_GUIDE_CMP_COLLAPSE_DESCRIPTION');\n\t\t\t\tDom.style(this.#descriptionNode, 'height', `${this.#descriptionNode.scrollHeight}px`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttarget.innerText = Loc.getMessage('LISTS_ELEMENT_CREATION_GUIDE_CMP_EXPAND_DESCRIPTION');\n\t\t\t\tDom.style(\n\t\t\t\t\tthis.#descriptionNode,\n\t\t\t\t\t'height',\n\t\t\t\t\t`${this.#descriptionNode.offsetHeight - this.#difference}px`,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tDom.toggleClass(this.#descriptionNode, ['--hide']);\n\t\t}\n\t}\n\n\t#renderDuration(): HTMLElement\n\t{\n\t\tif (Type.isNil(this.#duration))\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"list-el-cg__informer\">\n\t\t\t\t\t<div class=\"list-el-cg__informer-header\">\n\t\t\t\t\t\t<div class=\"list-el-cg__informer-title\">\n\t\t\t\t\t\t\t${Text.encode(Loc.getMessage('LISTS_ELEMENT_CREATION_GUIDE_CMP_AVERAGE_DURATION_TITLE'))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"list-el-cg__informer-time\">\n\t\t\t\t\t\t\t<span class=\"list-el-cg__text-empty\">${Text.encode(Loc.getMessage('LISTS_ELEMENT_CREATION_GUIDE_CMP_EMPTY_DURATION'))}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"list-el-cg__informer-message\">${Loc.getMessage('LISTS_ELEMENT_CREATION_GUIDE_CMP_AVERAGE_DURATION_UNDEFINED_DESCRIPTION')}</div>\n\t\t\t\t\t<div class=\"list-el-cg__informer-bottom\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tconst formattedDuration = DateTimeFormat.format(\n\t\t\t[['s', 'sdiff'], ['i', 'idiff'], ['H', 'Hdiff'], ['d', 'ddiff'], ['m', 'mdiff'], ['Y', 'Ydiff']],\n\t\t\t0,\n\t\t\tthis.#duration,\n\t\t);\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"list-el-cg__informer\">\n\t\t\t\t<div class=\"list-el-cg__informer-header\">\n\t\t\t\t\t<div class=\"list-el-cg__informer-title\">\n\t\t\t\t\t\t${Text.encode(Loc.getMessage('LISTS_ELEMENT_CREATION_GUIDE_CMP_AVERAGE_DURATION_TITLE'))}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"list-el-cg__informer-time\">\n\t\t\t\t\t\t<span>${Text.encode(formattedDuration)}</span>\n\t\t\t\t\t\t<div class=\"ui-icon-set --time-picker\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"list-el-cg__informer-message\">${Loc.getMessage('LISTS_ELEMENT_CREATION_GUIDE_CMP_AVERAGE_DURATION_DESCRIPTION')}</div>\n\t\t\t\t<div class=\"list-el-cg__informer-bottom\">\n\t\t\t\t\t<a\n\t\t\t\t\t\tclass=\"list-el-cg__link\" href=\"#\"\n\t\t\t\t\t\tonclick=\"${this.#handleDurationHintClick}\"\n\t\t\t\t\t>${Loc.getMessage('LISTS_ELEMENT_CREATION_GUIDE_CMP_AVERAGE_DURATION_HINT')}\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#handleDurationHintClick(event)\n\t{\n\t\tevent.preventDefault();\n\n\t\tconst ARTICLE_ID = '18783714';\n\n\t\tconst helper = Reflection.getClass('top.BX.Helper');\n\n\t\tif (helper)\n\t\t{\n\t\t\thelper.show(`redirect=detail&code=${ARTICLE_ID}`);\n\t\t}\n\t}\n\n\tnext()\n\t{\n\t\tif (this.#isLoading || this.#isLastStep())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentStepIndex = this.#steps.findIndex((step) => step.step === this.#currentStep);\n\n\t\tconst currentStep = this.#steps[currentStepIndex];\n\t\tconst nextStep = this.#steps[currentStepIndex + 1];\n\n\t\tconst changeStep = () => {\n\t\t\tDom.toggleClass(currentStep.progressBarNode, ['--active', '--complete']);\n\t\t\tDom.addClass(nextStep.progressBarNode, '--active');\n\n\t\t\tthis.#cleanErrors();\n\n\t\t\tDom.addClass(currentStep.contentNode, '--hidden');\n\t\t\tDom.removeClass(nextStep.contentNode, '--hidden');\n\n\t\t\tif (this.#currentStep === STEPS.DESCRIPTION)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#durationNode, '--hidden');\n\t\t\t}\n\n\t\t\tthis.#setCurrentStep(nextStep.step);\n\t\t\tthis.#toggleButtons();\n\t\t};\n\n\t\tif (currentStep.step === STEPS.CONSTANTS && this.#canUserTuningStates)\n\t\t{\n\t\t\tthis.#startLoading();\n\t\t\tthis.#setAllConstants()\n\t\t\t\t.then(() => {\n\t\t\t\t\tchangeStep();\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tthis.#toggleButtons();\n\t\t\t\t})\n\t\t\t\t.finally(this.#finishLoading.bind(this))\n\t\t\t;\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (nextStep.step === STEPS.CONSTANTS && !this.#canUserTuningStates && !this.#isAdminLoaded)\n\t\t{\n\t\t\tthis.#startLoading();\n\t\t\tthis.#loadAdminList()\n\t\t\t\t.then(() => {})\n\t\t\t\t.catch(() => {})\n\t\t\t\t.finally(() => {\n\t\t\t\t\tthis.#isAdminLoaded = true;\n\t\t\t\t\tthis.#finishLoading();\n\t\t\t\t\tchangeStep();\n\t\t\t\t})\n\t\t\t;\n\n\t\t\treturn;\n\t\t}\n\n\t\tchangeStep();\n\t}\n\n\t#loadAdminList(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst constantStep = this.#steps.find((step) => step.step === STEPS.CONSTANTS);\n\t\t\tajax.runComponentAction(\n\t\t\t\tAJAX_COMPONENT,\n\t\t\t\t'getListAdmin',\n\t\t\t\t{ json: { signedParameters: this.#signedParameters } },\n\t\t\t)\n\t\t\t\t.then(({ data }) => {\n\t\t\t\t\tif (Type.isArrayFilled(data?.admins))\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.append(this.#renderAdminList(data.admins, data.canNotify), constantStep.contentNode);\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve();\n\t\t\t\t})\n\t\t\t\t.catch(reject)\n\t\t\t;\n\t\t});\n\t}\n\n\t#renderAdminList(admins: [], canNotify: boolean = false): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div>\n\t\t\t\t<p>\n\t\t\t\t\t${Text.encode(Loc.getMessage('LISTS_ELEMENT_CREATION_GUIDE_CMP_NOT_TUNING_CONSTANTS_NOTIFY_ADMIN'))}\n\t\t\t\t</p>\n\t\t\t\t<p>\n\t\t\t\t\t${Text.encode(Loc.getMessage('LISTS_ELEMENT_CREATION_GUIDE_CMP_NOT_TUNING_CONSTANTS_NOTIFY'))}\n\t\t\t\t</p>\n\t\t\t\t${admins.map((admin) => {\n\t\t\t\t\tlet button = null;\n\t\t\t\t\tif (canNotify)\n\t\t\t\t\t{\n\t\t\t\t\t\tbutton = new Button({\n\t\t\t\t\t\t\ttext: Loc.getMessage('LISTS_ELEMENT_CREATION_GUIDE_CMP_NOT_TUNING_CONSTANTS_NOTIFY_BUTTON'),\n\t\t\t\t\t\t\tsize: ButtonSize.MEDIUM,\n\t\t\t\t\t\t\tcolor: ButtonColor.PRIMARY,\n\t\t\t\t\t\t\tonclick: this.#notifyAdmin.bind(this, admin),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t<div style=\"padding: 12px 0; border-top: 1px solid var(--ui-color-palette-gray-10); line-height: 45px;\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tbx-tooltip-user-id=\"${admin.id}\"\n\t\t\t\t\t\t\t\tstyle=\"\n\t\t\t\t\t\t\t\t\tmargin-right: 10px;\n\t\t\t\t\t\t\t\t\tdisplay: inline-block;\n\t\t\t\t\t\t\t\t\tline-height: 34px;\n\t\t\t\t\t\t\t\t\tvertical-align: middle;\n\t\t\t\t\t\t\t\t\theight: 36px;\n\t\t\t\t\t\t\t\t\twidth: 36px;\n\t\t\t\t\t\t\t\t\tbackground-image: url('${admin.img ? encodeURI(Text.encode(admin.img)) : ''}');\n\t\t\t\t\t\t\t\t\tborder-radius: var(--ui-border-radius-circle);\n\t\t\t\t\t\t\t\t\tbackground-size: cover;\n\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t<span>${Text.encode(admin.name)}</span>\n\t\t\t\t\t\t\t<div style=\"float: right;\">\n\t\t\t\t\t\t\t\t${button?.render()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`;\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#notifyAdmin(admin: {}, button: Button)\n\t{\n\t\tbutton.setWaiting(true);\n\n\t\tajax.runComponentAction(\n\t\t\tAJAX_COMPONENT,\n\t\t\t'notifyAdmin',\n\t\t\t{\n\t\t\t\tjson: {\n\t\t\t\t\tsignedParameters: this.#signedParameters,\n\t\t\t\t\tadminId: admin.id,\n\t\t\t\t},\n\t\t\t},\n\t\t)\n\t\t\t.then(({ data }) => {\n\t\t\t\tif (data.success === true)\n\t\t\t\t{\n\t\t\t\t\tDom.replace(\n\t\t\t\t\t\tbutton.getContainer(),\n\t\t\t\t\t\tTag.render`\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t${Text.encode(Loc.getMessage('LISTS_ELEMENT_CREATION_GUIDE_CMP_NOT_TUNING_CONSTANTS_NOTIFY_SUCCESS'))}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t`,\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tbutton.setWaiting(false);\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tbutton.setWaiting(false);\n\t\t\t})\n\t\t;\n\t}\n\n\t#setAllConstants(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst formData = new FormData();\n\t\t\tthis.#appendBPFormData(formData, true);\n\n\t\t\tthis.#setConstants(formData)\n\t\t\t\t.then(resolve)\n\t\t\t\t.catch(({ errors }) => {\n\t\t\t\t\tif (Array.isArray(errors))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#showErrors(errors);\n\t\t\t\t\t}\n\n\t\t\t\t\treject();\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\t#setConstants(formData: FormData): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tformData.set('signedParameters', this.#signedParameters);\n\n\t\t\tajax.runComponentAction(AJAX_COMPONENT, 'setConstants', { data: formData })\n\t\t\t\t.then(resolve)\n\t\t\t\t.catch(reject)\n\t\t\t;\n\t\t});\n\t}\n\n\tback()\n\t{\n\t\tif (this.#isFirstStep())\n\t\t{\n\t\t\tif (Reflection.getClass('BX.SidePanel') && BX.SidePanel.Instance.getSliderByWindow(window))\n\t\t\t{\n\t\t\t\tBX.SidePanel.Instance.getSliderByWindow(window).close(false);\n\t\t\t}\n\n\t\t\tthis.#setCurrentStep();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentStepIndex = this.#steps.findIndex((step) => step.step === this.#currentStep);\n\t\tconst currentStep = this.#steps[currentStepIndex];\n\t\tconst previousStep = this.#steps[currentStepIndex - 1];\n\n\t\tDom.removeClass(currentStep.progressBarNode, '--active');\n\t\tDom.toggleClass(previousStep.progressBarNode, ['--active', '--complete']);\n\n\t\tthis.#cleanErrors();\n\n\t\tDom.addClass(currentStep.contentNode, '--hidden');\n\t\tDom.removeClass(previousStep.contentNode, '--hidden');\n\n\t\tif (previousStep.step === STEPS.DESCRIPTION)\n\t\t{\n\t\t\tDom.removeClass(this.#durationNode, '--hidden');\n\t\t}\n\n\t\tthis.#setCurrentStep(previousStep.step);\n\t\tthis.#toggleButtons();\n\t}\n\n\tasync create()\n\t{\n\t\tif (\n\t\t\tthis.#isLoading\n\t\t\t|| !this.#isLastStep()\n\t\t\t|| (this.#currentStep === STEPS.CONSTANTS && !this.#canUserTuningStates)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.#currentStep === STEPS.CONSTANTS)\n\t\t{\n\t\t\tthis.#startLoading();\n\n\t\t\tlet hasErrors = false;\n\t\t\tawait this.#setAllConstants()\n\t\t\t\t.catch(() => {\n\t\t\t\t\tthis.#toggleButtons();\n\t\t\t\t\thasErrors = true;\n\t\t\t\t})\n\t\t\t;\n\n\t\t\tthis.#finishLoading();\n\t\t\tif (hasErrors)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.#startLoading();\n\t\tthis.#createElement()\n\t\t\t.then(({ data }) => {\n\t\t\t\tif (Reflection.getClass('BX.SidePanel') && BX.SidePanel.Instance.getSliderByWindow(window))\n\t\t\t\t{\n\t\t\t\t\tBX.SidePanel.Instance.getSliderByWindow(window).close(false);\n\t\t\t\t\tthis.#showSuccessNotification(data.elementUrl);\n\t\t\t\t}\n\t\t\t\tthis.#sendCreationAnalytics();\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tthis.#toggleButtons();\n\t\t\t\tthis.#sendCreationAnalytics(error);\n\t\t\t})\n\t\t\t.finally(this.#finishLoading.bind(this))\n\t\t;\n\t}\n\n\t#showSuccessNotification(href)\n\t{\n\t\tconst topRuntime: Runtime = Reflection.getClass('top.BX.Runtime');\n\t\tif (topRuntime)\n\t\t{\n\t\t\ttopRuntime.loadExtension('ui.notification')\n\t\t\t\t.then(() => {\n\t\t\t\t\tif (Reflection.getClass('top.BX.UI.Notification.Center'))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst actions = [];\n\t\t\t\t\t\tif (Type.isStringFilled(href))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tactions.push({\n\t\t\t\t\t\t\t\thref,\n\t\t\t\t\t\t\t\ttitle: Loc.getMessage('LISTS_ELEMENT_CREATION_GUIDE_CMP_SUCCESS_CREATE_SEE'),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttop.BX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: Text.encode(Loc.getMessage('LISTS_ELEMENT_CREATION_GUIDE_CMP_SUCCESS_CREATE')),\n\t\t\t\t\t\t\tactions,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(() => {})\n\t\t\t;\n\t\t}\n\t}\n\n\tsaveConstants(templateId: number, button: HTMLButtonElement)\n\t{\n\t\tif (!this.#templateIds.includes(templateId) || !Type.isDomNode(button) || this.#isLoading)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#setWaitToButton(button);\n\n\t\tconst formData = new FormData();\n\t\tthis.#appendStateFormData(formData, `form_${BP_STATE_CONSTANTS_FORM_NAME}_${templateId}`);\n\t\tformData.append('templateIds[]', templateId);\n\n\t\tconst errorsNode = document.getElementById(`${HTML_ELEMENT_ID}-constants-${templateId}-errors`);\n\n\t\tthis.#startLoading();\n\t\tthis.#setConstants(formData)\n\t\t\t.then(() => {\n\t\t\t\tif (errorsNode)\n\t\t\t\t{\n\t\t\t\t\tthis.#cleanErrors(errorsNode);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(({ errors }) => {\n\t\t\t\tif (Type.isArrayFilled(errors) && errorsNode)\n\t\t\t\t{\n\t\t\t\t\tthis.#showErrors(errors, errorsNode);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tthis.#finishLoading();\n\t\t\t\tthis.#removeWaitFromButton(button);\n\t\t\t})\n\t\t;\n\t}\n\n\t#createElement(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst form: HTMLFormElement = document.forms.form_lists_element_creation_guide_element;\n\t\t\tconst formData: FormData = form ? new FormData(form) : new FormData();\n\n\t\t\tthis.#appendSectionFormData(formData);\n\t\t\tthis.#appendBPFormData(formData);\n\n\t\t\tformData.set('signedParameters', this.#signedParameters);\n\t\t\tformData.set('time', Math.round(Date.now() / 1000) - this.#startTime);\n\n\t\t\tajax.runComponentAction(\n\t\t\t\tAJAX_COMPONENT,\n\t\t\t\t'create',\n\t\t\t\t{ data: formData },\n\t\t\t)\n\t\t\t\t.then(resolve)\n\t\t\t\t.catch(({ errors }) => {\n\t\t\t\t\tif (Array.isArray(errors))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#showErrors(errors);\n\t\t\t\t\t}\n\n\t\t\t\t\treject(new Error(errors[0].message));\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\t#appendSectionFormData(formData: FormData)\n\t{\n\t\tconst form: HTMLFormElement = document.forms.form_lists_element_creation_guide_section;\n\t\tif (form)\n\t\t{\n\t\t\tformData.set('IBLOCK_SECTION_ID', new FormData(form).get('IBLOCK_SECTION_ID'));\n\t\t}\n\t}\n\n\t#appendBPFormData(formData: FormData, isConstantsForms: boolean = false)\n\t{\n\t\tthis.#templateIds.forEach((id) => {\n\t\t\tconst formId = `form_${isConstantsForms ? BP_STATE_CONSTANTS_FORM_NAME : BP_STATE_FORM_NAME}_${id}`;\n\t\t\tif (document.forms[formId])\n\t\t\t{\n\t\t\t\tthis.#appendStateFormData(formData, formId);\n\t\t\t\tformData.append('templateIds[]', id);\n\t\t\t}\n\t\t});\n\t}\n\n\t#appendStateFormData(formData: FormData, formId: number)\n\t{\n\t\tconst form = document.forms[formId];\n\t\tif (form)\n\t\t{\n\t\t\tfor (const [key, value] of (new FormData(form)).entries())\n\t\t\t{\n\t\t\t\tif (key !== 'sessid')\n\t\t\t\t{\n\t\t\t\t\tformData.append(key, value);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t#showErrors(errors: [], toNode: HTMLElement = null)\n\t{\n\t\tthis.#cleanErrors(toNode);\n\n\t\tconst errorsNode = Type.isDomNode(toNode) ? toNode : document.getElementById(`${HTML_ELEMENT_ID}-errors`);\n\t\tif (errorsNode)\n\t\t{\n\t\t\tlet message = '';\n\t\t\terrors.forEach((error) => {\n\t\t\t\tif (error.message)\n\t\t\t\t{\n\t\t\t\t\tmessage += Text.encode(error.message);\n\t\t\t\t\tmessage += '<br/>';\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tDom.append(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-alert ui-alert-danger\">\n\t\t\t\t\t\t<span class=\"ui-alert-message\">${message}</span>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t\terrorsNode,\n\t\t\t);\n\t\t}\n\t}\n\n\t#cleanErrors(fromNode: HTMLElement = null)\n\t{\n\t\tif (Type.isDomNode(fromNode))\n\t\t{\n\t\t\tDom.clean(fromNode);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst errorsNode = document.getElementById(`${HTML_ELEMENT_ID}-errors`);\n\t\tif (errorsNode)\n\t\t{\n\t\t\tDom.clean(errorsNode);\n\t\t}\n\n\t\tthis.#templateIds.forEach((templateId) => {\n\t\t\tconst node = document.getElementById(`${HTML_ELEMENT_ID}-constants-${templateId}-errors`);\n\t\t\tif (node)\n\t\t\t{\n\t\t\t\tDom.clean(node);\n\t\t\t}\n\t\t});\n\t}\n\n\t#startLoading()\n\t{\n\t\tthis.#isLoading = true;\n\t\tthis.#disableAllButtons();\n\t}\n\n\t#disableAllButtons()\n\t{\n\t\tfor (const button of document.getElementsByClassName('ui-btn'))\n\t\t{\n\t\t\tthis.#disableButton(button);\n\t\t}\n\t}\n\n\t#finishLoading()\n\t{\n\t\tthis.#isLoading = false;\n\t\tthis.#enableAllButtons();\n\t}\n\n\t#enableAllButtons()\n\t{\n\t\tfor (const button of document.getElementsByClassName('ui-btn'))\n\t\t{\n\t\t\tthis.#enableButton(button);\n\t\t}\n\t}\n\n\t#addNotTunedConstantsHint(button: HTMLElement)\n\t{\n\t\tif (Type.isDomNode(button))\n\t\t{\n\t\t\tDom.attr(button, 'title', Loc.getMessage('LISTS_ELEMENT_CREATION_GUIDE_CMP_NOT_TUNING_CONSTANTS_HINT'));\n\t\t}\n\t}\n\n\t#removeNotTunedConstantsHint(button: HTMLElement)\n\t{\n\t\tif (Type.isDomNode(button))\n\t\t{\n\t\t\tDom.attr(button, 'title', null);\n\t\t}\n\t}\n\n\t#sendCreationAnalytics(error?: Error)\n\t{\n\t\tRuntime.loadExtension('ui.analytics')\n\t\t\t.then(({ sendData }) => {\n\t\t\t\tsendData({\n\t\t\t\t\ttool: 'automation',\n\t\t\t\t\tcategory: 'bizproc_operations',\n\t\t\t\t\tevent: 'process_run',\n\t\t\t\t\ttype: 'run',\n\t\t\t\t\tc_section: this.#getAnalyticsSection(),\n\t\t\t\t\tp1: this.#name,\n\t\t\t\t\tstatus: error ? 'error' : 'success',\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch(() => {})\n\t\t;\n\t}\n\n\t#getAnalyticsSection(): string\n\t{\n\t\treturn ((new Uri(window.location.href)).getQueryParam('analyticsSection')) || 'bizproc';\n\t}\n}\n\nnamespace.ElementCreationGuide = ElementCreationGuide;\n"],"names":["namespace","Reflection","HTML_ELEMENT_ID","BP_STATE_FORM_NAME","BP_STATE_CONSTANTS_FORM_NAME","AJAX_COMPONENT","STEPS","Object","freeze","DESCRIPTION","CONSTANTS","FIELDS","ElementCreationGuide","constructor","props","Map","Type","isStringFilled","signedParameters","TypeError","isString","name","description","isInteger","duration","isArrayFilled","bpTemplateIds","isBoolean","canUserTuningStates","Math","round","Date","now","next","currentStepIndex","findIndex","step","currentStep","nextStep","changeStep","Dom","toggleClass","progressBarNode","addClass","contentNode","removeClass","then","catch","finally","bind","back","getClass","BX","SidePanel","Instance","getSliderByWindow","window","close","previousStep","create","hasErrors","data","elementUrl","error","saveConstants","templateId","button","includes","isDomNode","formData","FormData","append","errorsNode","document","getElementById","errors","set","has","diffTime","get","Runtime","loadExtension","sendData","tool","category","event","p1","p4","delete","querySelectorAll","showBPConstantsStep","hasStatesToTuning","showFieldsStep","hasFieldsToShow","push","item","backButton","nextButton","createButton","showNextStep","length","setTimeout","attr","container","step0","step1","step2","Tag","render","Text","encode","Loc","getMessage","constantsStep","find","fieldsStep","expandNode","slider","querySelector","difference","offsetHeight","innerHeight","target","remove","util","nl2br","clean","hasClass","innerText","style","scrollHeight","isNil","formattedDuration","DateTimeFormat","format","preventDefault","ARTICLE_ID","helper","show","Promise","resolve","reject","constantStep","ajax","runComponentAction","json","admins","canNotify","map","admin","Button","text","size","ButtonSize","MEDIUM","color","ButtonColor","PRIMARY","onclick","id","img","encodeURI","setWaiting","adminId","success","replace","getContainer","Array","isArray","href","topRuntime","actions","title","top","UI","Notification","Center","notify","content","form","forms","form_lists_element_creation_guide_element","Error","message","form_lists_element_creation_guide_section","isConstantsForms","forEach","formId","key","value","entries","toNode","fromNode","node","getElementsByClassName","type","c_section","status","Uri","location","getQueryParam"],"mappings":"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"}